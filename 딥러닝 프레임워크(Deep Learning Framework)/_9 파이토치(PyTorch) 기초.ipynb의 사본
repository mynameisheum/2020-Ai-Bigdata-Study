{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"name":"_9 파이토치(PyTorch) 기초.ipynb의 사본","provenance":[{"file_id":"1eHykNLFgidFmMBxKSDF9K5G2hPatXr5G","timestamp":1603630125568}],"collapsed_sections":[]},"kernelspec":{"name":"python3","display_name":"Python 3"},"accelerator":"GPU","widgets":{"application/vnd.jupyter.widget-state+json":{"a6f66cd5405e42fa9005a88e41e738d0":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_a69d6baa3f3244cc96bd04d931ba2eea","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_3241dcfc3bfd48ffa63fd9f395edd790","IPY_MODEL_187a0cd1a6484361b57dc763a8986e2d"]}},"a69d6baa3f3244cc96bd04d931ba2eea":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"3241dcfc3bfd48ffa63fd9f395edd790":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_bf43ac47b7d44a56976f84c8e15687e2","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"info","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_ade898ab500c468681b2ad2721908e35"}},"187a0cd1a6484361b57dc763a8986e2d":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_f933c86b8c374aad9129b75349b186f5","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 9920512/? [00:20&lt;00:00, 1480826.63it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_be82a8839f6345d4ba7c5f1a0b69245b"}},"bf43ac47b7d44a56976f84c8e15687e2":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"ade898ab500c468681b2ad2721908e35":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"f933c86b8c374aad9129b75349b186f5":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"be82a8839f6345d4ba7c5f1a0b69245b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"3bd6d4c626b540869f4bd5a0e75c67f5":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_daca2eec4b9e43a28244afa2e71d76fb","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_c0464d55f7a847489e71b778b80b14d4","IPY_MODEL_da57e964d26a478289ba79872d345ed2"]}},"daca2eec4b9e43a28244afa2e71d76fb":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"c0464d55f7a847489e71b778b80b14d4":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_700de9c63db8445dab885ea7af777705","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_8f5938e765954bce9ea2e5298f67c963"}},"da57e964d26a478289ba79872d345ed2":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_05f5954899d1478fbf4fdc4565de1793","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 32768/? [00:00&lt;00:00, 114096.80it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_25473cf7cbad4aba869c51c331d11a84"}},"700de9c63db8445dab885ea7af777705":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"8f5938e765954bce9ea2e5298f67c963":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"05f5954899d1478fbf4fdc4565de1793":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"25473cf7cbad4aba869c51c331d11a84":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"8cb9ea45547b46f8bb82cc08b46dd16e":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_74c5ce4f2bfb40d18a202e17e77de984","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_17c81a76a92f4f64b951edb3d0079dd7","IPY_MODEL_46c4d96e5cb6487ca417565f70a1fcb8"]}},"74c5ce4f2bfb40d18a202e17e77de984":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"17c81a76a92f4f64b951edb3d0079dd7":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_b1788c7b65da4aeba5c0c7aee65c47c1","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"info","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_ff0566a569aa495ba80d1c59ab154059"}},"46c4d96e5cb6487ca417565f70a1fcb8":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_4463b881c9a148de8e3d9f44e60ffdf8","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 1654784/? [00:18&lt;00:00, 540818.35it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_84853fb3baf84a8badaed0a441fb1915"}},"b1788c7b65da4aeba5c0c7aee65c47c1":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"ff0566a569aa495ba80d1c59ab154059":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"4463b881c9a148de8e3d9f44e60ffdf8":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"84853fb3baf84a8badaed0a441fb1915":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"2be5624bb11344cdac5f67bc14d87e05":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_05d8938756f1419da7acc59676c6238d","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_1cec9b77118c4737b3f0d0a7cd7588fb","IPY_MODEL_7003721d58834bff8c8e0456a871db23"]}},"05d8938756f1419da7acc59676c6238d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"1cec9b77118c4737b3f0d0a7cd7588fb":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_49c406ab3dda469eaafd00373e566498","_dom_classes":[],"description":"  0%","_model_name":"FloatProgressModel","bar_style":"info","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":0,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_3b442b976d4742e58741069bbd24157e"}},"7003721d58834bff8c8e0456a871db23":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_9edaf6fc12df4470acb7559656025342","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 0/4542 [00:00&lt;?, ?it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_4d299446e69d406a93e346baa955098a"}},"49c406ab3dda469eaafd00373e566498":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"3b442b976d4742e58741069bbd24157e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"9edaf6fc12df4470acb7559656025342":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"4d299446e69d406a93e346baa955098a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}}}}},"cells":[{"cell_type":"markdown","metadata":{"id":"f9Xx-jP92OgP"},"source":["# 파이토치(PyTorch)\n","\n","<img src=\"https://img1.daumcdn.net/thumb/R800x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FbuUgoV%2FbtqwWZvcHHX%2Fd6XzIFBEfiuFb0UvyV4A50%2Fimg.jpg\" width=\"300\">\n","\n","- 코드 출처: https://pytorch.org/tutorials/"]},{"cell_type":"markdown","metadata":{"id":"3cxreguz2sL0"},"source":["## 파이토치의 구성요소\n","\n","- `torch`: 텐서를 생성하는 라이브러리\n","\n","- `torch.autograd`: 자동미분 기능을 제공하는 라이브러리\n","\n","- `torch.nn`: 신경망을 생성하는 라이브러리\n","\n","- `torch.multiprocessing`: 병럴처리 기능을 제공하는 라이브러리\n","\n","- `torch.utils`: 데이터 조작 등 유틸리티 기능 제공\n","\n","- `torch.legacy`(./nn/.optim): Torch로부터 포팅해온 코드\n","\n","- `torch.onnx`: ONNX(Open Neural Network Exchange)\n","\n","  - 서로 다른 프레임워크 간의 모델을 공유할 때 사용"]},{"cell_type":"markdown","metadata":{"id":"gb5O_aSvtHvb"},"source":["## 텐서(Tensors)\n","- 넘파이(NumPy)의 ndarray와 유사\n","\n","- GPU를 사용한 연산 가속도 가능"]},{"cell_type":"code","metadata":{"id":"CmKIvnx0s8G6","executionInfo":{"status":"ok","timestamp":1603627551307,"user_tz":-540,"elapsed":4246,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}}},"source":["import torch"],"execution_count":1,"outputs":[]},{"cell_type":"code","metadata":{"id":"49IHV-qJE5FI","executionInfo":{"status":"ok","timestamp":1603627551622,"user_tz":-540,"elapsed":4513,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"7e238fe5-c4e3-4109-9ebc-757dab96641b","colab":{"base_uri":"https://localhost:8080/","height":35}},"source":["torch.__version__"],"execution_count":2,"outputs":[{"output_type":"execute_result","data":{"application/vnd.google.colaboratory.intrinsic+json":{"type":"string"},"text/plain":["'1.6.0+cu101'"]},"metadata":{"tags":[]},"execution_count":2}]},{"cell_type":"markdown","metadata":{"id":"isUHVy-gtZeT"},"source":["### 초기화 되지 않은 행렬 "]},{"cell_type":"code","metadata":{"id":"3PqY3cZatU0D","executionInfo":{"status":"ok","timestamp":1603627551624,"user_tz":-540,"elapsed":4467,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"3118a5c4-2274-486c-a012-a2407d9f0f65","colab":{"base_uri":"https://localhost:8080/","height":87}},"source":["x = torch.empty(4,2)\n","print(x)\n","\n","# 초기화되지않는 값들인데 왜 값이 잇지\n","# 기존 메모리의 값들을 그대로 가져와서 그런거구나\n","# 말그대로 초기화가 되지 않은거지"],"execution_count":3,"outputs":[{"output_type":"stream","text":["tensor([[3.6643e-36, 0.0000e+00],\n","        [3.3631e-44, 0.0000e+00],\n","        [       nan, 0.0000e+00],\n","        [1.1578e+27, 1.1362e+30]])\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"zPCIJ2pNteZv"},"source":["### 무작위로 초기화된 행렬"]},{"cell_type":"code","metadata":{"id":"h6oPj2Q9tdYx","executionInfo":{"status":"ok","timestamp":1603627551625,"user_tz":-540,"elapsed":4430,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"d1d8f6c2-986d-45ed-b53c-7f50ff99bda4","colab":{"base_uri":"https://localhost:8080/","height":87}},"source":["x = torch.rand(4,2)\n","print(x)"],"execution_count":4,"outputs":[{"output_type":"stream","text":["tensor([[0.1195, 0.4087],\n","        [0.3451, 0.7026],\n","        [0.0088, 0.7051],\n","        [0.7342, 0.9446]])\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"A5aHphIHtiJk"},"source":["### dtype이 long, 0으로 채워진 텐서"]},{"cell_type":"code","metadata":{"id":"4zykN8aMthXk","executionInfo":{"status":"ok","timestamp":1603627551625,"user_tz":-540,"elapsed":4395,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"7e965576-3063-455c-e58d-905869c6c568","colab":{"base_uri":"https://localhost:8080/","height":87}},"source":["x = torch.zeros(4,2, dtype = torch.long)\n","print(x)\n","\n","# shape과 0값과 dtype까지 long으로 맞춘거지"],"execution_count":5,"outputs":[{"output_type":"stream","text":["tensor([[0, 0],\n","        [0, 0],\n","        [0, 0],\n","        [0, 0]])\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"FPgDe6OT3lV5","executionInfo":{"status":"ok","timestamp":1603627551626,"user_tz":-540,"elapsed":4363,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"6e4a8c34-ec68-4fb1-9e7a-1a6777917467","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["x = torch.tensor([3,2.3])\n","print(x)\n","# 이건 우리가 직접 입력한거지"],"execution_count":6,"outputs":[{"output_type":"stream","text":["tensor([3.0000, 2.3000])\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"W4VL8C_ctu8b","executionInfo":{"status":"ok","timestamp":1603627551627,"user_tz":-540,"elapsed":4327,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"a233388d-62f3-478c-835d-94d08c32a8b7","colab":{"base_uri":"https://localhost:8080/","height":52}},"source":["x = x.new_ones(2,4, dtype = torch.double)\n","print(x)\n","\n","# 2,4사이즈로 1로 채우고 double(float32)이란 type으로"],"execution_count":7,"outputs":[{"output_type":"stream","text":["tensor([[1., 1., 1., 1.],\n","        [1., 1., 1., 1.]], dtype=torch.float64)\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"4RmVBVtIt46M","executionInfo":{"status":"ok","timestamp":1603627551628,"user_tz":-540,"elapsed":4296,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"686f9e44-3d82-4ddc-e944-27d1c872af6a","colab":{"base_uri":"https://localhost:8080/","height":52}},"source":["x = torch.randn_like(x,dtype = torch.float)\n","print(x)\n","\n","# 2,4짜리 모양을 그대로 가져오대 random으로 채운거지\n","# type은 float로"],"execution_count":8,"outputs":[{"output_type":"stream","text":["tensor([[ 0.3933,  1.1039, -2.2898,  0.0291],\n","        [-1.2255,  0.9598,  1.1481, -0.9474]])\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"7j5sGxGvucpH"},"source":["### 텐서의 크기"]},{"cell_type":"code","metadata":{"id":"yy-JbqKEuYIR","executionInfo":{"status":"ok","timestamp":1603627551628,"user_tz":-540,"elapsed":4265,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"2141d195-97ee-4cb7-9118-e6903caed7c0","colab":{"base_uri":"https://localhost:8080/","height":52}},"source":["print(x.size())\n","print(x.shape)"],"execution_count":9,"outputs":[{"output_type":"stream","text":["torch.Size([2, 4])\n","torch.Size([2, 4])\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"ehOg0eDwufru"},"source":["## 텐서의 연산(operations)"]},{"cell_type":"markdown","metadata":{"id":"j8Doc_37uh3G"},"source":["### 덧셈 1"]},{"cell_type":"code","metadata":{"id":"Rw4JCYkYuef9","executionInfo":{"status":"ok","timestamp":1603627551629,"user_tz":-540,"elapsed":4229,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"d73bd4f9-f42e-45c2-8846-9a786386e605","colab":{"base_uri":"https://localhost:8080/","height":52}},"source":["print(x)"],"execution_count":10,"outputs":[{"output_type":"stream","text":["tensor([[ 0.3933,  1.1039, -2.2898,  0.0291],\n","        [-1.2255,  0.9598,  1.1481, -0.9474]])\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"Wa44ur1Nuj5U","executionInfo":{"status":"ok","timestamp":1603627552016,"user_tz":-540,"elapsed":4587,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"20d20d79-066f-4e85-8064-310236a5a0ca","colab":{"base_uri":"https://localhost:8080/","height":87}},"source":["y = torch.rand(2,4)\n","print(y)\n","print(x + y)\n","\n","# x,y,의 값이 +가 됐구만"],"execution_count":11,"outputs":[{"output_type":"stream","text":["tensor([[0.4888, 0.0821, 0.4301, 0.3857],\n","        [0.7550, 0.0930, 0.8971, 0.5867]])\n","tensor([[ 0.8821,  1.1861, -1.8597,  0.4148],\n","        [-0.4705,  1.0529,  2.0452, -0.3607]])\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"E5gcOo-Ouo9B"},"source":["### 덧셈2"]},{"cell_type":"code","metadata":{"id":"Qx-NzJhhumZx","executionInfo":{"status":"ok","timestamp":1603627552017,"user_tz":-540,"elapsed":4545,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"f45f66cc-561d-4681-8c85-8ea8d4746867","colab":{"base_uri":"https://localhost:8080/","height":52}},"source":["print(torch.add(x,y))\n","# add라는 method를 사용가능"],"execution_count":12,"outputs":[{"output_type":"stream","text":["tensor([[ 0.8821,  1.1861, -1.8597,  0.4148],\n","        [-0.4705,  1.0529,  2.0452, -0.3607]])\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"RlvrQhLuuuIr"},"source":["### 덧셈3\n","- 결과 텐서를 인자로 제공"]},{"cell_type":"code","metadata":{"id":"lUsLAOTcur1-","executionInfo":{"status":"ok","timestamp":1603627552017,"user_tz":-540,"elapsed":4478,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"efe32b4b-1f14-4cf4-8a8c-5b6c07cd8683","colab":{"base_uri":"https://localhost:8080/","height":52}},"source":["result = torch.empty(2,4)\n","torch.add(x,y,out = result)\n","print(result)\n"],"execution_count":13,"outputs":[{"output_type":"stream","text":["tensor([[ 0.8821,  1.1861, -1.8597,  0.4148],\n","        [-0.4705,  1.0529,  2.0452, -0.3607]])\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"V6BdyZFSu2Ei"},"source":["### 덧셈4\n","- `in-place` 방식\n","\n","- (참고) in-place 방식\n","  - in-place방식으로 텐서의 값을 변경하는 연산 뒤에는 _''가 붙음\n","  - `x.copy_(y), x.t_()`"]},{"cell_type":"code","metadata":{"id":"lu8rR4WVu0wQ","executionInfo":{"status":"ok","timestamp":1603627552018,"user_tz":-540,"elapsed":4453,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"cb1f7365-e067-415f-f7bc-e7d2ab735b13","colab":{"base_uri":"https://localhost:8080/","height":122}},"source":["print(x)\n","print(y)\n","y.add_(x)   # _를 붙어야함 // y += x같은 느낌이지 // y값자체에 x값이 더해져서 나오는\n","print(y)\n"],"execution_count":14,"outputs":[{"output_type":"stream","text":["tensor([[ 0.3933,  1.1039, -2.2898,  0.0291],\n","        [-1.2255,  0.9598,  1.1481, -0.9474]])\n","tensor([[0.4888, 0.0821, 0.4301, 0.3857],\n","        [0.7550, 0.0930, 0.8971, 0.5867]])\n","tensor([[ 0.8821,  1.1861, -1.8597,  0.4148],\n","        [-0.4705,  1.0529,  2.0452, -0.3607]])\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"Uo8nsrGjOw6W"},"source":["### 그 외의 연산\n","- `torch.sub` : 뺄셈\n","\n","- `torch.mul` : 곱셉\n","\n","- `torch.div` : 나눗셈\n","\n","- `torch.mm` : 내적(dot product)"]},{"cell_type":"code","metadata":{"id":"S51kxzPTO1ER","executionInfo":{"status":"ok","timestamp":1603627552019,"user_tz":-540,"elapsed":4434,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"485c2484-7798-4327-ed93-9bea9222026e","colab":{"base_uri":"https://localhost:8080/","height":122}},"source":["x = torch.Tensor([[1,3],\n","                  [5,7]])\n","y = torch.Tensor([[2,4],\n","                  [6,8]])\n","\n","print(x-y)\n","print(torch.sub(x,y))\n","print(x.sub(y))"],"execution_count":15,"outputs":[{"output_type":"stream","text":["tensor([[-1., -1.],\n","        [-1., -1.]])\n","tensor([[-1., -1.],\n","        [-1., -1.]])\n","tensor([[-1., -1.],\n","        [-1., -1.]])\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"ou0dY8mkPR24","executionInfo":{"status":"ok","timestamp":1603627552019,"user_tz":-540,"elapsed":4412,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"d1597861-5b53-4a11-d82b-78da0625284f","colab":{"base_uri":"https://localhost:8080/","height":122}},"source":["x = torch.Tensor([[1,3],\n","                  [5,7]])\n","y = torch.Tensor([[2,4],\n","                  [6,8]])\n","\n","print(x * y)\n","print(torch.mul(x,y))\n","print(x.mul(y))"],"execution_count":16,"outputs":[{"output_type":"stream","text":["tensor([[ 2., 12.],\n","        [30., 56.]])\n","tensor([[ 2., 12.],\n","        [30., 56.]])\n","tensor([[ 2., 12.],\n","        [30., 56.]])\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"6RlZZBp3PbE4","executionInfo":{"status":"ok","timestamp":1603627552021,"user_tz":-540,"elapsed":4392,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"f0231f2e-bd96-4286-9258-133982867b2f","colab":{"base_uri":"https://localhost:8080/","height":122}},"source":["x = torch.Tensor([[1,3],\n","                  [5,7]])\n","y = torch.Tensor([[2,4],\n","                  [6,8]])\n","\n","print(x / y)\n","print(torch.div(x,y))\n","print(x.div(y))"],"execution_count":17,"outputs":[{"output_type":"stream","text":["tensor([[0.5000, 0.7500],\n","        [0.8333, 0.8750]])\n","tensor([[0.5000, 0.7500],\n","        [0.8333, 0.8750]])\n","tensor([[0.5000, 0.7500],\n","        [0.8333, 0.8750]])\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"7MR-ofE5P7VC","executionInfo":{"status":"ok","timestamp":1603627552023,"user_tz":-540,"elapsed":4374,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"c9a00cd1-958b-4664-a664-ec8edf48f8eb","colab":{"base_uri":"https://localhost:8080/","height":52}},"source":["x = torch.Tensor([[1,3],\n","                  [5,7]])\n","y = torch.Tensor([[2,4],\n","                  [6,8]])\n","\n","print(torch.mm(x,y))    #행렬곱 \n","# print(torch.sub(x,y))\n","# print(x.sub(y))"],"execution_count":18,"outputs":[{"output_type":"stream","text":["tensor([[20., 28.],\n","        [52., 76.]])\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"8URGwHE_NjDi"},"source":["## 텐서의 조작(manipulations)"]},{"cell_type":"markdown","metadata":{"id":"uCsdZIPTvG53"},"source":["### 인덱싱\n","- 넘파이처럼 인덱싱 사용가능"]},{"cell_type":"code","metadata":{"id":"jF2DE8kzvOs3","executionInfo":{"status":"ok","timestamp":1603627552024,"user_tz":-540,"elapsed":4350,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"04a329c3-0da3-4ba9-d06d-e36af3305eed","colab":{"base_uri":"https://localhost:8080/","height":52}},"source":["print(x)"],"execution_count":19,"outputs":[{"output_type":"stream","text":["tensor([[1., 3.],\n","        [5., 7.]])\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"GQtBH3r3u7c3","executionInfo":{"status":"ok","timestamp":1603627552025,"user_tz":-540,"elapsed":4325,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"ee5cc4c2-b98d-4f80-dcaf-cb5804b9d8a6","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["print(x[:,1])\n","\n","# 기본적인 pandas랑 같아보여"],"execution_count":20,"outputs":[{"output_type":"stream","text":["tensor([3., 7.])\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"jEscXddKvQ5l"},"source":["### view\n","- 텐서의 크기(size)나 모양(shape)을 변경"]},{"cell_type":"code","metadata":{"id":"xwhWeqhLvKKj","executionInfo":{"status":"ok","timestamp":1603627552025,"user_tz":-540,"elapsed":4300,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"fc4cbe0f-b169-4b1d-bdda-097452ae9e22","colab":{"base_uri":"https://localhost:8080/","height":404}},"source":["x = torch.randn(4,5)\n","y = x.view(20)\n","z = x.view(5,-1)\n","w = x.view(1,2,2,5)\n","print(x.size())\n","print(y.size())\n","print(z.size())\n","print(w.size(),'\\n')\n","print(x)\n","print(y)\n","print(z)\n","print(w)"],"execution_count":21,"outputs":[{"output_type":"stream","text":["torch.Size([4, 5])\n","torch.Size([20])\n","torch.Size([5, 4])\n","torch.Size([1, 2, 2, 5]) \n","\n","tensor([[-0.1173, -1.4933,  0.9589,  0.1205,  0.6243],\n","        [ 1.3899,  0.6442, -1.5947, -0.4593, -0.0537],\n","        [-0.0950,  1.0149, -0.5597, -0.8297, -0.6613],\n","        [-0.6547, -1.4611,  2.3698,  1.6618, -0.0275]])\n","tensor([-0.1173, -1.4933,  0.9589,  0.1205,  0.6243,  1.3899,  0.6442, -1.5947,\n","        -0.4593, -0.0537, -0.0950,  1.0149, -0.5597, -0.8297, -0.6613, -0.6547,\n","        -1.4611,  2.3698,  1.6618, -0.0275])\n","tensor([[-0.1173, -1.4933,  0.9589,  0.1205],\n","        [ 0.6243,  1.3899,  0.6442, -1.5947],\n","        [-0.4593, -0.0537, -0.0950,  1.0149],\n","        [-0.5597, -0.8297, -0.6613, -0.6547],\n","        [-1.4611,  2.3698,  1.6618, -0.0275]])\n","tensor([[[[-0.1173, -1.4933,  0.9589,  0.1205,  0.6243],\n","          [ 1.3899,  0.6442, -1.5947, -0.4593, -0.0537]],\n","\n","         [[-0.0950,  1.0149, -0.5597, -0.8297, -0.6613],\n","          [-0.6547, -1.4611,  2.3698,  1.6618, -0.0275]]]])\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"iBY_wuIRvf5j"},"source":["### item\n","- 텐서에 값이 단 하나라도 존재하면 숫자값을 얻을 수 있음\n"]},{"cell_type":"code","metadata":{"id":"E0W24QqpvcmV","executionInfo":{"status":"ok","timestamp":1603627552026,"user_tz":-540,"elapsed":4281,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"69f23df5-063e-487f-b99d-9d66da8a64fe","colab":{"base_uri":"https://localhost:8080/","height":70}},"source":["x = torch.randn(1)\n","print(x)    # x값 출력\n","print(x.item()) # 아이템 값 // 즉 안에있는 실제값 출력\n","print(x.dtype)  # 그 type은? 짜잔\n"],"execution_count":22,"outputs":[{"output_type":"stream","text":["tensor([1.4255])\n","1.4254909753799438\n","torch.float32\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"V1sCUVwC3Nua"},"source":["- 스칼라값 하나만 존재해야함"]},{"cell_type":"code","metadata":{"id":"jl4_FAgd3Lt9","executionInfo":{"status":"error","timestamp":1603627552996,"user_tz":-540,"elapsed":5228,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"92d2da6f-6703-4e44-9853-aed2c912363b","colab":{"base_uri":"https://localhost:8080/","height":239}},"source":["x = torch.randn(2)\n","print(x)    # x값 출력\n","print(x.item()) # only 한개만 가능함 // 2개이상은 작동 안함\n","print(x.dtype)"],"execution_count":23,"outputs":[{"output_type":"stream","text":["tensor([0.9404, 0.8516])\n"],"name":"stdout"},{"output_type":"error","ename":"ValueError","evalue":"ignored","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mValueError\u001b[0m                                Traceback (most recent call last)","\u001b[0;32m<ipython-input-23-860b430e1318>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m()\u001b[0m\n\u001b[1;32m      1\u001b[0m \u001b[0mx\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mtorch\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mrandn\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;36m2\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      2\u001b[0m \u001b[0mprint\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mx\u001b[0m\u001b[0;34m)\u001b[0m    \u001b[0;31m# x값 출력\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----> 3\u001b[0;31m \u001b[0mprint\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mx\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mitem\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;31m# only 한개만 가능함 // 2개이상은 작동 안함\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      4\u001b[0m \u001b[0mprint\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mx\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mdtype\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;31mValueError\u001b[0m: only one element tensors can be converted to Python scalars"]}]},{"cell_type":"markdown","metadata":{"id":"uThndsy5M6wM"},"source":["### squeeze \n","- 차원을 축소(제거)"]},{"cell_type":"code","metadata":{"id":"OF3rOavnRxgM","executionInfo":{"status":"ok","timestamp":1603627558102,"user_tz":-540,"elapsed":1600,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"6cb652be-8560-4b8a-aa29-28d45d93cc58","colab":{"base_uri":"https://localhost:8080/","height":87}},"source":["tensor = torch.rand(1,3,3)\n","print(tensor)\n","print(tensor.shape)"],"execution_count":24,"outputs":[{"output_type":"stream","text":["tensor([[[0.5618, 0.6945, 0.7776],\n","         [0.8073, 0.2228, 0.9136],\n","         [0.4485, 0.7982, 0.5147]]])\n","torch.Size([1, 3, 3])\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"Y2jq0jHJR5Jw","executionInfo":{"status":"ok","timestamp":1603627558104,"user_tz":-540,"elapsed":1325,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"6c7bfbae-6c68-4212-a0d5-f97f29e0395e","colab":{"base_uri":"https://localhost:8080/","height":87}},"source":["t = tensor.squeeze()        # 차원축소하는거라는데 1 값만 가능한거같은데?\n","\n","print(t)\n","print(t.shape)\n"],"execution_count":25,"outputs":[{"output_type":"stream","text":["tensor([[0.5618, 0.6945, 0.7776],\n","        [0.8073, 0.2228, 0.9136],\n","        [0.4485, 0.7982, 0.5147]])\n","torch.Size([3, 3])\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"COv-dnTYNJ8Z"},"source":["### unsqueeze\n","- 차원을 증가(생성)"]},{"cell_type":"code","metadata":{"id":"PFxaHGY1NOBo","executionInfo":{"status":"ok","timestamp":1603627559217,"user_tz":-540,"elapsed":2045,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"8f683062-dd92-48b9-9361-0a94cf381b54","colab":{"base_uri":"https://localhost:8080/","height":87}},"source":["tensor = torch.rand(1,3,3)\n","print(tensor)\n","print(tensor.shape)"],"execution_count":26,"outputs":[{"output_type":"stream","text":["tensor([[[0.4477, 0.1353, 0.5059],\n","         [0.0961, 0.9677, 0.9156],\n","         [0.9067, 0.6630, 0.0780]]])\n","torch.Size([1, 3, 3])\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"b6sa4tJ7SA8G","executionInfo":{"status":"ok","timestamp":1603627559218,"user_tz":-540,"elapsed":1836,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"a087f24a-2ddb-441b-ef17-5210fe077f4c","colab":{"base_uri":"https://localhost:8080/","height":87}},"source":["t = tensor.unsqueeze(dim = 0)\n","\n","print(t)\n","print(t.shape)"],"execution_count":27,"outputs":[{"output_type":"stream","text":["tensor([[[[0.4477, 0.1353, 0.5059],\n","          [0.0961, 0.9677, 0.9156],\n","          [0.9067, 0.6630, 0.0780]]]])\n","torch.Size([1, 1, 3, 3])\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"_C_oa9JANOa6"},"source":["### stack\n","- 텐서간 결합"]},{"cell_type":"code","metadata":{"id":"f3x_XaUYNOuc","executionInfo":{"status":"ok","timestamp":1603627559764,"user_tz":-540,"elapsed":1933,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"5c14e113-d7f6-494a-a0b9-957529f6e28f","colab":{"base_uri":"https://localhost:8080/","height":70}},"source":["x = torch.FloatTensor([1,4])\n","y = torch.FloatTensor([2,5])\n","z = torch.FloatTensor([3,6])\n","\n","\n","print(torch.stack([x,y,z])) # 3개를  붙였네"],"execution_count":28,"outputs":[{"output_type":"stream","text":["tensor([[1., 4.],\n","        [2., 5.],\n","        [3., 6.]])\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"XmJscbfg35-c"},"source":["### cat\n","- 텐서를 결합하는 메소드(concatenate)\n","\n","- 넘파이의 `stack`과 유사하지만, 쌓을 dim이 존재해야함\n","  - 예를 들어, 해당 차원을 늘려준 후 결합\n"]},{"cell_type":"code","metadata":{"id":"Mv3zlaNm37P1","executionInfo":{"status":"ok","timestamp":1603627559765,"user_tz":-540,"elapsed":1677,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"8e3f169e-7d0b-44f6-f6e2-9d24de18be10","colab":{"base_uri":"https://localhost:8080/","height":175}},"source":["a = torch.randn(1,1,3,3)\n","b = torch.randn(1,1,3,3)\n","c = torch.cat((a,b), dim = 0)   # stack이랑 다르게 축을 구분가능\n","print(c)\n","print(c.size())"],"execution_count":29,"outputs":[{"output_type":"stream","text":["tensor([[[[ 0.6599,  0.6929, -0.5050],\n","          [-1.4891, -1.0856,  0.5737],\n","          [-0.5305, -0.3244, -1.3531]]],\n","\n","\n","        [[[-0.0079, -0.0094, -0.2592],\n","          [ 1.1349, -0.3117,  0.5992],\n","          [ 0.8216, -0.3856,  1.2320]]]])\n","torch.Size([2, 1, 3, 3])\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"69M5jY60S7Mi","executionInfo":{"status":"ok","timestamp":1603627560220,"user_tz":-540,"elapsed":1736,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"a06c0fdd-9f4f-49d1-b9c9-ed3f09ba0e64","colab":{"base_uri":"https://localhost:8080/","height":158}},"source":["a = torch.randn(1,3,3)\n","b = torch.randn(1,3,3)\n","c = torch.cat((a,b), dim = 0)   # stack이랑 다르게 축을 구분가능\n","print(c)\n","print(c.size())"],"execution_count":30,"outputs":[{"output_type":"stream","text":["tensor([[[ 0.4395, -1.4690,  0.5723],\n","         [-1.2249,  0.7380,  0.8738],\n","         [ 0.6080,  0.4261, -0.2064]],\n","\n","        [[ 0.7480,  0.7926, -0.1189],\n","         [-0.3821, -0.2661,  0.8438],\n","         [ 0.0023, -0.9992,  0.9431]]])\n","torch.Size([2, 3, 3])\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"7gGXnOAqQTmG"},"source":["### chuck\n","- 텐서를 여러 개로 나눌 때 사용\n","\n","- 몇 개의 텐서로 나눌 것이냐"]},{"cell_type":"code","metadata":{"id":"pNV80VzPQZgG","executionInfo":{"status":"ok","timestamp":1603627560221,"user_tz":-540,"elapsed":1220,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"336c5c75-9a87-4e75-a586-daa963e8de8d","colab":{"base_uri":"https://localhost:8080/","height":228}},"source":["tensor = torch.rand(3,6)\n","t1,t2,t3 = torch.chunk(tensor, 3, dim= 1)   # 몇 개로 나눌거냐고\n","\n","print(tensor)\n","print(t1)\n","print(t2)\n","print(t3)\n","\n"," # let me put to the"],"execution_count":31,"outputs":[{"output_type":"stream","text":["tensor([[0.3324, 0.6677, 0.2555, 0.8195, 0.1123, 0.0013],\n","        [0.5882, 0.2026, 0.1900, 0.5985, 0.6216, 0.3306],\n","        [0.4506, 0.3802, 0.5691, 0.8937, 0.9032, 0.1447]])\n","tensor([[0.3324, 0.6677],\n","        [0.5882, 0.2026],\n","        [0.4506, 0.3802]])\n","tensor([[0.2555, 0.8195],\n","        [0.1900, 0.5985],\n","        [0.5691, 0.8937]])\n","tensor([[0.1123, 0.0013],\n","        [0.6216, 0.3306],\n","        [0.9032, 0.1447]])\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"7U0Qb0jWQgm-"},"source":["### split\n","- `chunck`와 동일한 기능이지만 조금 다름\n","\n","- 하나의 텐서당 크기가 얼마이냐"]},{"cell_type":"code","metadata":{"id":"1V6DDnLVQqxz","executionInfo":{"status":"ok","timestamp":1603627560689,"user_tz":-540,"elapsed":1203,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"4261726b-09a3-4b29-af68-173f6e666f1e","colab":{"base_uri":"https://localhost:8080/","height":175}},"source":["tensor = torch.rand(3,6)\n","t1,t2 = torch.split(tensor, 3, dim = 1) # 3은 하나의 텐서의 크기를 이 량으로 나눈다고\n","\n","print(tensor)\n","print(t1)\n","print(t2)"],"execution_count":32,"outputs":[{"output_type":"stream","text":["tensor([[0.5234, 0.3668, 0.1359, 0.0245, 0.9968, 0.7187],\n","        [0.2618, 0.5943, 0.7211, 0.1974, 0.3285, 0.1747],\n","        [0.5354, 0.0202, 0.8325, 0.2887, 0.9704, 0.8325]])\n","tensor([[0.5234, 0.3668, 0.1359],\n","        [0.2618, 0.5943, 0.7211],\n","        [0.5354, 0.0202, 0.8325]])\n","tensor([[0.0245, 0.9968, 0.7187],\n","        [0.1974, 0.3285, 0.1747],\n","        [0.2887, 0.9704, 0.8325]])\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"estSwhCgvta6"},"source":["### torch ↔ numpy\n","- Torch Tensor(텐서)를 Numpy array(배열)로 변환 가능\n","\n","  - `numpy()`\n","  - `from_numpy()`\n","\n","- (참고)\n","  - Tensor가 CPU상에 있다면 Numpy 배열은 메모리 공간을 공유하므로 하나가 변하면, 다른 하나도 변함"]},{"cell_type":"code","metadata":{"id":"VxHI7c_yvmAT","executionInfo":{"status":"ok","timestamp":1603627562567,"user_tz":-540,"elapsed":1058,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"685f991b-5555-4adb-8aa4-5ebaae780a94","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["a = torch.ones(7)\n","print(a)"],"execution_count":33,"outputs":[{"output_type":"stream","text":["tensor([1., 1., 1., 1., 1., 1., 1.])\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"whbrhokHwJ3A","executionInfo":{"status":"ok","timestamp":1603627563147,"user_tz":-540,"elapsed":1349,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"3be830fd-8467-4293-c392-27c0a989ad7c","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["b = a.numpy()   # numpy로 바꿧지\n","print(b)"],"execution_count":34,"outputs":[{"output_type":"stream","text":["[1. 1. 1. 1. 1. 1. 1.]\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"5StIhUWDwQjA","executionInfo":{"status":"ok","timestamp":1603627563148,"user_tz":-540,"elapsed":1027,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"9804c2f8-0c26-495a-f4a3-47813f7de46a","colab":{"base_uri":"https://localhost:8080/","height":52}},"source":["a. add_(1)  #inplace method이기때문에 1 더해줘야지\n","print(a)\n","print(b)\n","\n","# 메모리가 cpu상에 있기때문에 서로 공유 가능 \n","# numpy인 a에만 더해도 b도 변한다는거지"],"execution_count":35,"outputs":[{"output_type":"stream","text":["tensor([2., 2., 2., 2., 2., 2., 2.])\n","[2. 2. 2. 2. 2. 2. 2.]\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"3RNS5-cRwTt8","executionInfo":{"status":"ok","timestamp":1603627564035,"user_tz":-540,"elapsed":1630,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"fcf84f3f-8a71-4ecc-8f3f-5ee0f015afee","colab":{"base_uri":"https://localhost:8080/","height":52}},"source":["import numpy as np\n","\n","a = np.ones(7)\n","b = torch.from_numpy(a)\n","np.add(a , 1, out=a)\n","print(a)\n","print(b)"],"execution_count":36,"outputs":[{"output_type":"stream","text":["[2. 2. 2. 2. 2. 2. 2.]\n","tensor([2., 2., 2., 2., 2., 2., 2.], dtype=torch.float64)\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"v-ZaxSvLxEej"},"source":["## CUDA Tensors\n","- `.to` 메소드를 사용하여 텐서를 어떠한 장치로도 옮길 수 있음\n","  - 예) cpu, gpu"]},{"cell_type":"code","metadata":{"id":"xkaQznCRxpUj","executionInfo":{"status":"ok","timestamp":1603627564036,"user_tz":-540,"elapsed":1164,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}}},"source":["# 다양한 gpu환경을 제공\n","\n","import torch"],"execution_count":37,"outputs":[]},{"cell_type":"code","metadata":{"id":"SCnC0x2Rxpbk","executionInfo":{"status":"ok","timestamp":1603627564563,"user_tz":-540,"elapsed":991,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"95f641e2-6d27-4f88-9b80-ddf3e2b1dd5b","colab":{"base_uri":"https://localhost:8080/","height":70}},"source":["x = torch.randn(1)\n","print(x)\n","print(x.item())\n","print(x.dtype)"],"execution_count":38,"outputs":[{"output_type":"stream","text":["tensor([-1.1223])\n","-1.1223024129867554\n","torch.float32\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"GcSsFLkDw-nI","executionInfo":{"status":"ok","timestamp":1603627578166,"user_tz":-540,"elapsed":14318,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"cf261113-c975-46f3-ddbf-2b75b3751179","colab":{"base_uri":"https://localhost:8080/","height":70}},"source":["device = torch.device('cuda' if torch.cuda.is_available() else 'cpu')\n","# 만약 cuda냐 cpu냐 \n","# 만약 gpu가 아니다 그럼 cpu를 선택할수잇게\n","\n","# okay, cuda환경으로 옮겼어\n","\n","y = torch.ones_like(x, device = device)\n","x = x.to(device)    # 만들어진 x를 gpu환경으로 옮기겟다\n","z = y+x\n","print(device)\n","print(z)    \n","print(z.to('cpu', torch.double))    # 마지막에 다시 cpu로 바궛지/\n"],"execution_count":39,"outputs":[{"output_type":"stream","text":["cuda\n","tensor([-0.1223], device='cuda:0')\n","tensor([-0.1223], dtype=torch.float64)\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"NKqiGvLWx2nk"},"source":["## AUTOGRAD (자동미분)\n","- autograd 패키지는 Tensor의 모든 연산에 대해 **자동 미분** 제공\n","\n","- 이는 코드를 어떻게 작성하여 실행하느냐에 따라 역전파가 정의된다는 뜻\n","\n","- backprop를 위한 미분값을 자동으로 계산"]},{"cell_type":"markdown","metadata":{"id":"0zH41l-MyMHi"},"source":["### Tensor\n","\n","- data: tensor형태의 데이터\n","\n","- grad: data가 겨쳐온 layer에 대한 미분값 저장\n","\n","- grad_fn: 미분값을 계산한 함수에 대한 정보 저장 (어떤 함수에 대해서 backprop 했는지)\n","\n","- `requires_grad` 속성을 `True`로 설정하면, 해당 텐서에서 이루어지는 모든 연산들을 추적하기 시작\n","\n","- 계산이 완료된 후, `.backward()`를 호출하면 자동으로 `gradient`를 계산할 수 있으며, `.grad` 속성에 누적됨\n","\n","- 기록을 추적하는 것을 중단하게 하려면, `.detach()`를 호출하여 연산기록으로부터 분리\n","\n","- 기록을 추적하는 것을 방지하기 위해 코드 블럭을 `with torch.no_grad():`로 감싸면 `gradient`는 필요없지만, `requires_grad=True`로 설정되어 학습 가능한 매개변수를 갖는 모델을 평가(evaluate)할 때 유용\n","\n","- Autograd 구현에서 매우 중요한 클래스 : `Function` 클래스"]},{"cell_type":"code","metadata":{"id":"ipdk_1jfx47I","executionInfo":{"status":"ok","timestamp":1603627578167,"user_tz":-540,"elapsed":11232,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}}},"source":["import torch"],"execution_count":40,"outputs":[]},{"cell_type":"code","metadata":{"id":"ljNU-r9p0Rpo","executionInfo":{"status":"ok","timestamp":1603627578168,"user_tz":-540,"elapsed":11002,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"b4680379-c582-41bc-9e15-5be6c7f5a4e6","colab":{"base_uri":"https://localhost:8080/","height":70}},"source":["x = torch.ones(3,3,requires_grad=True)\n","print(x)"],"execution_count":41,"outputs":[{"output_type":"stream","text":["tensor([[1., 1., 1.],\n","        [1., 1., 1.],\n","        [1., 1., 1.]], requires_grad=True)\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"or6sQ4EB0UYz","executionInfo":{"status":"ok","timestamp":1603627578169,"user_tz":-540,"elapsed":10644,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"ecc552d4-c703-493d-c159-54e72622c041","colab":{"base_uri":"https://localhost:8080/","height":70}},"source":["y = x+ 5\n","print(y)\n","\n","#add back ward0가 자동으로 붙네"],"execution_count":42,"outputs":[{"output_type":"stream","text":["tensor([[6., 6., 6.],\n","        [6., 6., 6.],\n","        [6., 6., 6.]], grad_fn=<AddBackward0>)\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"PuQ7xDmu0Wpj","executionInfo":{"status":"ok","timestamp":1603627578170,"user_tz":-540,"elapsed":10386,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"04cc8560-794a-4b49-e283-702e9c0a12dc","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["print(y.grad_fn)\n","\n","# 백워드할수 있는 object가 하나 붙은거지"],"execution_count":43,"outputs":[{"output_type":"stream","text":["<AddBackward0 object at 0x7efe26002d68>\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"6_2iM-Zq0ZdG","executionInfo":{"status":"ok","timestamp":1603627578170,"user_tz":-540,"elapsed":10142,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"8e92d54a-2fc0-46be-b160-95bea6067fdd","colab":{"base_uri":"https://localhost:8080/","height":70}},"source":["z = y * y * 2\n","out = z.mean()\n","\n","print(z,out)\n","\n","# mul back ward가 붙었네\n","# mean back ward"],"execution_count":44,"outputs":[{"output_type":"stream","text":["tensor([[72., 72., 72.],\n","        [72., 72., 72.],\n","        [72., 72., 72.]], grad_fn=<MulBackward0>) tensor(72., grad_fn=<MeanBackward0>)\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"2aZ8SWn_0nqt"},"source":["- `requires_grad_(...)`는 기존 텐서의 `requires_grad`값을 바꿔치기(`in-place`)하여 변경"]},{"cell_type":"code","metadata":{"id":"mHGROgrM0ebO","executionInfo":{"status":"ok","timestamp":1603627578171,"user_tz":-540,"elapsed":9682,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"39d7ba12-6b79-4808-d59d-c50ef8ee3d9d","colab":{"base_uri":"https://localhost:8080/","height":70}},"source":["a = torch.randn(3,3)\n","a= ((a * 3) / (a -1))\n","print(a.requires_grad)  # false\n","\n","a.requires_grad_(True)  # true\n","print(a.requires_grad)\n","\n","b = (a *a).sum()\n","print(b.grad_fn)"],"execution_count":45,"outputs":[{"output_type":"stream","text":["False\n","True\n","<SumBackward0 object at 0x7efe2600fd30>\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"KiEn_stZ1VgU"},"source":["### 기울기(Gradient)\n","- 역전파: `.backward()`를 통해 역전파 계산 가능"]},{"cell_type":"code","metadata":{"id":"1tdoN9p-1kn4","executionInfo":{"status":"ok","timestamp":1603627578172,"user_tz":-540,"elapsed":8999,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}}},"source":["out.backward()"],"execution_count":46,"outputs":[]},{"cell_type":"code","metadata":{"id":"CixGTXbV1B9p","executionInfo":{"status":"ok","timestamp":1603627578173,"user_tz":-540,"elapsed":8605,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"f0c0dd1c-9d83-40af-baab-6eeb87bf083d","colab":{"base_uri":"https://localhost:8080/","height":70}},"source":["print(x.grad)"],"execution_count":47,"outputs":[{"output_type":"stream","text":["tensor([[2.6667, 2.6667, 2.6667],\n","        [2.6667, 2.6667, 2.6667],\n","        [2.6667, 2.6667, 2.6667]])\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"SY63Mcc-1iNI","executionInfo":{"status":"ok","timestamp":1603627578173,"user_tz":-540,"elapsed":8265,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"22018a4f-6478-4562-ab3c-074a1bf858e0","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["x = torch.randn(3, requires_grad = True)\n","\n","y = x* 2\n","while y.data.norm() < 1000:\n","    y = y * 2\n","\n","print(y)"],"execution_count":48,"outputs":[{"output_type":"stream","text":["tensor([-1413.9398,   674.2105,   720.0499], grad_fn=<MulBackward0>)\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"YPaVAbIT3gx_","executionInfo":{"status":"ok","timestamp":1603627578174,"user_tz":-540,"elapsed":7994,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"3cbb1b87-924c-4b7b-c17a-b9458db39b1b","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["v = torch.tensor([0.1, 1.0, 0.0001], dtype = torch.float)\n","y.backward(v)\n","\n","print(x.grad)"],"execution_count":49,"outputs":[{"output_type":"stream","text":["tensor([2.0480e+02, 2.0480e+03, 2.0480e-01])\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"0b9amArPXtcX"},"source":["- `with torch.no_grad()`를 사용하여 gradient의 업데이트를 하지 않음"]},{"cell_type":"code","metadata":{"id":"weeIe5_Z3jVe","executionInfo":{"status":"ok","timestamp":1603627578175,"user_tz":-540,"elapsed":7473,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"3296b503-43f9-4bec-fba8-080666ffd21f","colab":{"base_uri":"https://localhost:8080/","height":70}},"source":["print(x.requires_grad)\n","print((x ** 2).requires_grad)\n","\n","with torch.no_grad():   # 옵션을 붙인 상태에서 출력하면 false뜨지\n","    print((x ** 2).requires_grad)\n"],"execution_count":50,"outputs":[{"output_type":"stream","text":["True\n","True\n","False\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"bLcTLVRSmCdH"},"source":["- `detach()`: 내용물(content)은 같지만 require_grad가 다른 새로운 Tensor를 가져올 때"]},{"cell_type":"code","metadata":{"id":"ALcth7Ew3l7H","executionInfo":{"status":"ok","timestamp":1603627578178,"user_tz":-540,"elapsed":7099,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"071a6255-e127-4214-c401-0bf0d4334582","colab":{"base_uri":"https://localhost:8080/","height":70}},"source":["print(x.requires_grad)\n","y = x.detach()\n","print(y.requires_grad)\n","print(x.eq(y).all())\n"],"execution_count":51,"outputs":[{"output_type":"stream","text":["True\n","False\n","tensor(True)\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"NSarysrqBh9D"},"source":["### 자동 미분 흐름 다시 보기(1)\n","- 계산 흐름  \n","  $a \\rightarrow b  \\rightarrow c  \\rightarrow out $\n","\n","<br>\n","\n","## $\\quad \\frac{\\partial out}{\\partial a} = ?$\n","- `backward()`를 통해  \n","  $a \\leftarrow b  \\leftarrow c  \\leftarrow out $을 계산하면  \n","    $\\frac{\\partial out}{\\partial a}$값이 `a.grad`에 채워짐\n"]},{"cell_type":"code","metadata":{"id":"NUAc1etP3oBc","executionInfo":{"status":"ok","timestamp":1603627578179,"user_tz":-540,"elapsed":5970,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}}},"source":["import torch\n"],"execution_count":52,"outputs":[]},{"cell_type":"code","metadata":{"id":"tCW7dq9uB89T","executionInfo":{"status":"ok","timestamp":1603627578180,"user_tz":-540,"elapsed":5758,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"bdf6d088-2e02-4cd8-8313-b39b89f2f2bd","colab":{"base_uri":"https://localhost:8080/","height":52}},"source":["a = torch.ones(2,2)\n","print(a)"],"execution_count":53,"outputs":[{"output_type":"stream","text":["tensor([[1., 1.],\n","        [1., 1.]])\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"-AyyGy49FLz9","executionInfo":{"status":"ok","timestamp":1603627579575,"user_tz":-540,"elapsed":6905,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"65d067b2-1427-4518-f5ee-c2a542fcfb10","colab":{"base_uri":"https://localhost:8080/","height":52}},"source":["a = torch.ones(2,2, requires_grad = True)\n","print(a)# 옵션 붙어있는고 확인하고"],"execution_count":54,"outputs":[{"output_type":"stream","text":["tensor([[1., 1.],\n","        [1., 1.]], requires_grad=True)\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"SmmJa-hvFPGH","executionInfo":{"status":"ok","timestamp":1603627579577,"user_tz":-540,"elapsed":6634,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"ea8b8a93-0be3-4012-decb-87ac133c5e17","colab":{"base_uri":"https://localhost:8080/","height":87}},"source":["print('a.data:' , a)\n","print('a.grad:', a.grad)\n","print('a.grad_fn', a.grad_fn)   # a의 그래드의 function"],"execution_count":55,"outputs":[{"output_type":"stream","text":["a.data: tensor([[1., 1.],\n","        [1., 1.]], requires_grad=True)\n","a.grad: None\n","a.grad_fn None\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"BCwhTsiHGCmG"},"source":["- $b = a + 2$"]},{"cell_type":"code","metadata":{"id":"iUPt042iF9V1","executionInfo":{"status":"ok","timestamp":1603627579580,"user_tz":-540,"elapsed":6074,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"43978ddc-dd7f-4e7a-d6b6-a4e70755e7de","colab":{"base_uri":"https://localhost:8080/","height":52}},"source":["# 계산이 이루어쟈야겟지\n","\n","b = a+2\n","print(b)"],"execution_count":56,"outputs":[{"output_type":"stream","text":["tensor([[3., 3.],\n","        [3., 3.]], grad_fn=<AddBackward0>)\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"6cw2zoq9GHLF"},"source":["- $c = b^2$ "]},{"cell_type":"code","metadata":{"id":"FRDS6gP0GFZG","executionInfo":{"status":"ok","timestamp":1603627579584,"user_tz":-540,"elapsed":5570,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"500ac96e-f248-43f8-cf30-32b223e2eab0","colab":{"base_uri":"https://localhost:8080/","height":52}},"source":["c = b**2\n","print(c)\n","# powerback ward"],"execution_count":57,"outputs":[{"output_type":"stream","text":["tensor([[9., 9.],\n","        [9., 9.]], grad_fn=<PowBackward0>)\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"VynoiUywGSwh","executionInfo":{"status":"ok","timestamp":1603627579586,"user_tz":-540,"elapsed":5475,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"6689942e-1462-4ee0-8c6b-1938006ee627","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["out = c.sum()\n","print(out)\n","# 9*4 = 36"],"execution_count":58,"outputs":[{"output_type":"stream","text":["tensor(36., grad_fn=<SumBackward0>)\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"v3ryJon9GeMn","executionInfo":{"status":"ok","timestamp":1603627579589,"user_tz":-540,"elapsed":5067,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"96e32a37-8077-4536-8587-e4261389d662","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["print(out)\n","out.backward()\n","\n","# 가장 나중에 했던 sum back ward가 나오겟지"],"execution_count":59,"outputs":[{"output_type":"stream","text":["tensor(36., grad_fn=<SumBackward0>)\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"f0aoNsPDHsoG"},"source":["- a의 `grad_fn`이 None인 이유  \n","  직접적으로 계산한 부분이 없었기 때문"]},{"cell_type":"code","metadata":{"id":"bccI4vIWGgqj","executionInfo":{"status":"ok","timestamp":1603627579591,"user_tz":-540,"elapsed":4703,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"b137e14e-4527-417a-bc22-0a088639b0de","colab":{"base_uri":"https://localhost:8080/","height":105}},"source":["print('a.data:' , a)\n","print('a.grad:', a.grad)\n","print('a.grad_fn', a.grad_fn)"],"execution_count":60,"outputs":[{"output_type":"stream","text":["a.data: tensor([[1., 1.],\n","        [1., 1.]], requires_grad=True)\n","a.grad: tensor([[6., 6.],\n","        [6., 6.]])\n","a.grad_fn None\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"oka1mkadHq-N","executionInfo":{"status":"ok","timestamp":1603627579594,"user_tz":-540,"elapsed":4468,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"bafc7e6d-4f8a-4f2a-e7b5-c6effb69b561","colab":{"base_uri":"https://localhost:8080/","height":142}},"source":["print('b.data:' , b.data)\n","print('b.grad:', b.grad)\n","print('b.grad_fn', b.grad_fn)"],"execution_count":61,"outputs":[{"output_type":"stream","text":["b.data: tensor([[3., 3.],\n","        [3., 3.]])\n","b.grad: None\n","b.grad_fn <AddBackward0 object at 0x7efe26074e48>\n"],"name":"stdout"},{"output_type":"stream","text":["/usr/local/lib/python3.6/dist-packages/ipykernel_launcher.py:2: UserWarning: The .grad attribute of a Tensor that is not a leaf Tensor is being accessed. Its .grad attribute won't be populated during autograd.backward(). If you indeed want the gradient for a non-leaf Tensor, use .retain_grad() on the non-leaf Tensor. If you access the non-leaf Tensor by mistake, make sure you access the leaf Tensor instead. See github.com/pytorch/pytorch/pull/30531 for more informations.\n","  \n"],"name":"stderr"}]},{"cell_type":"code","metadata":{"id":"ZiYNajdLccUF","executionInfo":{"status":"ok","timestamp":1603627579595,"user_tz":-540,"elapsed":4237,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"0baf5910-7b24-4884-e67c-73294dab9095","colab":{"base_uri":"https://localhost:8080/","height":142}},"source":["print('c.data:' , c.data)\n","print('c.grad:', c.grad)\n","print('c.grad_fn', c.grad_fn)"],"execution_count":62,"outputs":[{"output_type":"stream","text":["c.data: tensor([[9., 9.],\n","        [9., 9.]])\n","c.grad: None\n","c.grad_fn <PowBackward0 object at 0x7efe26074a90>\n"],"name":"stdout"},{"output_type":"stream","text":["/usr/local/lib/python3.6/dist-packages/ipykernel_launcher.py:2: UserWarning: The .grad attribute of a Tensor that is not a leaf Tensor is being accessed. Its .grad attribute won't be populated during autograd.backward(). If you indeed want the gradient for a non-leaf Tensor, use .retain_grad() on the non-leaf Tensor. If you access the non-leaf Tensor by mistake, make sure you access the leaf Tensor instead. See github.com/pytorch/pytorch/pull/30531 for more informations.\n","  \n"],"name":"stderr"}]},{"cell_type":"code","metadata":{"id":"BcLoMYite0vU","executionInfo":{"status":"ok","timestamp":1603627579600,"user_tz":-540,"elapsed":3967,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"3215ddc4-7e7c-44d8-9069-fae76515f60f","colab":{"base_uri":"https://localhost:8080/","height":125}},"source":["print('out.data:' , out.data)\n","print('out.grad:', out.grad)    # sum back word로 되어 잇구만\n","print('out.grad_fn', out.grad_fn)"],"execution_count":63,"outputs":[{"output_type":"stream","text":["out.data: tensor(36.)\n","out.grad: None\n","out.grad_fn <SumBackward0 object at 0x7efe260741d0>\n"],"name":"stdout"},{"output_type":"stream","text":["/usr/local/lib/python3.6/dist-packages/ipykernel_launcher.py:2: UserWarning: The .grad attribute of a Tensor that is not a leaf Tensor is being accessed. Its .grad attribute won't be populated during autograd.backward(). If you indeed want the gradient for a non-leaf Tensor, use .retain_grad() on the non-leaf Tensor. If you access the non-leaf Tensor by mistake, make sure you access the leaf Tensor instead. See github.com/pytorch/pytorch/pull/30531 for more informations.\n","  \n"],"name":"stderr"}]},{"cell_type":"markdown","metadata":{"id":"qZXgwviHfovj"},"source":["### 자동 미분 흐름 다시 보기(2)\n","- `grad`값을 넣어서 `backward`\n","\n","- 아래의 코드에서 `.grad`값이 None은 gradient값이 필요하지 않기 때문"]},{"cell_type":"code","metadata":{"id":"bB6DCYXRfcI_","executionInfo":{"status":"ok","timestamp":1603627579604,"user_tz":-540,"elapsed":3588,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"4bfb48bc-6330-451a-8c04-15a8ee593a5c","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["x = torch.ones(3, requires_grad = True)\n","y = (x**2)\n","z = y ** 2 + x\n","out = z.sum()\n","print(out)"],"execution_count":64,"outputs":[{"output_type":"stream","text":["tensor(6., grad_fn=<SumBackward0>)\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"AVo-glm8fvFv","executionInfo":{"status":"ok","timestamp":1603627604197,"user_tz":-540,"elapsed":728,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}}},"source":["grad = torch.Tensor([0.1,1,100])\n","z.backward(grad)\n","\n"],"execution_count":65,"outputs":[]},{"cell_type":"code","metadata":{"id":"tdBklrepf2qq","executionInfo":{"status":"ok","timestamp":1603627637195,"user_tz":-540,"elapsed":854,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"8d5a7459-47ce-4c73-ea2f-a3241577431a","colab":{"base_uri":"https://localhost:8080/","height":70}},"source":["print('x.data:' , x.data)\n","print('x.grad:', x.grad)\n","print('x.grad_fn', x.grad_fn)"],"execution_count":66,"outputs":[{"output_type":"stream","text":["x.data: tensor([1., 1., 1.])\n","x.grad: tensor([  0.5000,   5.0000, 500.0000])\n","x.grad_fn None\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"HQvUGlfRf7jU","executionInfo":{"status":"ok","timestamp":1603627684422,"user_tz":-540,"elapsed":711,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"740224b6-e4a0-4fdb-8abe-73d936ac9952","colab":{"base_uri":"https://localhost:8080/","height":125}},"source":["print('y.data:' , y.data)\n","print('y.grad:', y.grad)    # none\n","print('y.grad_fn', y.grad_fn)"],"execution_count":67,"outputs":[{"output_type":"stream","text":["y.data: tensor([1., 1., 1.])\n","y.grad: None\n","y.grad_fn <PowBackward0 object at 0x7efe1d1fb2b0>\n"],"name":"stdout"},{"output_type":"stream","text":["/usr/local/lib/python3.6/dist-packages/ipykernel_launcher.py:2: UserWarning: The .grad attribute of a Tensor that is not a leaf Tensor is being accessed. Its .grad attribute won't be populated during autograd.backward(). If you indeed want the gradient for a non-leaf Tensor, use .retain_grad() on the non-leaf Tensor. If you access the non-leaf Tensor by mistake, make sure you access the leaf Tensor instead. See github.com/pytorch/pytorch/pull/30531 for more informations.\n","  \n"],"name":"stderr"}]},{"cell_type":"code","metadata":{"id":"h7TFHdMfgxvW","executionInfo":{"status":"ok","timestamp":1603627706689,"user_tz":-540,"elapsed":1917,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"b451cc6e-1f21-4bea-b97c-720c69aaa7af","colab":{"base_uri":"https://localhost:8080/","height":125}},"source":["print('z.data:' , z.data)\n","print('z.grad:', z.grad)    # none\n","print('z.grad_fn', z.grad_fn)"],"execution_count":68,"outputs":[{"output_type":"stream","text":["z.data: tensor([2., 2., 2.])\n","z.grad: None\n","z.grad_fn <AddBackward0 object at 0x7efe1d1fb1d0>\n"],"name":"stdout"},{"output_type":"stream","text":["/usr/local/lib/python3.6/dist-packages/ipykernel_launcher.py:2: UserWarning: The .grad attribute of a Tensor that is not a leaf Tensor is being accessed. Its .grad attribute won't be populated during autograd.backward(). If you indeed want the gradient for a non-leaf Tensor, use .retain_grad() on the non-leaf Tensor. If you access the non-leaf Tensor by mistake, make sure you access the leaf Tensor instead. See github.com/pytorch/pytorch/pull/30531 for more informations.\n","  \n"],"name":"stderr"}]},{"cell_type":"markdown","metadata":{"id":"DKv-osmNmWiA"},"source":["## nn & nn.functional\n","\n","- 두 패키지가 같은 기능이지만 방식이 조금 다름\n","\n","- 위의 `autograd` 관련 작업들을 두 패키지를 통해 진행할 수 있음\n","\n","- 텐서를 직접 다룰 때 `requires_grad`와 같은 방식으로 진행할 수 있음\n","\n","- 결론적으로, `torch.nn`은 attribute를 활용해 state를 저장하고 활용하고,  \n","  `torch.nn.functional`로 구현한 함수의 경우에는 인스턴스화 시킬 필요 없이 사용이 가능\n"," \n"]},{"cell_type":"markdown","metadata":{"id":"jk8fkKq3nWP1"},"source":["### nn 패키지\n","\n","- 주로 가중치(weights), 편향(bias)값들이 내부에서 자동으로 생성되는 레이어들을 사용할 때  \n","  - 따라서, `weight`값들을 직접 선언 안함\n","\n","- 예시\n","  - Containers\n","\n","  - Convolution Layers\n","\n","  - Pooling layers\n","\n","  - Padding Layers\n","\n","  - Non-linear Activations (weighted sum, nonlinearity)\n","\n","  - Non-linear Activations (other)\n","\n","  - Normalization Layers\n","\n","  - Recurrent Layers\n","\n","  - Transformer Layers\n","\n","  - Linear Layers\n","\n","  - Dropout Layers\n","\n","  - Sparse Layers\n","\n","  - Distance Functions\n","\n","  - Loss Functions\n","\n","  - ..\n","- https://pytorch.org/docs/stable/nn.html\n","\n"]},{"cell_type":"code","metadata":{"id":"8tEtWHAsmZMy","executionInfo":{"status":"ok","timestamp":1603627975648,"user_tz":-540,"elapsed":3100,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}}},"source":["import torch\n","import torch.nn as nn\n"],"execution_count":69,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"NcjCbeEQqPSI"},"source":["- Convolution Layer 예시 (1)\n"]},{"cell_type":"code","metadata":{"id":"NQ7Y0tCOpkhM","executionInfo":{"status":"ok","timestamp":1603628197085,"user_tz":-540,"elapsed":1349,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"10882211-7117-43f4-afd7-1e301970d930","colab":{"base_uri":"https://localhost:8080/","height":1000}},"source":["m = nn.Conv2d(16, 33, 3, stride = 2)    # square\n","\n","m = nn.Conv2d(16, 33, (3,5), stride= (2,1), padding = (4,2))   # non square\n","\n","m = nn.Conv2d(16, 33, (3,5), stride =(2,1), padding = (4,2), dilation = (3,1))\n","\n","input = torch.randn(20,16, 50 ,100)\n","print(input)\n","output = m(input)\n","print(output)"],"execution_count":74,"outputs":[{"output_type":"stream","text":["tensor([[[[ 9.0434e-01,  1.0556e+00,  8.1675e-01,  ..., -2.0541e-01,\n","            5.4483e-01,  1.2085e+00],\n","          [-1.5186e-01,  1.3970e+00, -1.1571e+00,  ...,  5.2385e-01,\n","            1.1286e+00,  2.0975e-01],\n","          [-6.7148e-01, -1.1425e+00, -7.7663e-01,  ...,  1.7907e+00,\n","           -6.0903e-02, -2.1721e+00],\n","          ...,\n","          [-1.0439e+00,  1.8451e+00,  1.5237e+00,  ...,  1.3154e+00,\n","           -1.0658e+00,  7.1141e-01],\n","          [ 3.3540e-01, -1.7209e-02,  4.8014e-01,  ..., -1.6501e+00,\n","            1.3006e+00,  1.0764e-01],\n","          [-1.4474e+00, -2.2560e-01,  5.0356e-01,  ...,  1.1868e+00,\n","            5.5782e-01, -1.2969e+00]],\n","\n","         [[ 8.4690e-02,  1.7674e+00, -2.0076e+00,  ...,  1.2199e+00,\n","            3.8582e-01, -2.3175e+00],\n","          [-8.8453e-01,  7.0648e-01, -1.6382e+00,  ...,  6.5962e-01,\n","           -7.1385e-01,  5.6833e-01],\n","          [-1.7372e-01, -2.3547e-01,  2.0766e+00,  ..., -1.2413e+00,\n","           -5.9368e-01,  9.0539e-01],\n","          ...,\n","          [-4.7146e-01,  1.8143e+00,  1.6969e-01,  ...,  9.6204e-01,\n","           -2.8385e-01, -4.0646e-01],\n","          [-8.5416e-01, -2.2076e+00,  1.2443e+00,  ..., -1.7505e+00,\n","           -1.0194e+00,  1.1997e+00],\n","          [ 1.1864e+00,  9.8423e-01,  7.1706e-01,  ..., -5.9736e-01,\n","            4.0698e-01, -1.9217e+00]],\n","\n","         [[ 1.4171e+00,  3.5269e-01, -1.0570e+00,  ...,  9.1628e-01,\n","           -7.7491e-01, -1.3112e-01],\n","          [-5.6827e-01,  8.8086e-01,  2.8737e-01,  ...,  1.6388e-01,\n","           -5.7894e-01,  8.5506e-01],\n","          [ 1.0158e-01,  1.6418e-02,  5.3728e-01,  ...,  7.4655e-01,\n","            7.3507e-01,  6.0263e-01],\n","          ...,\n","          [ 2.2547e-01, -1.1587e+00,  1.2297e+00,  ..., -1.5072e+00,\n","            1.7447e+00,  2.9163e-01],\n","          [ 8.1706e-01,  9.6499e-01,  3.6881e-01,  ..., -2.7817e-02,\n","           -6.5322e-01, -2.0811e+00],\n","          [-3.2582e-01,  3.1180e-01, -1.1812e+00,  ..., -4.6606e-01,\n","           -5.3032e-02,  1.2222e+00]],\n","\n","         ...,\n","\n","         [[ 8.6742e-01,  1.4952e+00, -2.2951e-01,  ..., -6.3896e-01,\n","           -1.8662e+00,  1.0897e+00],\n","          [ 1.4670e-01, -4.0563e-01, -1.6696e+00,  ..., -1.5299e+00,\n","           -1.1012e+00, -6.9891e-01],\n","          [-9.5893e-01,  1.5928e+00,  4.9193e-01,  ...,  5.2242e-02,\n","            1.3207e+00, -1.0590e+00],\n","          ...,\n","          [-1.5415e+00,  1.5210e+00, -7.1461e-01,  ..., -1.1767e+00,\n","            9.9049e-01,  9.5764e-01],\n","          [-2.3102e+00,  9.6368e-02, -1.5703e+00,  ..., -9.6181e-01,\n","           -2.8007e-01,  5.0367e-01],\n","          [ 7.0917e-01, -9.3603e-01,  3.7776e-01,  ..., -2.1167e+00,\n","           -3.1144e-01,  3.4399e-01]],\n","\n","         [[-2.5321e+00, -4.2626e-01, -5.0345e-01,  ...,  4.9824e-03,\n","            5.5025e-01,  7.5239e-01],\n","          [ 4.4323e-02,  1.9648e+00,  1.4189e+00,  ...,  5.2266e-01,\n","           -5.0253e-02,  3.4487e-01],\n","          [-1.3651e-01, -1.0975e+00, -1.6734e+00,  ..., -2.3983e-01,\n","           -1.4008e-01,  1.8919e+00],\n","          ...,\n","          [ 5.3209e-01,  7.5585e-01,  4.6869e-01,  ...,  6.9224e-01,\n","            2.2822e-01, -1.5829e-01],\n","          [-6.4599e-02, -7.9918e-02,  1.5338e+00,  ...,  4.0167e-01,\n","           -2.3899e-01,  7.5977e-01],\n","          [ 1.2882e+00, -6.8257e-01, -1.6762e+00,  ...,  1.8523e+00,\n","           -2.6839e-01, -4.0005e-01]],\n","\n","         [[-1.5187e+00, -1.7379e+00, -2.4612e-03,  ...,  1.8195e+00,\n","           -8.5794e-01,  3.7321e-01],\n","          [-2.8867e-01,  1.4834e+00,  6.6714e-01,  ..., -7.1292e-01,\n","            2.1137e-01,  5.9300e-01],\n","          [-9.2125e-01, -3.8780e-01,  7.3180e-01,  ..., -4.1843e-01,\n","           -5.9586e-01,  1.0315e+00],\n","          ...,\n","          [ 5.8968e-01,  2.0249e+00, -9.6713e-01,  ...,  8.6710e-01,\n","           -2.3111e-01,  1.8679e+00],\n","          [ 7.4416e-01, -4.0140e-01,  5.0222e-01,  ..., -8.7005e-01,\n","            1.0833e+00,  1.5333e+00],\n","          [-6.5819e-01,  1.0495e+00,  1.6812e-01,  ...,  9.4121e-01,\n","            5.4608e-01, -1.0078e+00]]],\n","\n","\n","        [[[-7.9118e-01, -1.2622e+00, -9.9129e-01,  ..., -1.2732e-02,\n","            4.6990e-01, -1.6436e+00],\n","          [-2.0851e-01, -1.6744e-02, -1.0447e-01,  ...,  4.9514e-01,\n","            5.8459e-01, -5.2657e-01],\n","          [-4.6086e-01,  1.2221e+00,  3.8452e+00,  ..., -1.4531e+00,\n","           -5.6560e-01, -5.9222e-01],\n","          ...,\n","          [ 5.3866e-01, -8.8434e-01,  6.6071e-01,  ..., -7.1429e-01,\n","            6.8901e-01, -7.7697e-01],\n","          [ 1.1634e+00, -5.9526e-01, -2.2943e-01,  ...,  3.5645e-01,\n","            7.5142e-01, -1.4959e+00],\n","          [-4.2262e-01,  8.9142e-01,  4.0929e-01,  ..., -6.2157e-01,\n","           -2.0432e+00, -5.5484e-01]],\n","\n","         [[ 1.7478e+00,  8.3378e-01, -4.1315e-02,  ..., -1.8810e-01,\n","           -6.7445e-01, -1.4609e-01],\n","          [-1.5392e+00,  7.6238e-01,  3.7855e-02,  ..., -1.1389e+00,\n","            1.2637e+00,  1.0560e-01],\n","          [-3.3177e-01,  3.2424e-02, -2.8747e-02,  ..., -3.8496e-01,\n","            1.6733e+00, -7.7319e-01],\n","          ...,\n","          [-3.5945e-01,  6.6785e-01,  1.0539e+00,  ...,  7.2550e-02,\n","           -7.7190e-01,  3.1352e-01],\n","          [ 6.1599e-01, -3.8461e-01, -8.1865e-01,  ..., -8.4328e-01,\n","           -1.1547e-01,  9.1896e-01],\n","          [-7.9792e-01, -1.2518e+00,  1.4779e+00,  ...,  2.5003e-01,\n","            6.4584e-02,  1.4769e+00]],\n","\n","         [[ 1.8337e+00, -6.0584e-02,  2.9543e-01,  ..., -1.4926e+00,\n","           -1.6047e-01,  3.5439e-01],\n","          [-3.1708e-01,  2.2048e-01, -9.7305e-01,  ..., -3.5146e-01,\n","            2.7463e-02, -6.0030e-01],\n","          [-1.3258e-01,  1.6747e+00,  5.9878e-01,  ...,  2.6708e-01,\n","           -2.9127e-02,  1.2974e+00],\n","          ...,\n","          [-1.2336e-01, -1.0414e-01, -1.2386e-01,  ...,  9.0110e-01,\n","           -4.3066e-01,  3.7791e-03],\n","          [ 3.6795e-01, -8.5790e-02,  2.3805e-01,  ..., -6.7586e-02,\n","           -1.6586e-01,  5.7071e-01],\n","          [ 4.5082e-01,  3.0067e-01, -4.4871e-01,  ..., -1.6548e+00,\n","            2.9867e-01,  2.1818e+00]],\n","\n","         ...,\n","\n","         [[-2.3269e-01,  2.6175e-01,  1.0839e+00,  ..., -1.1308e+00,\n","            1.9611e-01,  4.0047e-01],\n","          [-6.3390e-01, -1.3486e-02, -1.5701e+00,  ..., -6.1824e-01,\n","            8.6190e-01,  4.5253e-01],\n","          [-1.0148e+00, -1.7392e+00,  5.5854e-01,  ...,  6.4170e-01,\n","            1.5913e-01,  2.3334e-01],\n","          ...,\n","          [ 4.0453e-01,  1.2878e+00, -8.4097e-01,  ..., -7.1108e-01,\n","            1.7831e+00,  6.0117e-01],\n","          [-7.3092e-01, -2.2016e+00,  2.1703e-02,  ...,  4.4629e-03,\n","            5.0174e-01, -1.9967e+00],\n","          [-1.6028e-01,  1.8941e+00, -5.0382e-03,  ..., -1.0007e+00,\n","            5.3624e-01,  3.8420e-01]],\n","\n","         [[-5.5903e-01,  4.5779e-01,  3.7180e-01,  ..., -8.3117e-01,\n","            2.5904e-01, -1.3412e+00],\n","          [-2.4470e-01,  2.0579e+00,  1.5721e-01,  ...,  8.4001e-02,\n","           -7.6377e-01, -5.2576e-01],\n","          [ 2.6858e-01,  9.0694e-01,  1.5708e-01,  ..., -5.9079e-01,\n","           -5.7288e-01, -3.0244e-01],\n","          ...,\n","          [ 6.2780e-03, -8.2111e-01, -1.3172e+00,  ...,  1.4332e+00,\n","           -1.1028e+00,  2.9519e-01],\n","          [ 1.1537e-01, -8.4629e-01,  1.7305e+00,  ...,  1.1847e+00,\n","            6.0563e-01,  3.2436e-01],\n","          [-1.6443e-01,  1.9835e+00, -1.1401e+00,  ..., -1.7445e-02,\n","           -3.9791e-01, -8.8062e-01]],\n","\n","         [[-8.2654e-01,  1.6558e+00, -5.9392e-01,  ..., -1.0854e+00,\n","           -7.3869e-01,  4.7878e-01],\n","          [ 4.8096e-01, -4.7188e-01, -1.5674e+00,  ...,  1.1830e-01,\n","           -2.6747e-01,  8.7011e-01],\n","          [-2.2154e-01, -1.9059e+00, -3.2561e-02,  ...,  4.3091e-01,\n","           -2.4443e-01, -1.2103e+00],\n","          ...,\n","          [ 4.9969e-02,  4.7590e-01,  1.7758e+00,  ...,  3.0271e+00,\n","           -1.1929e+00, -8.9660e-01],\n","          [ 1.7388e+00, -3.8196e-01, -2.8858e-01,  ...,  4.7514e-01,\n","           -1.2390e+00, -2.4687e+00],\n","          [-1.7365e-01, -1.1209e+00, -8.5795e-01,  ...,  6.5875e-01,\n","            5.2029e-01, -1.5480e-01]]],\n","\n","\n","        [[[ 4.1158e-01, -8.3060e-01,  3.6354e-01,  ..., -1.0484e+00,\n","            9.0105e-01, -9.9828e-01],\n","          [-6.7817e-01,  7.9860e-01,  4.5457e-01,  ..., -1.2476e+00,\n","            3.5427e-01,  3.0008e-01],\n","          [-6.4275e-01, -5.5583e-02, -1.3597e+00,  ..., -1.8190e+00,\n","            2.3588e-01, -1.4449e+00],\n","          ...,\n","          [-1.6593e+00,  1.2130e+00,  3.5498e-01,  ...,  1.0708e+00,\n","           -3.9870e-01,  5.1034e-01],\n","          [ 4.6068e-01,  1.1886e+00, -2.6294e+00,  ..., -2.3461e+00,\n","           -6.3757e-01, -4.8617e-01],\n","          [ 1.6105e-01,  1.4088e+00, -2.3422e-01,  ...,  7.0193e-01,\n","           -1.0794e+00, -5.1960e-01]],\n","\n","         [[ 1.7422e-03, -8.8250e-01,  1.1512e-01,  ...,  8.9941e-02,\n","            2.1989e-01,  4.2920e-01],\n","          [-6.9159e-01,  1.9634e-01, -1.7086e+00,  ...,  7.8980e-01,\n","            1.1456e+00,  2.1224e+00],\n","          [ 1.4054e+00,  2.2284e-01, -1.7086e+00,  ..., -8.7764e-01,\n","           -3.0829e-01,  8.2975e-01],\n","          ...,\n","          [ 3.5814e-02,  6.7892e-01,  6.5560e-01,  ...,  4.6750e-01,\n","            6.0762e-01,  6.6025e-01],\n","          [-4.9266e-01,  1.9559e-01, -3.6915e-01,  ..., -1.2613e+00,\n","            4.7935e-02,  1.2330e+00],\n","          [ 2.2665e-01, -5.9040e-02, -8.2017e-01,  ...,  5.0515e-01,\n","            8.9667e-02,  1.0576e+00]],\n","\n","         [[ 4.6331e-01, -9.6414e-01, -2.3598e+00,  ..., -2.9477e-01,\n","            5.8213e-01, -2.7632e-01],\n","          [-8.3211e-01,  3.7619e-01, -6.6265e-01,  ...,  9.7576e-01,\n","            6.0939e-01, -1.0909e+00],\n","          [ 4.5241e-01,  3.8072e-02,  7.9589e-01,  ...,  2.1391e+00,\n","           -2.6767e-01, -1.4534e+00],\n","          ...,\n","          [-5.2000e-01, -2.1181e-01, -8.3568e-01,  ..., -5.5037e-01,\n","           -2.6318e-01,  2.1802e+00],\n","          [-6.7620e-01, -1.2782e-01,  1.1166e+00,  ..., -2.3429e-01,\n","           -1.0418e+00, -1.2841e+00],\n","          [-2.8530e-01, -3.4286e-01, -3.3573e-01,  ..., -1.6349e-01,\n","           -1.6931e+00,  2.1484e-01]],\n","\n","         ...,\n","\n","         [[-1.3924e+00, -5.7024e-01, -3.1492e-01,  ..., -1.5688e+00,\n","            9.6589e-01,  1.0957e-01],\n","          [ 1.9205e+00,  2.6763e-02, -4.4281e-01,  ...,  9.1294e-01,\n","           -7.1282e-01, -9.7343e-02],\n","          [ 4.4165e-01,  5.7402e-01,  4.8106e-01,  ..., -1.1331e+00,\n","           -7.9258e-01,  1.1787e+00],\n","          ...,\n","          [-1.0196e+00,  3.5277e-01, -2.0830e-01,  ..., -2.4096e-01,\n","           -1.5409e+00,  1.5440e-01],\n","          [-1.7988e+00, -3.3795e-01, -1.4439e+00,  ..., -2.1981e+00,\n","            1.9257e+00, -1.8648e-02],\n","          [-1.1212e+00,  4.1338e-01, -1.0596e+00,  ..., -5.9456e-01,\n","            1.3692e+00,  5.2453e-02]],\n","\n","         [[ 8.1782e-01,  3.7836e-01,  1.5548e+00,  ...,  5.4142e-01,\n","           -5.0432e-01, -7.7710e-01],\n","          [-4.2755e-01,  5.3886e-01, -1.2998e+00,  ...,  4.3658e-01,\n","           -3.0008e+00,  1.0613e+00],\n","          [ 8.0309e-02,  4.7773e-01, -9.1101e-01,  ...,  6.9237e-01,\n","           -5.2017e-01, -3.9306e-01],\n","          ...,\n","          [ 1.8686e+00, -1.1516e+00, -1.4447e+00,  ..., -4.1995e-01,\n","           -1.3814e+00,  2.3831e+00],\n","          [ 5.5909e-02, -6.7667e-03,  9.9728e-01,  ...,  1.0640e+00,\n","            8.7894e-01, -1.8462e-01],\n","          [-1.1027e+00, -7.6677e-01,  1.0153e+00,  ...,  1.2908e+00,\n","            1.1944e+00, -1.2907e-01]],\n","\n","         [[-1.6696e+00, -5.6306e-01, -1.0400e+00,  ..., -6.5503e-01,\n","           -1.1098e+00, -2.9856e-01],\n","          [ 2.4476e+00, -6.3923e-02, -1.5662e-01,  ...,  1.4097e+00,\n","           -1.0758e+00,  6.4123e-01],\n","          [ 1.0307e+00,  4.6786e-01, -1.4076e+00,  ...,  5.3459e-01,\n","            8.8091e-01, -2.9552e-01],\n","          ...,\n","          [-4.0259e-01, -1.4604e+00, -1.2165e+00,  ..., -1.4837e+00,\n","            6.5547e-01, -1.5034e+00],\n","          [-6.0690e-01, -1.7706e-01,  3.0507e-01,  ..., -4.0575e-01,\n","           -2.4943e-01,  2.2647e+00],\n","          [-8.6280e-01, -1.8442e+00,  2.7621e-02,  ...,  1.2878e+00,\n","            8.2970e-01,  6.5526e-02]]],\n","\n","\n","        ...,\n","\n","\n","        [[[ 4.1992e-01,  2.0398e+00, -1.0313e+00,  ...,  3.2246e-02,\n","            1.4075e+00,  1.2411e-01],\n","          [ 1.3603e+00, -7.8976e-01, -2.2842e-01,  ..., -2.3180e+00,\n","            7.3135e-02,  4.5520e-01],\n","          [-6.2549e-01,  4.2245e-01,  2.9079e-01,  ...,  4.3359e-01,\n","            1.6831e-01, -2.0888e+00],\n","          ...,\n","          [-8.5515e-01, -1.2842e+00, -1.2495e+00,  ..., -1.3442e-01,\n","           -6.6786e-02,  1.6346e+00],\n","          [-5.7191e-01, -3.6951e-01,  1.8162e+00,  ..., -2.7275e-01,\n","            3.9968e-01,  5.9471e-01],\n","          [-3.4840e-01,  7.0065e-01, -3.7847e-01,  ..., -1.1888e+00,\n","           -2.8460e-01,  1.5428e-01]],\n","\n","         [[ 2.0171e-02, -4.4836e-01, -1.0763e+00,  ...,  5.8924e-01,\n","            1.5862e+00,  4.8822e-01],\n","          [-3.2249e-01,  4.8308e-01,  3.0431e-01,  ..., -5.8335e-01,\n","           -4.0812e-01,  3.9381e-01],\n","          [-2.1078e+00, -4.1937e-01, -1.3487e+00,  ...,  2.0790e+00,\n","            3.5268e-01,  8.4754e-01],\n","          ...,\n","          [-2.9132e-01,  1.6374e+00,  1.1001e+00,  ..., -9.8204e-02,\n","           -6.7322e-01,  9.7249e-01],\n","          [-9.5104e-01,  6.0842e-01, -4.9860e-01,  ...,  1.8231e-01,\n","           -1.1466e+00, -5.1427e-01],\n","          [ 1.7328e+00, -5.6152e-01,  6.9245e-01,  ..., -1.6369e+00,\n","           -2.0328e+00,  1.4402e+00]],\n","\n","         [[-4.0111e-01, -1.0863e+00,  1.0447e+00,  ...,  1.9323e-01,\n","            1.2796e+00,  1.4530e+00],\n","          [-2.1578e-01, -3.9491e-01, -2.8552e+00,  ..., -8.0738e-01,\n","           -4.5882e-02, -1.7378e-01],\n","          [-1.0904e+00, -3.4675e-01,  6.1984e-01,  ...,  2.0415e+00,\n","           -3.2616e-01,  1.8467e+00],\n","          ...,\n","          [ 2.5524e+00, -4.3495e-01,  8.8325e-01,  ..., -2.1485e+00,\n","           -1.5988e+00,  7.0480e-01],\n","          [-7.1371e-01,  5.1339e-01, -3.7189e-01,  ..., -1.4984e+00,\n","            1.1851e+00,  7.5906e-01],\n","          [ 3.1167e-02,  1.3620e+00, -1.2951e+00,  ..., -4.8730e-01,\n","           -1.2433e+00, -3.4361e-01]],\n","\n","         ...,\n","\n","         [[-7.8899e-01,  8.1591e-01, -4.9731e-02,  ..., -8.8404e-02,\n","            2.8078e-02,  5.1843e-01],\n","          [ 2.8740e+00, -1.3749e+00, -3.5546e-01,  ..., -1.8343e-01,\n","            6.7949e-01,  5.8465e-01],\n","          [ 8.1320e-01, -4.7932e-01,  7.2443e-01,  ..., -4.5722e-01,\n","            6.8186e-01,  7.8030e-01],\n","          ...,\n","          [-1.4863e+00, -7.5856e-01,  4.5884e-01,  ...,  2.2168e-01,\n","            1.2182e+00, -4.7387e-01],\n","          [-2.9013e-01, -4.8797e-01,  5.7869e-01,  ...,  7.0166e-01,\n","           -1.4464e+00, -7.1220e-01],\n","          [-1.6597e+00, -1.1027e+00, -2.4888e-01,  ...,  8.1929e-01,\n","            3.0337e-01,  8.2779e-01]],\n","\n","         [[ 1.0896e+00, -7.0967e-01, -3.9668e-01,  ...,  1.3501e+00,\n","            1.2289e+00, -5.9090e-01],\n","          [ 1.2485e+00,  9.9053e-02, -6.6489e-01,  ..., -4.2485e-01,\n","            1.8791e+00,  1.1386e-01],\n","          [-1.7062e+00, -8.2754e-02, -1.4308e+00,  ...,  1.7534e-01,\n","            7.0814e-01,  4.7824e-01],\n","          ...,\n","          [-9.3299e-01, -2.3977e-01,  3.0684e-02,  ...,  1.3573e+00,\n","           -4.7924e-01, -4.6561e-01],\n","          [ 2.0437e-01, -8.1404e-01,  6.8182e-01,  ..., -2.4531e-01,\n","           -7.5207e-01, -6.6556e-02],\n","          [-5.4490e-01,  7.9342e-01, -1.2181e-01,  ...,  1.7920e-01,\n","            1.7827e+00, -8.1777e-01]],\n","\n","         [[ 1.8911e-01,  1.2282e+00, -1.9445e-01,  ...,  2.0944e+00,\n","            1.4696e+00,  5.7961e-01],\n","          [-7.2068e-01, -3.0825e-01,  8.6248e-01,  ...,  1.0030e+00,\n","            9.7348e-01,  1.4618e+00],\n","          [-7.0731e-02,  5.8167e-01, -1.3013e-01,  ...,  1.3532e+00,\n","            2.5777e-01,  5.1866e-01],\n","          ...,\n","          [ 1.0289e-01, -9.8130e-02, -1.4235e+00,  ..., -1.6146e+00,\n","            1.1486e+00,  3.3538e-01],\n","          [ 3.5985e-01,  5.4937e-01,  4.6262e-01,  ..., -6.7815e-01,\n","            1.5077e+00,  3.7121e-01],\n","          [-2.9768e-01, -4.4189e-01,  1.0179e+00,  ..., -9.6164e-01,\n","            1.9713e-01, -7.0775e-01]]],\n","\n","\n","        [[[ 5.9024e-01,  5.2727e-01,  1.2864e-02,  ..., -6.5317e-01,\n","           -7.3239e-01,  9.7711e-01],\n","          [-3.1728e+00, -1.0274e+00, -3.6448e-01,  ..., -1.0135e+00,\n","            1.7835e-01, -5.6453e-01],\n","          [ 3.5991e-01,  1.0039e+00,  3.6327e-01,  ...,  8.1339e-01,\n","           -8.8159e-01, -1.5148e-01],\n","          ...,\n","          [ 8.5659e-01,  2.0467e-01, -7.8855e-01,  ...,  1.7841e+00,\n","            3.2763e-01,  4.2073e-01],\n","          [ 9.5488e-01, -8.5214e-01,  8.2230e-01,  ..., -9.3881e-01,\n","            2.1081e-01,  6.5526e-01],\n","          [ 2.1483e+00, -3.2806e-01,  1.1922e+00,  ...,  1.4889e+00,\n","           -7.9587e-01, -6.6513e-01]],\n","\n","         [[ 2.7400e-01, -8.2961e-01,  2.6199e+00,  ..., -4.7778e-01,\n","           -6.4649e-01,  1.3313e-01],\n","          [ 8.1284e-01,  7.7713e-01, -2.2483e-01,  ...,  9.3774e-01,\n","           -2.2483e-01, -2.5174e-01],\n","          [ 7.9287e-01,  9.7006e-01,  2.2071e+00,  ..., -1.3474e-01,\n","           -1.6434e-01,  3.6682e-01],\n","          ...,\n","          [ 5.6891e-01,  1.1631e-01, -6.6529e-01,  ...,  2.6804e-02,\n","           -2.0510e-01, -1.0495e-01],\n","          [ 1.1722e+00,  1.0716e+00,  9.0837e-01,  ..., -1.3016e+00,\n","            4.6571e-01,  8.5111e-01],\n","          [ 1.8260e+00, -3.5657e-01,  1.2907e+00,  ...,  3.0028e-01,\n","            1.4026e-01, -8.7616e-01]],\n","\n","         [[-9.9609e-01,  1.3562e+00,  1.0755e+00,  ..., -3.0313e-01,\n","           -1.3067e+00,  5.9445e-01],\n","          [-1.0725e+00, -5.0064e-01,  8.8384e-01,  ..., -1.5557e+00,\n","           -1.4207e+00,  1.3624e-01],\n","          [ 3.9364e-01, -3.5080e-01,  1.1201e+00,  ...,  1.3401e+00,\n","           -1.1153e+00,  1.2037e-01],\n","          ...,\n","          [ 1.3579e-01,  5.9640e-01,  7.1624e-01,  ..., -2.3028e+00,\n","            3.0304e-01,  1.4482e+00],\n","          [ 1.7057e+00,  1.4884e+00, -9.2222e-01,  ..., -2.4995e-01,\n","           -1.1641e-01,  6.7283e-01],\n","          [ 5.1306e-01,  7.0597e-01,  2.6290e-01,  ...,  2.9799e-01,\n","            4.1937e-01,  2.6210e+00]],\n","\n","         ...,\n","\n","         [[ 1.5459e+00,  4.9504e-01,  7.2056e-01,  ..., -5.6226e-01,\n","           -6.4073e-01, -1.1516e-01],\n","          [-1.2141e+00,  1.1529e-01,  1.4824e+00,  ...,  8.3243e-01,\n","           -4.4192e-01,  1.5542e+00],\n","          [-5.3792e-02,  6.3450e-01, -1.7487e-01,  ...,  3.7529e-01,\n","            6.5901e-01, -1.5742e-01],\n","          ...,\n","          [-2.7411e-02,  4.1394e-01, -2.1091e-01,  ..., -1.2828e-02,\n","            1.1516e+00,  1.1149e+00],\n","          [-3.1645e-01,  1.0334e+00,  4.6473e-01,  ...,  1.5918e+00,\n","            1.0163e+00,  1.2321e-01],\n","          [-7.4580e-02,  8.4585e-01, -2.1508e-01,  ...,  8.7992e-01,\n","           -1.7062e+00,  4.0216e-01]],\n","\n","         [[ 1.3984e+00,  8.3680e-01, -1.1755e+00,  ..., -7.9501e-03,\n","           -4.9507e-01, -6.3544e-01],\n","          [-2.1677e+00,  5.8727e-02, -1.1890e+00,  ..., -4.4570e-01,\n","            1.1517e+00,  4.5680e-01],\n","          [ 3.3115e-01, -6.4428e-01,  5.8282e-01,  ...,  1.6571e+00,\n","           -1.1763e-01,  1.2303e-01],\n","          ...,\n","          [-3.8012e-01, -9.1908e-01, -3.9931e-02,  ...,  4.9417e-01,\n","            1.7644e+00, -5.0973e-01],\n","          [-2.0441e+00,  2.4958e-01,  4.7483e-02,  ..., -1.5018e+00,\n","           -1.3770e+00,  5.0391e-01],\n","          [ 7.4885e-03,  1.2816e-01,  1.0481e+00,  ..., -2.0988e-01,\n","            3.0446e-01,  1.7741e+00]],\n","\n","         [[ 1.2760e+00,  1.0178e+00, -6.4389e-02,  ..., -9.1588e-01,\n","           -1.9601e-01, -9.9250e-01],\n","          [-1.0883e+00, -6.1747e-01,  1.0114e+00,  ..., -4.2343e-01,\n","            1.7020e+00, -1.1101e+00],\n","          [-6.6639e-01,  9.7823e-01, -1.4293e+00,  ...,  3.8894e-01,\n","           -3.1087e-01, -2.1378e+00],\n","          ...,\n","          [-7.1860e-01,  2.2364e+00,  1.5594e+00,  ..., -2.2669e-01,\n","            2.4888e-01,  2.4419e-02],\n","          [ 1.1918e+00, -1.4680e-01,  5.6171e-01,  ...,  3.6322e-01,\n","           -2.6320e+00,  1.6402e-01],\n","          [ 1.2849e+00, -4.8664e-02, -1.0986e+00,  ..., -6.2466e-01,\n","            2.1380e+00, -1.2496e+00]]],\n","\n","\n","        [[[-2.1965e+00, -5.3452e-01,  1.0380e+00,  ...,  9.2563e-01,\n","            1.2790e+00,  9.3395e-01],\n","          [ 1.7729e+00, -4.7192e-01,  1.1298e+00,  ..., -3.2293e-01,\n","            1.5650e-01,  3.9200e-01],\n","          [ 6.2307e-01,  5.8442e-01,  1.2663e+00,  ...,  1.0615e+00,\n","           -3.1517e-01, -1.4289e+00],\n","          ...,\n","          [ 8.7689e-01, -1.8588e+00, -2.7849e+00,  ..., -6.7447e-02,\n","            1.2725e+00, -6.4531e-01],\n","          [ 1.4907e-01,  5.2820e-01, -6.7885e-01,  ..., -3.0663e-01,\n","            1.2276e+00, -1.4335e-01],\n","          [-5.0488e-01, -4.0903e-01,  9.3614e-01,  ...,  1.0757e+00,\n","           -5.9650e-01,  6.0171e-01]],\n","\n","         [[ 1.2427e-01, -1.4781e+00,  3.1604e-01,  ...,  2.8039e-02,\n","           -4.1473e-01,  1.3655e+00],\n","          [-2.0822e+00,  2.6692e-01,  3.3424e-01,  ...,  4.1902e-01,\n","            1.3184e-01,  9.1084e-01],\n","          [ 2.4682e+00, -1.0115e-01, -1.4711e+00,  ...,  1.9407e-01,\n","           -1.5818e+00,  7.0345e-01],\n","          ...,\n","          [ 5.4015e-01,  3.8463e-01,  1.8619e-01,  ...,  4.7445e-01,\n","            8.0204e-01, -3.8738e-01],\n","          [ 3.4078e-02, -1.1955e+00, -5.7553e-01,  ..., -3.2833e-01,\n","           -5.6323e-01,  8.3951e-01],\n","          [-6.0303e-01, -4.8356e-01,  2.3448e-01,  ..., -3.1415e-01,\n","            1.3084e+00, -6.8937e-01]],\n","\n","         [[ 7.7673e-01, -7.3093e-02,  2.2865e-01,  ...,  1.4908e+00,\n","           -1.2991e-01,  1.4502e-01],\n","          [ 1.7208e+00, -1.1062e+00, -5.2923e-02,  ...,  1.6242e+00,\n","            2.6767e-01, -5.2711e-01],\n","          [ 3.2551e-01,  2.3552e-01, -1.3135e-01,  ..., -9.4754e-02,\n","            5.4639e-01, -1.1805e+00],\n","          ...,\n","          [-2.7658e+00, -8.4398e-01,  9.2118e-01,  ..., -2.4548e-01,\n","           -6.0094e-01, -7.9963e-01],\n","          [ 1.4060e-01, -4.2016e-01, -1.2171e-01,  ..., -2.6710e-01,\n","            9.2032e-01, -5.8489e-01],\n","          [ 3.0444e-01,  7.2501e-01, -5.4829e-02,  ...,  5.7674e-01,\n","           -1.0199e+00,  2.3589e-01]],\n","\n","         ...,\n","\n","         [[ 8.9031e-01,  2.6366e-01, -5.4772e-01,  ...,  3.8078e-01,\n","           -2.8692e-01,  2.4064e+00],\n","          [-3.1875e-01, -4.0286e-01,  2.5543e-01,  ...,  8.8992e-01,\n","            4.1553e-01, -1.1530e+00],\n","          [ 9.3116e-01,  2.0779e-01, -6.0163e-02,  ...,  3.5642e-01,\n","            3.1147e-01,  9.4136e-01],\n","          ...,\n","          [-1.2158e+00, -1.9854e+00, -6.1865e-01,  ...,  6.7460e-01,\n","           -6.3996e-01,  2.1258e-01],\n","          [ 1.3491e-01,  6.7197e-02,  7.8136e-02,  ..., -1.4007e+00,\n","            6.3768e-01, -2.9841e-01],\n","          [-1.4038e+00, -1.1264e+00,  1.0495e+00,  ...,  1.9205e+00,\n","           -9.3328e-01,  9.8094e-01]],\n","\n","         [[-1.2009e+00, -7.2470e-01, -1.6421e+00,  ...,  1.3873e-01,\n","           -1.0965e+00, -1.5051e+00],\n","          [ 1.9399e+00, -1.0083e+00, -9.0177e-01,  ...,  1.9438e+00,\n","            1.0913e+00,  1.1801e+00],\n","          [-2.3550e+00, -6.6056e-03, -8.4209e-02,  ...,  5.3461e-01,\n","            6.7285e-02, -2.3169e-01],\n","          ...,\n","          [ 6.7477e-01,  2.9665e-01,  5.0535e-02,  ..., -1.6384e-02,\n","           -7.3136e-01,  3.5593e-01],\n","          [ 1.0611e+00, -5.6642e-01, -1.2478e+00,  ..., -7.7573e-02,\n","           -9.7911e-02, -7.4872e-01],\n","          [-9.6327e-02,  2.5847e-01, -7.1698e-01,  ..., -1.8865e+00,\n","           -2.6548e+00,  6.8220e-01]],\n","\n","         [[-7.1122e-01, -1.2434e+00, -2.6640e-02,  ...,  5.0279e-01,\n","            2.2578e-01,  1.0251e+00],\n","          [ 2.3148e-01, -6.3495e-01, -1.1110e-01,  ...,  4.3725e-01,\n","           -8.6865e-01, -1.1665e+00],\n","          [ 3.0175e-01,  7.0369e-01, -3.0074e-01,  ...,  1.7030e+00,\n","            2.0656e-01,  1.0773e-01],\n","          ...,\n","          [-1.4575e+00,  2.6489e+00, -6.5395e-01,  ..., -8.9841e-01,\n","           -1.4764e+00, -5.2529e-01],\n","          [ 1.8039e+00, -4.2358e-01,  1.3543e+00,  ..., -6.5997e-01,\n","            1.1795e+00,  4.3917e-01],\n","          [-2.6635e-01, -7.4433e-01, -1.0429e+00,  ..., -1.4011e-01,\n","            2.2705e-01,  1.2842e+00]]]])\n","tensor([[[[-6.6325e-02,  1.6281e-01, -1.4715e-01,  ..., -2.0209e-01,\n","            4.7600e-01,  7.0954e-02],\n","          [ 4.5313e-01, -2.6172e-01,  2.5997e-01,  ..., -3.0866e-01,\n","           -6.6446e-01, -5.9590e-01],\n","          [ 4.5215e-01, -1.4150e-01, -4.5064e-01,  ..., -8.3236e-01,\n","           -7.6985e-01, -9.9799e-01],\n","          ...,\n","          [ 7.9554e-02, -1.4871e-01, -1.2816e+00,  ...,  3.9620e-01,\n","           -4.0491e-01,  4.0792e-01],\n","          [-6.5374e-01,  6.2907e-01,  4.9304e-01,  ...,  6.3960e-01,\n","           -7.7225e-01, -2.2045e-02],\n","          [ 3.7878e-02,  2.2707e-01, -3.4912e-01,  ...,  6.5231e-01,\n","            2.9938e-01,  3.7635e-01]],\n","\n","         [[-2.1280e-02, -1.8831e-01, -2.9259e-01,  ...,  2.7699e-02,\n","            2.3487e-01, -6.0537e-02],\n","          [ 9.6236e-02, -3.5342e-01, -4.2424e-01,  ...,  7.0280e-01,\n","           -8.6099e-02, -1.2212e-01],\n","          [ 3.4018e-01,  3.4775e-01, -5.5100e-01,  ...,  1.9593e-01,\n","           -6.6632e-03, -8.7274e-01],\n","          ...,\n","          [ 1.4551e-01, -2.8806e-01, -4.3924e-01,  ..., -3.3823e-01,\n","           -1.1837e-01, -1.8511e-01],\n","          [-5.7157e-01,  2.4347e-01,  3.4343e-01,  ..., -8.7641e-01,\n","           -1.1528e-01, -3.9968e-01],\n","          [-5.3277e-01,  1.0895e-01,  3.3648e-01,  ...,  4.3243e-02,\n","           -9.5372e-02,  1.9971e-01]],\n","\n","         [[-2.1411e-02,  3.1408e-01,  2.0998e-01,  ...,  1.9690e-01,\n","           -1.1986e-01, -3.2927e-01],\n","          [-5.2103e-01, -4.3372e-01,  2.3216e-01,  ...,  1.1581e-01,\n","            2.6340e-01,  6.6103e-02],\n","          [ 6.9645e-01,  1.8115e-01, -8.0000e-01,  ...,  1.9951e-01,\n","           -2.3409e-01, -6.8155e-01],\n","          ...,\n","          [-2.8263e-01, -5.3491e-01, -5.1911e-01,  ..., -5.1140e-01,\n","           -8.7801e-01, -3.2487e-01],\n","          [-1.1387e-02,  2.9253e-02, -2.8148e-02,  ...,  6.8522e-01,\n","           -4.0432e-03,  6.5965e-02],\n","          [ 1.4077e-01,  4.5095e-01, -5.7913e-01,  ...,  3.8596e-01,\n","           -1.2323e-01,  1.0610e-02]],\n","\n","         ...,\n","\n","         [[-1.3216e-01, -7.8039e-02, -4.3370e-01,  ...,  2.0189e-02,\n","           -1.4351e-01,  1.7473e-01],\n","          [ 8.7890e-02, -3.0915e-01,  1.8956e-01,  ...,  3.4214e-01,\n","            2.2913e-01,  5.9924e-01],\n","          [-2.0060e-01,  2.3708e-01,  6.2697e-01,  ..., -4.3722e-01,\n","           -3.0847e-01,  3.0636e-01],\n","          ...,\n","          [ 7.3195e-03, -3.1533e-02,  2.0063e-01,  ..., -7.9215e-01,\n","           -3.9498e-02,  7.9682e-01],\n","          [-7.3611e-02,  6.4693e-01,  1.1922e+00,  ...,  7.3711e-02,\n","            4.0105e-01,  1.7897e-01],\n","          [ 8.0479e-02,  9.6794e-02, -5.2270e-01,  ...,  4.8527e-03,\n","            2.1619e-01, -2.0525e-01]],\n","\n","         [[ 2.8204e-01,  3.2884e-01, -2.1399e-01,  ..., -3.8958e-03,\n","            7.9827e-03, -3.0678e-01],\n","          [ 2.5436e-01,  5.6898e-02, -1.9257e-01,  ...,  6.7166e-02,\n","            2.8167e-02,  1.6005e-01],\n","          [-1.4397e-02, -4.8885e-01, -1.7089e-01,  ..., -1.7840e-01,\n","           -1.7121e-01,  6.0478e-01],\n","          ...,\n","          [ 4.2812e-01,  4.9631e-01, -1.8048e-01,  ...,  5.5205e-01,\n","           -1.5599e-01, -6.4548e-02],\n","          [ 3.8832e-01, -2.9136e-01,  3.9917e-01,  ...,  2.5105e-01,\n","           -3.8808e-01,  1.1009e-01],\n","          [ 2.8242e-01,  6.1518e-02, -2.8410e-01,  ...,  5.7314e-02,\n","            8.5740e-02,  9.8635e-03]],\n","\n","         [[-2.2129e-01,  5.8949e-04,  6.0913e-01,  ...,  3.4938e-01,\n","           -2.2202e-01,  3.6504e-01],\n","          [ 8.2410e-02,  2.0978e-01,  1.5243e-01,  ...,  7.8056e-01,\n","            4.3809e-01,  1.9813e-01],\n","          [-4.4498e-01, -1.1159e+00,  3.8097e-01,  ...,  5.1433e-01,\n","           -1.1495e-01,  1.9629e-01],\n","          ...,\n","          [ 8.9491e-01, -6.2768e-01, -1.9835e-01,  ..., -2.2313e-01,\n","           -3.0104e-01,  4.7230e-01],\n","          [-7.2904e-02,  1.5222e-01,  3.7840e-03,  ...,  3.8165e-01,\n","           -4.7974e-02, -7.3148e-01],\n","          [ 1.4007e-01, -4.4881e-01,  3.7261e-01,  ..., -7.9678e-02,\n","           -4.7794e-01,  8.7805e-02]]],\n","\n","\n","        [[[-2.2767e-02, -9.3278e-02,  1.8774e-02,  ..., -2.5332e-01,\n","           -4.9507e-03,  7.6292e-01],\n","          [ 2.8932e-01,  1.8172e-01, -1.1192e+00,  ..., -1.3294e-01,\n","            3.9560e-01, -4.5171e-02],\n","          [-6.6226e-01, -4.9554e-01, -6.8857e-01,  ..., -5.5309e-01,\n","           -6.5628e-01, -3.3709e-01],\n","          ...,\n","          [-3.5314e-01, -2.0935e-01,  1.5037e-01,  ..., -4.9649e-01,\n","           -1.2963e+00,  2.4727e-02],\n","          [-3.3862e-01,  1.0050e+00,  9.2208e-01,  ...,  6.1084e-01,\n","           -5.3875e-01,  1.1724e-01],\n","          [ 4.2878e-01, -6.7676e-01, -8.3776e-01,  ...,  2.9084e-01,\n","           -1.2114e-01, -5.3296e-01]],\n","\n","         [[ 5.9548e-02, -3.4100e-01, -7.0058e-01,  ..., -4.5491e-02,\n","           -8.6731e-02, -7.2913e-02],\n","          [-1.9117e-01, -1.1956e+00, -5.8588e-01,  ..., -1.2393e-01,\n","           -4.0725e-01,  1.2629e-01],\n","          [ 4.5456e-01,  5.8665e-01,  5.6925e-01,  ...,  9.9359e-01,\n","           -2.0855e-01, -3.6609e-01],\n","          ...,\n","          [-5.1012e-01, -2.4186e-02,  3.7761e-02,  ...,  3.0510e-01,\n","            1.9917e-01,  3.6298e-01],\n","          [ 3.6428e-01, -5.9524e-01, -1.8725e-01,  ..., -1.1943e-01,\n","            3.5757e-01, -8.7339e-01],\n","          [ 1.2881e-02,  4.6328e-01, -9.5232e-02,  ...,  4.4248e-01,\n","           -3.0965e-01,  6.0353e-01]],\n","\n","         [[-2.6953e-01, -3.3085e-01,  1.8758e-01,  ..., -1.0168e-01,\n","           -4.9788e-01, -8.6315e-02],\n","          [ 1.0324e-01,  5.6297e-01,  1.8372e-01,  ..., -1.2150e-01,\n","           -5.6443e-01,  7.9988e-01],\n","          [ 5.7803e-01,  4.9701e-02, -3.1207e-01,  ..., -7.7564e-01,\n","           -2.3589e-01, -1.2223e+00],\n","          ...,\n","          [-3.4333e-01, -3.0087e-01, -2.6821e-01,  ...,  3.0858e-01,\n","           -6.9610e-01,  5.7314e-01],\n","          [-2.2127e-01, -1.8033e-01, -1.9329e-01,  ...,  3.8170e-03,\n","           -3.4045e-01,  1.7677e-01],\n","          [ 2.0359e-01,  3.6209e-01, -5.5105e-01,  ..., -6.0544e-01,\n","            1.4023e-01, -5.8621e-01]],\n","\n","         ...,\n","\n","         [[ 2.7672e-01,  1.8574e-02, -4.7481e-02,  ..., -2.6837e-01,\n","           -4.8966e-02, -2.1925e-01],\n","          [ 2.1038e-01, -4.4206e-01,  4.3290e-01,  ...,  7.6809e-02,\n","            1.7244e-01, -1.9299e-01],\n","          [ 1.0132e-01, -3.6804e-01, -5.7794e-01,  ...,  3.4077e-01,\n","            8.2463e-01, -3.4719e-01],\n","          ...,\n","          [-2.2245e-01, -1.4798e-02, -3.4618e-01,  ...,  4.9746e-01,\n","            1.2778e+00,  7.8888e-02],\n","          [ 4.2193e-01, -2.9688e-01,  7.3344e-01,  ...,  2.2815e-01,\n","           -2.5885e-01,  1.2652e-01],\n","          [ 1.6865e-01,  3.9315e-01,  9.0347e-01,  ..., -3.3089e-01,\n","            1.2627e-01, -4.6142e-02]],\n","\n","         [[ 8.2633e-02, -1.1631e-01,  4.2752e-01,  ..., -3.8734e-01,\n","           -2.8342e-01, -1.3402e-02],\n","          [ 4.4453e-01,  9.2707e-01,  1.9015e-01,  ..., -5.5331e-01,\n","            5.2230e-01,  3.8499e-01],\n","          [-4.0851e-01,  8.2653e-01, -5.5860e-01,  ..., -5.5887e-01,\n","            3.1390e-01, -9.5954e-01],\n","          ...,\n","          [-3.7349e-01,  9.2239e-01,  1.4739e-01,  ...,  4.5748e-01,\n","           -4.1487e-01, -3.2042e-01],\n","          [ 2.4435e-01,  8.0840e-02,  9.2601e-02,  ...,  2.7955e-01,\n","           -5.3292e-02,  1.5724e-01],\n","          [ 5.8884e-01,  5.7290e-01, -1.8444e-03,  ...,  6.8204e-01,\n","           -7.6674e-04,  1.4589e-01]],\n","\n","         [[ 2.2026e-01, -1.1414e-01,  1.8249e-01,  ...,  9.7795e-02,\n","           -6.6868e-02,  2.2390e-01],\n","          [ 3.1687e-02, -5.9799e-01,  1.4233e-01,  ...,  2.9298e-01,\n","           -7.9970e-02, -4.3529e-01],\n","          [-5.0770e-01,  1.2104e-01,  3.8929e-01,  ...,  8.3289e-01,\n","           -9.2373e-01, -2.7442e-01],\n","          ...,\n","          [-3.4841e-01,  1.3133e-01, -8.9489e-03,  ..., -1.8069e+00,\n","           -1.9178e-01,  4.4932e-01],\n","          [ 2.9314e-01, -3.6178e-02,  4.5633e-02,  ..., -9.5505e-01,\n","           -4.1995e-01, -4.0100e-01],\n","          [ 1.6080e-01, -2.2069e-01, -6.8443e-01,  ..., -1.0327e-02,\n","           -5.2586e-01, -1.4449e-02]]],\n","\n","\n","        [[[-2.1744e-01,  2.0904e-01, -3.1832e-01,  ..., -6.4562e-01,\n","            9.0607e-02,  4.9944e-01],\n","          [ 1.6416e-01, -9.9814e-02, -1.5332e-01,  ..., -3.0262e-01,\n","           -3.7089e-02,  7.1321e-01],\n","          [ 8.2036e-01,  5.0977e-01,  3.6675e-01,  ...,  1.5866e+00,\n","            1.2418e-01, -1.9202e-01],\n","          ...,\n","          [-4.6735e-01,  7.5120e-01,  4.8586e-01,  ..., -4.7488e-01,\n","           -7.7739e-01, -1.3989e-01],\n","          [ 2.9737e-01,  5.6576e-02, -2.5703e-01,  ...,  3.0684e-01,\n","            3.9835e-01, -2.6798e-01],\n","          [ 3.1608e-01,  6.4431e-01,  3.3032e-02,  ...,  2.2368e-01,\n","            3.2202e-01,  5.2159e-01]],\n","\n","         [[-5.4369e-02, -6.8412e-02, -5.2425e-01,  ...,  1.5520e-01,\n","           -4.6512e-02, -1.2624e-01],\n","          [ 3.8143e-01,  1.7173e-01,  2.0339e-01,  ..., -2.6758e-01,\n","            1.8241e-01, -3.2865e-02],\n","          [ 3.3315e-01,  7.1407e-02, -4.2701e-01,  ...,  8.4417e-01,\n","            3.6251e-01, -6.0898e-02],\n","          ...,\n","          [ 2.9343e-01, -3.4684e-01,  3.3972e-01,  ...,  5.3817e-01,\n","           -7.5985e-02,  2.7279e-01],\n","          [-3.3500e-01,  7.4897e-01, -1.3487e+00,  ..., -1.0362e-02,\n","           -6.7260e-02,  2.7608e-01],\n","          [-2.7673e-01,  3.9111e-02, -4.1213e-02,  ..., -3.0263e-01,\n","           -3.9651e-03, -4.5121e-01]],\n","\n","         [[-6.1842e-02, -2.4214e-01, -4.7101e-01,  ..., -5.0809e-01,\n","           -3.5338e-01, -1.0992e-02],\n","          [-5.0446e-02,  6.4571e-02, -8.8073e-01,  ...,  9.3661e-02,\n","           -9.2387e-01, -3.7856e-02],\n","          [ 1.5840e-02,  7.8604e-01, -1.5813e-01,  ..., -3.4608e-01,\n","            1.3442e-01,  9.5192e-02],\n","          ...,\n","          [ 3.1716e-01,  3.9268e-01,  6.6467e-02,  ..., -8.0671e-01,\n","           -2.7987e-01, -4.9222e-01],\n","          [-2.9213e-02,  3.8106e-01,  1.0686e-01,  ...,  1.4914e-01,\n","           -3.5370e-01, -2.2984e-01],\n","          [-5.8165e-01,  1.5085e-01,  4.9514e-01,  ..., -3.1065e-01,\n","           -6.1023e-01,  1.0648e-01]],\n","\n","         ...,\n","\n","         [[ 1.9220e-01, -6.8306e-03,  2.8931e-01,  ...,  7.3518e-01,\n","           -3.3258e-01,  1.4270e-01],\n","          [-8.2235e-02, -2.1404e-01,  3.8392e-01,  ..., -1.0517e+00,\n","           -1.8222e-01, -4.6087e-01],\n","          [ 2.4404e-01, -4.4580e-02,  7.4685e-01,  ...,  1.5695e-01,\n","            1.8996e-01, -1.3065e-02],\n","          ...,\n","          [-3.6903e-01, -1.4906e-01,  3.8085e-01,  ..., -4.8557e-01,\n","            3.6411e-01,  7.5077e-01],\n","          [ 1.0146e+00, -1.8855e-01,  2.8175e-02,  ...,  7.4581e-01,\n","           -1.6801e-01,  1.8713e-01],\n","          [ 5.6783e-01, -2.9256e-01,  2.5812e-01,  ...,  1.2949e+00,\n","           -2.3939e-01,  4.4300e-01]],\n","\n","         [[-1.8105e-01, -2.5954e-01, -1.4729e-01,  ..., -1.2345e-01,\n","           -2.7177e-01,  1.5869e-02],\n","          [ 1.9191e-02, -2.3896e-01,  9.2944e-02,  ..., -3.1742e-02,\n","            3.9783e-01, -1.5644e-01],\n","          [ 2.3676e-01, -4.4402e-01,  6.5399e-01,  ..., -8.9185e-01,\n","            2.9991e-01, -5.7116e-01],\n","          ...,\n","          [ 1.6969e-01,  4.4092e-01, -8.1485e-02,  ..., -2.8645e-01,\n","           -1.1173e+00,  3.8146e-01],\n","          [ 7.8057e-01, -2.7955e-01,  1.6486e-01,  ..., -1.1118e+00,\n","            1.9347e-01,  8.8384e-02],\n","          [-5.4965e-01,  7.3576e-02, -6.3588e-01,  ..., -1.4144e-02,\n","            3.1973e-01,  2.1930e-01]],\n","\n","         [[ 1.8837e-01, -2.3293e-01, -3.5028e-01,  ..., -9.3911e-02,\n","           -2.8094e-03,  6.3838e-01],\n","          [-7.1261e-01,  2.4390e-01,  1.0831e-01,  ..., -3.5543e-01,\n","            5.8319e-01,  2.4806e-01],\n","          [-5.2574e-01,  3.0763e-01,  3.0361e-02,  ..., -1.4333e-01,\n","            6.5959e-01,  8.1525e-01],\n","          ...,\n","          [-1.6947e-01, -6.7934e-01,  3.1289e-01,  ...,  9.8636e-01,\n","           -1.0282e-01,  6.5487e-01],\n","          [-9.8676e-04, -7.6270e-01,  2.3112e-01,  ..., -2.2379e-01,\n","            5.9652e-01, -1.0140e-01],\n","          [-1.9714e-01,  4.1934e-01,  6.4315e-01,  ..., -1.3767e-02,\n","           -3.2589e-01,  3.0699e-01]]],\n","\n","\n","        ...,\n","\n","\n","        [[[-1.9465e-01,  1.3228e-02,  2.2314e-01,  ..., -1.6942e-01,\n","           -2.1047e-01,  7.7355e-02],\n","          [-3.3254e-01, -4.0287e-01,  1.1380e+00,  ...,  3.9561e-01,\n","            6.4595e-01, -4.9889e-01],\n","          [-7.4149e-01,  3.4726e-02,  1.0462e+00,  ...,  1.9466e-01,\n","            2.1096e-02,  7.6039e-02],\n","          ...,\n","          [ 2.4353e-02, -6.4712e-01, -4.1696e-01,  ...,  1.8901e-01,\n","           -1.1347e+00, -1.2086e-01],\n","          [ 3.7811e-01,  2.0230e-01, -3.0578e-01,  ..., -2.7326e-01,\n","            5.6052e-01,  8.3410e-03],\n","          [-2.0114e-02, -6.4755e-01, -1.2528e+00,  ..., -6.7385e-02,\n","           -1.3297e-01, -8.1134e-02]],\n","\n","         [[ 1.0119e-01, -2.4816e-01, -3.8243e-02,  ..., -2.9581e-01,\n","           -3.5164e-01, -6.0236e-01],\n","          [-5.2444e-01,  4.3148e-02, -6.3180e-01,  ..., -3.0217e-01,\n","           -1.9871e-01, -1.5479e-01],\n","          [ 2.6054e-01, -4.7501e-01, -1.2362e+00,  ..., -1.1925e+00,\n","            2.1680e-01, -6.9665e-02],\n","          ...,\n","          [-4.7309e-01, -2.2796e-01, -2.9544e-01,  ...,  3.6690e-01,\n","           -5.1802e-01, -2.0303e-01],\n","          [-2.7386e-01, -9.1721e-01,  3.7774e-01,  ..., -2.6069e-01,\n","            3.4597e-01,  2.1466e-01],\n","          [-1.1706e-01, -3.1572e-01, -4.3988e-01,  ...,  1.1903e+00,\n","           -2.8713e-01, -7.9774e-02]],\n","\n","         [[ 1.5155e-01, -1.4701e-02,  6.9797e-01,  ..., -2.5242e-01,\n","            3.2717e-01, -1.5911e-01],\n","          [-2.6596e-03, -1.2232e+00, -6.9258e-02,  ..., -4.2438e-01,\n","           -2.4579e-01,  6.7298e-02],\n","          [ 5.9043e-01, -6.8478e-01, -2.8956e-01,  ...,  2.5695e-01,\n","           -8.6949e-01,  8.1729e-01],\n","          ...,\n","          [ 1.9682e-01, -5.6141e-01,  7.4615e-01,  ..., -3.0629e-01,\n","           -1.8652e-01, -5.2067e-01],\n","          [ 2.6320e-01, -2.7947e-01,  3.3229e-01,  ...,  1.0745e-01,\n","           -1.1247e-01, -3.9965e-01],\n","          [ 6.1172e-02, -4.5917e-01, -3.8726e-01,  ...,  8.5278e-01,\n","            8.2772e-02, -2.5512e-01]],\n","\n","         ...,\n","\n","         [[ 1.0377e-01, -3.0392e-01, -6.3512e-01,  ..., -2.5385e-01,\n","           -8.2658e-02,  2.5954e-01],\n","          [-1.0232e-01,  4.4061e-01, -1.1772e+00,  ..., -4.6444e-01,\n","           -6.3670e-01, -2.9564e-01],\n","          [-3.3010e-01, -2.2031e-01, -3.3643e-01,  ...,  7.7306e-01,\n","            5.2377e-01,  5.4572e-01],\n","          ...,\n","          [-3.9621e-01,  8.0109e-02, -1.2169e-01,  ..., -1.5833e-01,\n","            9.8970e-01,  1.1102e-01],\n","          [-6.0984e-01,  7.5880e-01, -4.9438e-01,  ..., -4.5102e-01,\n","            5.5786e-01,  8.0753e-02],\n","          [-6.4300e-02, -7.5976e-02,  3.4817e-01,  ...,  1.4351e-02,\n","            1.8155e-02, -7.5719e-01]],\n","\n","         [[-1.8507e-02,  4.5697e-01, -2.0605e-01,  ...,  8.3105e-02,\n","            4.3276e-01, -1.9419e-01],\n","          [ 7.2861e-02, -2.4095e-01,  6.3962e-01,  ..., -2.7189e-01,\n","            1.0294e+00,  2.7331e-01],\n","          [ 3.4026e-01,  1.3873e-01, -2.1174e-01,  ..., -1.5243e-01,\n","           -3.2838e-01,  4.7761e-01],\n","          ...,\n","          [-8.6599e-02, -2.2156e-01,  6.8468e-02,  ...,  9.2696e-01,\n","           -2.1758e-01, -5.1320e-02],\n","          [ 3.7356e-01, -2.1772e-01, -1.6957e-01,  ...,  6.0179e-01,\n","            3.7056e-01, -1.6559e-01],\n","          [ 2.6707e-01, -1.2185e-01, -7.6795e-02,  ...,  4.5037e-01,\n","            3.8813e-01,  7.4205e-01]],\n","\n","         [[-3.7647e-01,  1.5604e-01, -1.6898e-01,  ...,  6.2402e-02,\n","           -1.6464e-01,  3.3452e-01],\n","          [-1.4576e-01, -2.9848e-01, -5.8780e-01,  ...,  7.3004e-01,\n","           -2.4038e-01, -1.5571e-01],\n","          [ 1.9124e-01,  2.3183e-01, -3.0493e-02,  ...,  1.2492e+00,\n","           -2.4512e-01, -4.8728e-01],\n","          ...,\n","          [ 2.1840e-01, -4.2821e-01, -7.5815e-01,  ..., -7.4634e-02,\n","            7.0960e-01, -6.2599e-01],\n","          [ 3.8020e-01,  1.6301e-01, -1.1050e+00,  ...,  5.1163e-01,\n","            4.2489e-01,  1.9712e-01],\n","          [-5.1643e-01, -8.4316e-02, -2.3019e-01,  ..., -1.6005e-01,\n","            6.2300e-01, -6.4310e-02]]],\n","\n","\n","        [[[-2.3073e-01, -3.2757e-01, -1.7615e-01,  ..., -3.1755e-01,\n","            6.2551e-01,  1.5500e-01],\n","          [ 7.2971e-02,  6.6832e-01, -8.5979e-02,  ...,  4.2432e-01,\n","            1.0248e+00,  1.5949e-01],\n","          [ 7.7269e-01,  5.1951e-01,  1.7618e+00,  ..., -9.2050e-01,\n","            5.4869e-01, -3.6737e-02],\n","          ...,\n","          [-6.7799e-01,  1.3077e-01,  9.8971e-01,  ..., -1.4531e-01,\n","           -4.1202e-01, -1.2884e+00],\n","          [-3.5910e-01,  2.4374e-01,  5.3327e-01,  ..., -4.6112e-01,\n","           -9.5103e-01, -1.5547e-01],\n","          [-4.1298e-01, -6.4163e-01,  1.3108e-02,  ...,  6.3228e-01,\n","           -4.1012e-02, -7.4006e-02]],\n","\n","         [[ 2.2323e-01, -2.0456e-01, -2.1306e-01,  ...,  1.3014e-01,\n","           -6.1050e-03,  2.8525e-01],\n","          [-1.4702e-01, -7.3911e-01,  7.7279e-01,  ..., -5.1458e-01,\n","           -9.4747e-02, -1.2833e-02],\n","          [ 8.4272e-02, -4.6796e-01, -6.2244e-01,  ...,  1.2844e-01,\n","            4.3204e-01, -1.5598e-01],\n","          ...,\n","          [-3.8009e-01,  9.2036e-02, -9.4405e-01,  ..., -2.1474e-01,\n","            7.6238e-01,  4.4951e-02],\n","          [ 1.6954e-01, -7.0339e-01, -3.1057e-01,  ...,  3.0363e-01,\n","           -2.4146e-01,  3.2221e-01],\n","          [-1.8311e-01, -6.9779e-02, -1.0354e+00,  ...,  1.9415e-01,\n","           -6.0998e-01,  2.1445e-01]],\n","\n","         [[-5.6090e-02, -1.8210e-01,  4.7461e-01,  ...,  1.5488e-01,\n","           -2.8046e-01, -4.9479e-02],\n","          [ 4.9762e-01,  5.0312e-01,  2.7558e-01,  ...,  1.7904e-01,\n","           -1.3970e-01, -1.4724e-01],\n","          [ 3.7810e-01,  4.6999e-01,  1.0016e+00,  ...,  5.8737e-01,\n","           -2.1048e-01, -1.8328e-01],\n","          ...,\n","          [-3.4429e-01,  3.9203e-02, -6.1454e-01,  ...,  1.5329e-01,\n","           -6.3522e-01,  3.4047e-01],\n","          [-5.0717e-02,  2.5742e-01,  4.6427e-01,  ..., -2.7274e-01,\n","           -4.0047e-01, -2.1882e-01],\n","          [-7.2899e-02, -3.8369e-01,  2.3243e-01,  ..., -2.6814e-01,\n","            1.9477e-01, -2.2880e-01]],\n","\n","         ...,\n","\n","         [[ 2.5490e-01,  4.2273e-02,  2.0644e-01,  ..., -3.6526e-02,\n","           -1.5438e-01,  2.4597e-02],\n","          [-3.0910e-01, -5.3320e-03,  5.8049e-01,  ..., -1.7109e-02,\n","           -8.0732e-02,  6.1760e-01],\n","          [-7.3421e-01, -7.0060e-02,  3.0991e-01,  ..., -1.4894e-01,\n","           -1.3971e+00, -3.9835e-01],\n","          ...,\n","          [-1.6380e-01,  1.5381e-01,  1.4747e-01,  ..., -1.0853e+00,\n","           -2.9100e-01, -5.6958e-01],\n","          [ 3.6460e-01,  2.8173e-01,  3.3950e-01,  ..., -2.3007e-01,\n","            4.8298e-01,  5.8486e-01],\n","          [ 9.2667e-01, -8.2717e-01,  7.3343e-01,  ..., -2.1704e-01,\n","            4.1665e-01, -3.5606e-02]],\n","\n","         [[ 1.2966e-01,  1.3633e-01,  4.9483e-01,  ...,  2.5050e-01,\n","           -3.9029e-01,  1.6704e-01],\n","          [ 5.4505e-02,  8.3919e-01,  7.9595e-01,  ...,  6.2972e-01,\n","            1.0685e-01,  3.8023e-01],\n","          [ 5.1360e-01,  5.2265e-01, -5.2238e-02,  ...,  3.5361e-02,\n","           -5.1232e-01,  1.0005e-01],\n","          ...,\n","          [ 1.4328e-01, -1.4457e-01, -4.9256e-02,  ..., -1.0815e+00,\n","            8.7790e-01,  6.6360e-01],\n","          [-2.5777e-01,  1.0968e-01, -7.9925e-01,  ...,  7.4478e-01,\n","            2.9821e-01,  2.1834e-01],\n","          [ 5.1603e-02,  1.6719e-01, -2.7770e-01,  ...,  3.5238e-01,\n","           -4.3275e-03, -1.6873e-01]],\n","\n","         [[ 2.4834e-01,  1.2968e-01, -1.4392e-01,  ...,  2.0080e-01,\n","            1.1189e-01,  5.0565e-02],\n","          [ 4.7714e-01, -6.0377e-01, -6.5708e-01,  ..., -5.7428e-02,\n","           -3.2265e-02, -2.5472e-01],\n","          [-2.6611e-01,  5.8366e-01, -1.0067e+00,  ..., -2.9573e-01,\n","           -7.4575e-01, -1.2634e-01],\n","          ...,\n","          [-2.5496e-01, -1.2916e-01,  4.3872e-01,  ..., -6.7058e-01,\n","           -1.3389e-01,  3.7583e-01],\n","          [-2.9898e-01,  6.6076e-02, -5.9243e-01,  ...,  5.2996e-01,\n","            1.4571e-01,  3.2385e-01],\n","          [ 2.5043e-01, -1.0565e-01,  3.1614e-01,  ..., -5.2341e-01,\n","           -2.4199e-01, -5.7498e-01]]],\n","\n","\n","        [[[ 2.4691e-01,  4.3873e-01, -1.1679e-01,  ..., -3.4983e-01,\n","           -1.1902e-01,  2.4981e-01],\n","          [-2.1716e-01,  3.3080e-01, -2.3276e-01,  ...,  2.5434e-02,\n","            2.6408e-02, -7.6659e-01],\n","          [ 3.6423e-01, -1.8670e-01,  1.4121e-02,  ..., -2.0165e-01,\n","            6.3259e-02, -3.6953e-01],\n","          ...,\n","          [-7.4434e-01, -2.3962e-01,  5.4815e-01,  ...,  9.6747e-02,\n","           -6.7033e-02,  4.2028e-01],\n","          [-4.1246e-01, -4.5158e-01, -5.1704e-01,  ...,  3.6835e-01,\n","            5.6253e-01, -2.5537e-01],\n","          [ 5.4678e-01, -6.6443e-01,  2.2303e-01,  ..., -2.8246e-03,\n","           -3.3288e-02,  1.0972e-01]],\n","\n","         [[-6.8904e-02, -1.6362e-01,  3.3625e-01,  ..., -2.8346e-01,\n","           -3.8926e-01,  8.4502e-02],\n","          [ 2.7255e-01, -1.0350e-01, -7.5219e-01,  ..., -7.6195e-01,\n","            3.5255e-01, -3.5023e-01],\n","          [-8.5248e-01,  7.0242e-01,  2.0184e-01,  ..., -1.4292e+00,\n","            4.6066e-01,  2.2038e-01],\n","          ...,\n","          [-5.8968e-01,  8.9994e-01, -2.7862e-01,  ..., -4.5356e-01,\n","           -1.9011e+00,  6.1130e-02],\n","          [-3.8934e-01, -1.0631e+00,  2.3611e-01,  ..., -6.7196e-01,\n","            2.2389e-01, -2.9802e-01],\n","          [ 1.2952e-01, -1.2879e-01, -2.9365e-01,  ..., -1.3472e-02,\n","            4.7555e-02,  4.1037e-02]],\n","\n","         [[ 2.0870e-01, -2.5957e-01,  2.2529e-01,  ..., -5.5918e-01,\n","           -3.1709e-01, -8.8303e-02],\n","          [-3.6141e-01, -1.0164e-01,  4.5461e-02,  ..., -2.2144e-01,\n","           -1.8617e-01,  1.7834e-01],\n","          [ 6.1656e-01, -6.2876e-01, -9.6301e-01,  ...,  3.5093e-01,\n","           -2.8148e-01,  2.0778e-01],\n","          ...,\n","          [ 2.7350e-01, -3.4144e-01, -1.0665e-01,  ...,  6.9316e-01,\n","            2.1516e-01, -2.2979e-01],\n","          [-7.8187e-01,  3.9744e-01, -1.3398e-01,  ...,  3.8264e-02,\n","           -1.2199e-02, -2.4300e-01],\n","          [ 2.6903e-01, -8.7223e-01, -4.1960e-01,  ..., -5.7203e-01,\n","            4.2224e-01,  1.3256e-01]],\n","\n","         ...,\n","\n","         [[ 3.6759e-01, -2.2650e-01,  2.8825e-01,  ..., -7.6705e-02,\n","           -1.9306e-02,  1.3231e-01],\n","          [ 8.4164e-02, -1.3729e-01, -4.0450e-01,  ..., -4.3127e-01,\n","            5.2777e-01, -1.9623e-01],\n","          [ 2.3471e-02, -1.6696e-01,  6.5482e-01,  ...,  6.0703e-01,\n","            2.5480e-01,  1.3277e-01],\n","          ...,\n","          [ 9.3726e-02,  6.5573e-01,  1.1306e+00,  ..., -2.6426e-02,\n","           -2.6624e-01, -6.3793e-01],\n","          [ 1.5521e-01, -1.2409e-01,  6.5043e-01,  ...,  1.7686e-02,\n","            6.4731e-01,  3.4471e-02],\n","          [ 5.9821e-01,  3.8054e-01, -2.8847e-02,  ..., -6.5278e-01,\n","            1.2201e-01, -1.5148e-01]],\n","\n","         [[ 2.2644e-01,  3.3314e-01,  4.8295e-01,  ...,  3.4380e-01,\n","           -3.3379e-02, -5.0359e-02],\n","          [ 5.9796e-01, -1.1819e-01,  5.2808e-01,  ...,  5.6657e-01,\n","           -2.3964e-01, -6.0985e-01],\n","          [-2.0020e-01,  1.3458e-01, -7.0919e-01,  ...,  7.4930e-02,\n","            4.7307e-01,  4.1322e-01],\n","          ...,\n","          [-2.1221e-01,  3.7074e-01,  1.8625e-01,  ...,  3.4282e-01,\n","            8.2978e-02,  1.6698e-01],\n","          [ 5.5059e-01,  1.4181e-01,  3.0815e-02,  ..., -3.3492e-01,\n","           -1.0693e-02, -1.5970e-01],\n","          [-1.4165e-02, -4.0396e-01,  2.5859e-01,  ..., -6.0082e-01,\n","            1.2870e-01, -4.2432e-01]],\n","\n","         [[-8.9005e-02, -2.9202e-01, -1.7202e-01,  ..., -2.1783e-01,\n","            1.6121e-02, -7.5128e-02],\n","          [-2.4003e-01,  5.9778e-01,  1.8581e-01,  ...,  7.0042e-01,\n","            2.5687e-01, -4.6126e-02],\n","          [ 6.0700e-01,  1.8089e-01,  7.1605e-01,  ...,  1.0929e+00,\n","            3.7853e-02, -1.7004e-01],\n","          ...,\n","          [-6.0890e-01, -1.1894e+00, -1.0360e-01,  ..., -2.4122e-01,\n","            1.1555e-01, -1.0874e-01],\n","          [ 8.7037e-04, -4.1424e-01, -8.4135e-02,  ..., -2.2432e-01,\n","           -2.7352e-01,  3.1303e-02],\n","          [ 1.3692e-02,  2.2381e-01,  5.6031e-01,  ..., -3.6336e-01,\n","           -2.4757e-01, -5.8237e-01]]]], grad_fn=<SlowConvDilated2DBackward>)\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"RLqGbclbp3_N","executionInfo":{"status":"ok","timestamp":1603628161636,"user_tz":-540,"elapsed":3607,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"6edd1e49-3e62-49e4-8a25-df3b56191d7d","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["output.shape"],"execution_count":73,"outputs":[{"output_type":"execute_result","data":{"text/plain":["torch.Size([20, 33, 26, 100])"]},"metadata":{"tags":[]},"execution_count":73}]},{"cell_type":"markdown","metadata":{"id":"CYeGAJEuneqW"},"source":["### nn.functional 패키지\n","\n","- 가중치를 직접 선언하여 인자로 넣어줘야함\n","\n","- 예시)\n","  - Convolution functions\n","\n","  - Pooling functions\n","  \n","  - Non-linear activation functions\n","\n","  - Normalization functions\n","\n","  - Linear functions\n","\n","  - Dropout functions\n","  \n","  - Sparse functions\n","  \n","  - Distance functions\n","\n","  - Loss functions\n","  - ..\n","\n","- https://pytorch.org/docs/stable/nn.functional.html"]},{"cell_type":"code","metadata":{"id":"NpwbO9Dhpflm","executionInfo":{"status":"ok","timestamp":1603628300772,"user_tz":-540,"elapsed":1642,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}}},"source":["import torch\n","import torch.nn.functional as F"],"execution_count":76,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"fUYaJ5aLqKed"},"source":["- Convolution Layer 예시 (2)"]},{"cell_type":"code","metadata":{"id":"GAWLQE2GouHP","executionInfo":{"status":"ok","timestamp":1603628380980,"user_tz":-540,"elapsed":1985,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}}},"source":["filters = torch.randn(8,4,3,3)"],"execution_count":78,"outputs":[]},{"cell_type":"code","metadata":{"id":"lWmSlFBrpms1","executionInfo":{"status":"ok","timestamp":1603628408207,"user_tz":-540,"elapsed":1535,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"6871a430-1832-4067-a697-a01ef9b9cf6b","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["inputs = torch.randn(1,4,5,5)\n","conv = F.conv2d(inputs, filters, padding = 1)\n","conv.shape"],"execution_count":80,"outputs":[{"output_type":"execute_result","data":{"text/plain":["torch.Size([1, 8, 5, 5])"]},"metadata":{"tags":[]},"execution_count":80}]},{"cell_type":"markdown","metadata":{"id":"Wah4RsmgrRDP"},"source":["## Torchvision\n","\n","- `transforms`: 전처리할 때 사용하는 메소드\n","\n","- `transforms`에서 제공하는 클래스 이외에  \n","  일반적으로 클래스를 따로 만들어 전처리 단계를 진행\n","  \n","  - 아래의 코드에서 다양한 전처리 기술 확인  \n","    https://pytorch.org/docs/stable/torchvision/transforms.html\n"]},{"cell_type":"code","metadata":{"id":"akvq4QWmqSil","executionInfo":{"status":"ok","timestamp":1603628635616,"user_tz":-540,"elapsed":3704,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}}},"source":["import torch\n","import torchvision\n","import torchvision.transforms as transforms"],"execution_count":81,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"PKu5mzyTs-Qj"},"source":["- 예시)\n","  - `DataLoader`의 인자로 들어갈 `transform`을 미리 정의할 수 있음\n","\n","  - `Compose`를 통해 리스트 안에 순서대로 전처리 진행\n","\n","  - 대표적인 예로, `ToTensor`()를 하는 이유는  \n","   <u>torchvision이 PIL Image형태로만 입력을 받기 때문에</u> 데이터 처리를 위해서 Tensor형으로 변환해야함"]},{"cell_type":"code","metadata":{"id":"y6K7FH-Rs9my","executionInfo":{"status":"ok","timestamp":1603628723786,"user_tz":-540,"elapsed":2543,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}}},"source":["transform = transforms.Compose([transforms.ToTensor(), \n","                                transforms.Normalize(mean = (0.5,), std = (0.5,))])\n"],"execution_count":82,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"I4l1GvIlslKa"},"source":["## utils.data\n","\n","- `Dataset`에는 다양한 데이터셋이 존재  \n","  - MNIST, CIFAR10, ...\n","\n","- `DataLoader`, `Dataset`을 통해  \n","  `batch_size`, `train`여부, `transform`등을 인자로 넣어 데이터를 어떻게 load할 것인지 정해줄 수 있음"]},{"cell_type":"code","metadata":{"id":"1wsZKY7-s2Vv","executionInfo":{"status":"ok","timestamp":1603628784938,"user_tz":-540,"elapsed":1816,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}}},"source":["import torch\n","from torch.utils.data import Dataset, DataLoader\n","\n","import torchvision\n","import torchvision.transforms as transforms"],"execution_count":83,"outputs":[]},{"cell_type":"code","metadata":{"id":"lldpI2lquBu3","executionInfo":{"status":"ok","timestamp":1603628878190,"user_tz":-540,"elapsed":4183,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"6722e375-74d0-4ff3-912d-15b2a2d1182d","colab":{"base_uri":"https://localhost:8080/","height":394,"referenced_widgets":["a6f66cd5405e42fa9005a88e41e738d0","a69d6baa3f3244cc96bd04d931ba2eea","3241dcfc3bfd48ffa63fd9f395edd790","187a0cd1a6484361b57dc763a8986e2d","bf43ac47b7d44a56976f84c8e15687e2","ade898ab500c468681b2ad2721908e35","f933c86b8c374aad9129b75349b186f5","be82a8839f6345d4ba7c5f1a0b69245b","3bd6d4c626b540869f4bd5a0e75c67f5","daca2eec4b9e43a28244afa2e71d76fb","c0464d55f7a847489e71b778b80b14d4","da57e964d26a478289ba79872d345ed2","700de9c63db8445dab885ea7af777705","8f5938e765954bce9ea2e5298f67c963","05f5954899d1478fbf4fdc4565de1793","25473cf7cbad4aba869c51c331d11a84","8cb9ea45547b46f8bb82cc08b46dd16e","74c5ce4f2bfb40d18a202e17e77de984","17c81a76a92f4f64b951edb3d0079dd7","46c4d96e5cb6487ca417565f70a1fcb8","b1788c7b65da4aeba5c0c7aee65c47c1","ff0566a569aa495ba80d1c59ab154059","4463b881c9a148de8e3d9f44e60ffdf8","84853fb3baf84a8badaed0a441fb1915","2be5624bb11344cdac5f67bc14d87e05","05d8938756f1419da7acc59676c6238d","1cec9b77118c4737b3f0d0a7cd7588fb","7003721d58834bff8c8e0456a871db23","49c406ab3dda469eaafd00373e566498","3b442b976d4742e58741069bbd24157e","9edaf6fc12df4470acb7559656025342","4d299446e69d406a93e346baa955098a"]}},"source":["trainset = torchvision.datasets.MNIST(root = '/content/',\n","                                      train = True,\n","                                      download = True,\n","                                      transform = transform)\n","\n","testset = torchvision.datasets.MNIST(root = '/content/',\n","                                      train = False,\n","                                      download = True,\n","                                      transform = transform)\n"],"execution_count":84,"outputs":[{"output_type":"stream","text":["Downloading http://yann.lecun.com/exdb/mnist/train-images-idx3-ubyte.gz to /content/MNIST/raw/train-images-idx3-ubyte.gz\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"a6f66cd5405e42fa9005a88e41e738d0","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=1.0, bar_style='info', max=1.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["Extracting /content/MNIST/raw/train-images-idx3-ubyte.gz to /content/MNIST/raw\n","Downloading http://yann.lecun.com/exdb/mnist/train-labels-idx1-ubyte.gz to /content/MNIST/raw/train-labels-idx1-ubyte.gz\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"3bd6d4c626b540869f4bd5a0e75c67f5","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=1.0, bar_style='info', max=1.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["Extracting /content/MNIST/raw/train-labels-idx1-ubyte.gz to /content/MNIST/raw\n","Downloading http://yann.lecun.com/exdb/mnist/t10k-images-idx3-ubyte.gz to /content/MNIST/raw/t10k-images-idx3-ubyte.gz\n","\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"8cb9ea45547b46f8bb82cc08b46dd16e","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=1.0, bar_style='info', max=1.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["Extracting /content/MNIST/raw/t10k-images-idx3-ubyte.gz to /content/MNIST/raw\n","Downloading http://yann.lecun.com/exdb/mnist/t10k-labels-idx1-ubyte.gz to /content/MNIST/raw/t10k-labels-idx1-ubyte.gz\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"2be5624bb11344cdac5f67bc14d87e05","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=1.0, bar_style='info', max=1.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["Extracting /content/MNIST/raw/t10k-labels-idx1-ubyte.gz to /content/MNIST/raw\n","Processing...\n","Done!\n"],"name":"stdout"},{"output_type":"stream","text":["/usr/local/lib/python3.6/dist-packages/torchvision/datasets/mnist.py:469: UserWarning: The given NumPy array is not writeable, and PyTorch does not support non-writeable tensors. This means you can write to the underlying (supposedly non-writeable) NumPy array using the tensor. You may want to copy the array to protect its data or make it writeable before converting it to a tensor. This type of warning will be suppressed for the rest of this program. (Triggered internally at  /pytorch/torch/csrc/utils/tensor_numpy.cpp:141.)\n","  return torch.from_numpy(parsed.astype(m[2], copy=False)).view(*s)\n"],"name":"stderr"}]},{"cell_type":"code","metadata":{"id":"fKddZnT1uQmT","executionInfo":{"status":"ok","timestamp":1603628964748,"user_tz":-540,"elapsed":1304,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}}},"source":["train_loader = DataLoader(trainset,batch_size = 8, shuffle = True, num_workers=2)\n","test_load = DataLoader(testset, batch_size = 8, shuffle = False, num_workers = 2)\n","\n","# 불러올때마다 batchsize 8만큼 반복해서 가져옴"],"execution_count":86,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"zrxymquLxeo8"},"source":["- `batch_size`만큼 데이터를 하나씩 가져옴"]},{"cell_type":"code","metadata":{"id":"hvgMIyF6uUuU","executionInfo":{"status":"ok","timestamp":1603629020843,"user_tz":-540,"elapsed":1848,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"e3c6eb06-d6c4-4116-ac8b-20bf781109fe","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["dataiter = iter(train_loader)\n","images, labels = dataiter.next()\n","images.shape, labels.shape"],"execution_count":87,"outputs":[{"output_type":"execute_result","data":{"text/plain":["(torch.Size([8, 1, 28, 28]), torch.Size([8]))"]},"metadata":{"tags":[]},"execution_count":87}]},{"cell_type":"markdown","metadata":{"id":"YPUC0a0aw6OM"},"source":["<u>**(중요) torch에서는 channel(채널)이 앞에 옴**</u>\n","\n","- `channel first`\n","\n","- tensorflow, keras 등에서는 channel이 뒤에 옴(`channel last`)"]},{"cell_type":"markdown","metadata":{"id":"wuhylD3iyFYr"},"source":["### 데이터 확인"]},{"cell_type":"code","metadata":{"id":"C9hAQmQlul8P","executionInfo":{"status":"ok","timestamp":1603629069316,"user_tz":-540,"elapsed":1854,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}}},"source":["import matplotlib.pyplot as plt\n","plt.style.use('seaborn-white')"],"execution_count":88,"outputs":[]},{"cell_type":"code","metadata":{"id":"zDcUY6o4xUQp","executionInfo":{"status":"ok","timestamp":1603629083772,"user_tz":-540,"elapsed":1862,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"2eacc0c2-9585-4176-ea9b-93e884c85162","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["torch_image = torch.squeeze(images[0])\n","torch_image.shape   # 차원 하나 없애는거지"],"execution_count":89,"outputs":[{"output_type":"execute_result","data":{"text/plain":["torch.Size([28, 28])"]},"metadata":{"tags":[]},"execution_count":89}]},{"cell_type":"code","metadata":{"id":"MZmPWiGbxoiW","executionInfo":{"status":"ok","timestamp":1603629105909,"user_tz":-540,"elapsed":967,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"df750e43-8898-413a-b921-55a82a0155e7","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["image = torch_image.numpy()\n","image.shape     #numpy로 바꿔주고"],"execution_count":90,"outputs":[{"output_type":"execute_result","data":{"text/plain":["(28, 28)"]},"metadata":{"tags":[]},"execution_count":90}]},{"cell_type":"code","metadata":{"id":"AUOdd4UaxaXO","executionInfo":{"status":"ok","timestamp":1603629127034,"user_tz":-540,"elapsed":3137,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"d12ed38f-f177-439a-cc42-5469c409a22d","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["label = labels[0].numpy()\n","label.shape"],"execution_count":91,"outputs":[{"output_type":"execute_result","data":{"text/plain":["()"]},"metadata":{"tags":[]},"execution_count":91}]},{"cell_type":"code","metadata":{"id":"PDQfjw4wxr1z","executionInfo":{"status":"ok","timestamp":1603629131209,"user_tz":-540,"elapsed":1532,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"91f74685-b40a-484b-c631-156130a7d1e0","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["label   # 숫자 8이겠지"],"execution_count":92,"outputs":[{"output_type":"execute_result","data":{"text/plain":["array(8)"]},"metadata":{"tags":[]},"execution_count":92}]},{"cell_type":"code","metadata":{"id":"JDCVw59ax3-A","executionInfo":{"status":"ok","timestamp":1603629157779,"user_tz":-540,"elapsed":2328,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"68e13f57-9f83-48c6-95e1-f49ec815549d","colab":{"base_uri":"https://localhost:8080/","height":277}},"source":["plt.title(label)\n","plt.imshow(image, 'gray')\n","plt.show()"],"execution_count":93,"outputs":[{"output_type":"display_data","data":{"image/png":"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\n","text/plain":["<Figure size 432x288 with 1 Axes>"]},"metadata":{"tags":[]}}]},{"cell_type":"markdown","metadata":{"id":"JVcWQlxzihtS"},"source":["## 각 Layer 설명"]},{"cell_type":"code","metadata":{"id":"IGXn1_weif5H","executionInfo":{"status":"ok","timestamp":1603629217015,"user_tz":-540,"elapsed":1966,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}}},"source":["import torch\n","import torch.nn as nn\n","import torch.nn.functional as F\n","import torch.optim as optim"],"execution_count":94,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"73kJ3heBi26y"},"source":["### nn.Conv2d\n","\n","- `in_channels`: channel의 갯수\n","\n","- `out_channels`: 출력 채널의 갯수\n","\n","- `kernel_size`: 커널(필터) 사이즈\n","\n","- 텐서플로우, 케라스와 다르게 레이어의 `input`인자에도 값을 집어 넣어줘야함"]},{"cell_type":"code","metadata":{"id":"RcHJguyFipTl","executionInfo":{"status":"ok","timestamp":1603629251315,"user_tz":-540,"elapsed":1670,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"c1c50404-5e58-4fdd-f386-472fd7458ae4","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["nn.Conv2d(in_channels = 1 , out_channels = 20, kernel_size = 5, stride = 1)\n"],"execution_count":95,"outputs":[{"output_type":"execute_result","data":{"text/plain":["Conv2d(1, 20, kernel_size=(5, 5), stride=(1, 1))"]},"metadata":{"tags":[]},"execution_count":95}]},{"cell_type":"code","metadata":{"id":"iWiJbViHjFG0","executionInfo":{"status":"ok","timestamp":1603629288905,"user_tz":-540,"elapsed":1036,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"82c22906-a799-487d-83cf-3cd7d608b525","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["layer = nn.Conv2d(1, 20, 5, 1).to(torch.device('cpu'))\n","layer"],"execution_count":96,"outputs":[{"output_type":"execute_result","data":{"text/plain":["Conv2d(1, 20, kernel_size=(5, 5), stride=(1, 1))"]},"metadata":{"tags":[]},"execution_count":96}]},{"cell_type":"markdown","metadata":{"id":"GxWYFm2xjUeN"},"source":["- `wegiht`확인"]},{"cell_type":"code","metadata":{"id":"za0enRbyjPzV","executionInfo":{"status":"ok","timestamp":1603629324097,"user_tz":-540,"elapsed":3035,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"79563b9b-b9e9-4551-fbea-cd3d1979f1a6","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["weight = layer.weight\n","weight.shape"],"execution_count":98,"outputs":[{"output_type":"execute_result","data":{"text/plain":["torch.Size([20, 1, 5, 5])"]},"metadata":{"tags":[]},"execution_count":98}]},{"cell_type":"markdown","metadata":{"id":"MAZcTU2gjiCX"},"source":["- `weight`는 `detach()`를 통해 꺼내줘야 `numpy()`변환이 가능"]},{"cell_type":"code","metadata":{"id":"9eN_oUBkjT85","executionInfo":{"status":"ok","timestamp":1603629325833,"user_tz":-540,"elapsed":1722,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}}},"source":["weight = weight.detach()"],"execution_count":99,"outputs":[]},{"cell_type":"code","metadata":{"id":"kwso9tsijmz8","executionInfo":{"status":"ok","timestamp":1603629344014,"user_tz":-540,"elapsed":6221,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"5f344ce3-db5c-4b13-a050-266007e63de8","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["weight = weight.numpy()\n","weight.shape"],"execution_count":100,"outputs":[{"output_type":"execute_result","data":{"text/plain":["(20, 1, 5, 5)"]},"metadata":{"tags":[]},"execution_count":100}]},{"cell_type":"code","metadata":{"id":"mUegf6HPjdPl","executionInfo":{"status":"ok","timestamp":1603629420466,"user_tz":-540,"elapsed":1058,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"db0256ad-5144-49d4-b400-4ef4d59f221b","colab":{"base_uri":"https://localhost:8080/","height":262}},"source":["plt.imshow(weight[0,0,:,:], 'jet')\n","plt.colorbar()\n","plt.show()"],"execution_count":102,"outputs":[{"output_type":"display_data","data":{"image/png":"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\n","text/plain":["<Figure size 432x288 with 2 Axes>"]},"metadata":{"tags":[]}}]},{"cell_type":"code","metadata":{"id":"DMeTOqVmcdWa","executionInfo":{"status":"ok","timestamp":1603629456159,"user_tz":-540,"elapsed":1029,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"90ffd822-eb47-4d20-c068-3426a124598d","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["print(images.shape)"],"execution_count":103,"outputs":[{"output_type":"stream","text":["torch.Size([8, 1, 28, 28])\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"cvolnNsscdHs","executionInfo":{"status":"ok","timestamp":1603629521039,"user_tz":-540,"elapsed":1395,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}}},"source":["input_image = torch.unsqueeze(images[0], dim = 0)\n"],"execution_count":106,"outputs":[]},{"cell_type":"code","metadata":{"id":"NLOAfD5mjup1","executionInfo":{"status":"ok","timestamp":1603629526320,"user_tz":-540,"elapsed":796,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}}},"source":["output_data = layer(input_image)"],"execution_count":107,"outputs":[]},{"cell_type":"code","metadata":{"id":"r50wFkl6j1sY","executionInfo":{"status":"ok","timestamp":1603629538049,"user_tz":-540,"elapsed":2938,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}}},"source":["output = output_data.data"],"execution_count":108,"outputs":[]},{"cell_type":"code","metadata":{"id":"ZiIp-frJj2Hl","executionInfo":{"status":"ok","timestamp":1603629551989,"user_tz":-540,"elapsed":960,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"d565430b-6cbd-4e4d-9d22-2ddf44009b23","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["output_arr = output.numpy()\n","output_arr.shape"],"execution_count":109,"outputs":[{"output_type":"execute_result","data":{"text/plain":["(1, 20, 24, 24)"]},"metadata":{"tags":[]},"execution_count":109}]},{"cell_type":"code","metadata":{"id":"uOHMu-UQkW3a","executionInfo":{"status":"ok","timestamp":1603629666571,"user_tz":-540,"elapsed":1239,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"9595711b-b8db-46aa-f74e-9b0b36b67db3","colab":{"base_uri":"https://localhost:8080/","height":233}},"source":["plt.figure(figsize = (15, 30))\n","plt.subplot(131)\n","plt.title('input')\n","plt.imshow(image,'gray')\n","plt.subplot(132)\n","plt.title('weight')\n","plt.imshow(weight[0,0,:,:], 'jet')\n","plt.subplot(133)\n","plt.title('output')\n","plt.imshow(output_arr[0,0,:,:], 'gray')\n","plt.show()"],"execution_count":110,"outputs":[{"output_type":"display_data","data":{"image/png":"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\n","text/plain":["<Figure size 1080x2160 with 3 Axes>"]},"metadata":{"tags":[]}}]},{"cell_type":"markdown","metadata":{"id":"6sCqGmH_kwHm"},"source":["### Pooling\n","- `F.max_pool2d` \n","  - `stride`\n","\n","  - `kernel_size`\n","\n","- `torch.nn.MaxPool2d` 도 많이 사용"]},{"cell_type":"code","metadata":{"id":"AYqPrLH1kxQl","executionInfo":{"status":"ok","timestamp":1603629676623,"user_tz":-540,"elapsed":2004,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"48a4446b-c0b7-45c2-8a4f-7fa08c76dcbf","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["image.shape"],"execution_count":111,"outputs":[{"output_type":"execute_result","data":{"text/plain":["(28, 28)"]},"metadata":{"tags":[]},"execution_count":111}]},{"cell_type":"code","metadata":{"id":"tvI8W_8Yk81S","executionInfo":{"status":"ok","timestamp":1603629693941,"user_tz":-540,"elapsed":1895,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"de75d403-183e-4c43-ee71-72712bee2422","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["pool = F.max_pool2d(output,2,2)\n","pool.shape"],"execution_count":112,"outputs":[{"output_type":"execute_result","data":{"text/plain":["torch.Size([1, 20, 12, 12])"]},"metadata":{"tags":[]},"execution_count":112}]},{"cell_type":"markdown","metadata":{"id":"aV3HK4FulCaJ"},"source":["- MaxPool Layer는 weight가 없기 때문에 바로 `numpy()`변환 가능"]},{"cell_type":"code","metadata":{"id":"fseB_qlflBta","executionInfo":{"status":"ok","timestamp":1603629714667,"user_tz":-540,"elapsed":1087,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"a9ab43b1-413d-43bd-d302-9d29428d0696","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["pool_arr = pool.numpy()\n","pool_arr.shape"],"execution_count":113,"outputs":[{"output_type":"execute_result","data":{"text/plain":["(1, 20, 12, 12)"]},"metadata":{"tags":[]},"execution_count":113}]},{"cell_type":"code","metadata":{"id":"6w8DQnNtlNCq","executionInfo":{"status":"ok","timestamp":1603629810321,"user_tz":-540,"elapsed":2958,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"21e23748-e08d-4eba-a694-df64a1b12744","colab":{"base_uri":"https://localhost:8080/","height":313}},"source":["plt.figure(figsize = (10,15))\n","plt.subplot(121)\n","plt.title('input')\n","plt.imshow(image, 'gray')\n","plt.subplot(122)\n","plt.title('output')\n","plt.imshow(pool_arr[0,0,:,:], 'gray')\n","plt.show()\n","\n","# maxpool 넘긴 결과"],"execution_count":116,"outputs":[{"output_type":"display_data","data":{"image/png":"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q7D08+uXunTpookTJ1o1DwBcE3379lXfvn3tHgNAAKjVf6WGDRumoqIiSVJBQYFatGhh6VAAAABOYbqyVFhYqMzMTBUXF8vlcik3N1f9+vXTiBEjFBoaqrCwME2ZMuVazIoahIWFmdYsWLDAtObiKYlr4WLYNtKtWzfTmm+//daKcQAAqJFpWEpMTNTKlSt/9Xj37t39MhAAAICTcEUjAACAAd7uBADg5a/dzKdPn255z4YNG1re0x/vE+mPnv74Pp0/f97yntcLVpYAAAAMEJYAAAAMEJYAAAAMEJYAAAAMEJYAAAAMcDecw91www2mNS+//LJpTf/+/U1rPB6PaY0vd2AkJSWZ1hw4cMC0hg0nAQBOwMoSAACAAcISAACAAcISAACAAcISAACAAcISAACAAcISAACAAcISAACAAcISAACAATaldLhevXqZ1owePdq0pqyszLRmzJgxpjX//Oc/TWv+7//+z7QmIyPDtKZDhw6mNZ999plpDQAAV4OVJQAAAAOEJQAAAAOEJQAAAAOEJQAAAAOEJQAAAAPcDQcA8Orfv79f+nbs2NHynp988onlPT/44APLe950002W92zVqpXlPdevX295z+sFK0sAAAAGCEsAAAAGOA3ncOPGjTOt2bNnj2nNgw8+aFrjy8aVvpg2bZppzaBBg0xr0tLSTGvYlBIA4G+sLAEAABggLAEAABggLAEAABggLAEAABjgAm8Adc6ZM2c0btw4nThxQufPn9fzzz/v000QAOomwhKAOufdd99V8+bNNXr0aJWUlGjgwIHasGGD3WMBcChOwwGocyIjI3X8+HFJ0smTJxUZGWnzRACcjJUlAHVOz549tWbNGj388MM6efKkFi1aZPdIAByMsORwcXFxpjXp6emmNVZtOOmLc+fOmdZkZmaa1gwbNsy0JiIiwrTm4goCcNF7772nuLg4LVu2THv27FFGRobWrFlj91gAHIrTcADqnB07dqh9+/aSpDvvvFNHjhyRx+OxeSoATuXTylJWVpa++uorVVVVadCgQbrnnns0duxYeTweRUdHa9q0aQoJCfH3rABgiYSEBO3cuVPdu3dXcXGxGjZsqODgYLvHAuBQpmEpPz9f+/btU3Z2ttxut1JSUpScnKy0tDT16NFDr7/+unJycnx6Hy8AcILU1FRlZGSoX79+qqqq0sSJE+0eCYCDmYal1q1bKykpSZIUHh6uiooKFRQU6OWXX5Ykde7cWcuXLycsAQgYDRs21KxZs+weA0CAML1mKTg4WGFhYZKknJwcdejQQRUVFd7TblFRUSotLfXvlAAAADbx+QLvvLw85eTkaMKECZc8Xl1dbflQAAAATuFTWNq6dasWLlyoJUuWqHHjxgoLC1NlZaUkqaSkRDExMX4dEgAAwC6mYenUqVPKysrSokWLvHvatG3bVrm5uZKkjRs38p5KAADgumV6gff69evldrs1YsQI72NTp07V+PHjlZ2drbi4OPXu3duvQ8LYE088YVrz5ptvmtZcuHDBinF88uGHH5rWzJgxw7TmueeeM62ZPn26TzMBkG6//Xa/9N2/f7/lPZs3b255z/r161ves0GDBpb3PHHihOU9UTPTsJSamqrU1NRfPb5ixQq/DAQAAOAk7OANAABggLAEAABggLAEAABggLAEAABggLAEAABggLAEAABggLAEAABggLAEAABgwHRTStgrPz/ftCYlJcW0ZuTIkaY1r732mk8zWeG7774zrbn4ljpGYmNjLZgGAICasbIEAABggLAEAABggLAEAABggLAEAABggLAEAABggLAEAABggLAEAABggLAEAABggE0pHW7s2LGmNZ06dTKtmTp1qmnNwIEDTWtmzZplWrNp0ybTGrfbbVpTVlZmWgMAgL+xsgQAAGCAsAQAAGCA03AAEKBuvfVWy3tu27bN8p6S9MILL1je86OPPrK8Z1pamuU9GzVqZHnPFStWWN4TNWNlCQAAwABhCQAAwABhCQAAwABhCQAAwABhCQAAwAB3wzncgQMHTGsefvhh05r333/ftCYxMdG0ZsmSJaY1vjhy5IhpTUxMjGnNa6+9ZsU4AADUiJUlANe1vXv3qmvXrlq1apUk6dChQ+rfv7/S0tI0fPhwnTt3zuYJATgdYQnAdau8vFyTJk1ScnKy97HZs2crLS1Nb731lhISEpSTk2PjhAACAWEJwHUrJCRES5YsueSUbkFBgR566CFJUufOnbV9+3a7xgMQILhmCcB1y+VyyeW69DBXUVGhkJAQSVJUVJRKS0vtGA1AAGFlCUCdVV1dbfcIAAIAYQlAnRIWFqbKykpJUklJiU93XQKo2whLAOqUtm3bKjc3V5K0ceNGPfjggzZPBMDpuGYJwHWrsLBQmZmZKi4ulsvl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\n","text/plain":["<Figure size 720x1080 with 2 Axes>"]},"metadata":{"tags":[]}}]},{"cell_type":"markdown","metadata":{"id":"q7RVioKwlbH1"},"source":["### Linear\n","- 1d만 가능 `.view()`를 통해 1D로 펼쳐줘야함"]},{"cell_type":"code","metadata":{"id":"Kwcedadrlcbl","executionInfo":{"status":"ok","timestamp":1603629855273,"user_tz":-540,"elapsed":1401,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"eb406674-b299-4c05-ddb4-227a029b894e","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["image = torch.from_numpy(image)\n","image.shape"],"execution_count":117,"outputs":[{"output_type":"execute_result","data":{"text/plain":["torch.Size([28, 28])"]},"metadata":{"tags":[]},"execution_count":117}]},{"cell_type":"code","metadata":{"id":"_mYQy4I3lmAm","executionInfo":{"status":"ok","timestamp":1603629884303,"user_tz":-540,"elapsed":2956,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"d4ecd6dd-65c3-4320-fe41-a6c723d7dc9d","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["flatten = image.view(1, 28*28)\n","flatten.shape"],"execution_count":118,"outputs":[{"output_type":"execute_result","data":{"text/plain":["torch.Size([1, 784])"]},"metadata":{"tags":[]},"execution_count":118}]},{"cell_type":"code","metadata":{"id":"6wgSmY0Zlofk","executionInfo":{"status":"ok","timestamp":1603629916170,"user_tz":-540,"elapsed":3592,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"969a1893-2815-450b-a9b2-5b9f86a458d0","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["lin = nn.Linear(784,10)(flatten)\n","lin.shape"],"execution_count":119,"outputs":[{"output_type":"execute_result","data":{"text/plain":["torch.Size([1, 10])"]},"metadata":{"tags":[]},"execution_count":119}]},{"cell_type":"code","metadata":{"id":"LcJFqf0alsxr","executionInfo":{"status":"ok","timestamp":1603629929852,"user_tz":-540,"elapsed":2135,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"bc70cd8a-71e0-430d-c760-fa505c8b3205","colab":{"base_uri":"https://localhost:8080/","height":52}},"source":["lin"],"execution_count":120,"outputs":[{"output_type":"execute_result","data":{"text/plain":["tensor([[ 0.8835, -0.0988, -0.2699, -1.0963, -0.4530,  0.3324,  0.3980,  0.7537,\n","          0.0183, -0.7639]], grad_fn=<AddmmBackward>)"]},"metadata":{"tags":[]},"execution_count":120}]},{"cell_type":"code","metadata":{"id":"ewEpebSVluHz","executionInfo":{"status":"ok","timestamp":1603629954095,"user_tz":-540,"elapsed":1382,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"cbda0059-f47b-4bf2-ce84-6e53c4474d0c","colab":{"base_uri":"https://localhost:8080/","height":248}},"source":["plt.imshow(lin.detach().numpy(), 'jet')\n","plt.colorbar()\n","plt.show()\n","\n","# 0~9까지 weight값을 눈으로 확인 가능"],"execution_count":121,"outputs":[{"output_type":"display_data","data":{"image/png":"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h9Fc6sskqH0+H+PGjQvvd69hB/pc9959TEQknrpnfUTaLttZH5eyhl1EJFY6GcEIEgzadMaoN+ZFFdTRrHsXEYk3c485td6IOuqHMg103buISLwN1xp1VCPqaNa9i4jEm+1WJkaz7l1EJJ5st+BFRGS4CeA0rFEHLLjgRUEtIrbhJwGXwbM+/AazQuJBQS0itmG7GrWIyHBjuxp1pIcyzZs3j/T09PDLKNetW0daWtql91ZE5BIEcOKyS4362w9lOnToEJWVlb1meWzcuJHRo2P35m8RESPd70w0amM1UfWov4cyDeTFjcHghVeyn3XH5n+UrravY3IdgCA+40aDwO3uiMl1APC2xexSbSdi+B/KmdhdyhujX+tEmz82FwLcoaH/c+EOfQH8/8y4FH5GgMHNQn8fbyGPt6j+6Ph8PrKzs8P73Q9e+nZQV1VVcfToUX7wgx9QXl6Ow+Ho8R3dD2pqGD8+mi4MXGF9bK4DQGyuNXFiTC5zwW/eidmlConlLxZDsfq1Co/G6EIwkcKYXcvr9XLddddd0ncEcOEwLH2Yq1H7/X4qKio4duxY+IXf1157bY827777Li+//DJOp5OZM2fy29/+lrq6Op5++mnG/zf78vLyeOCBByJea0geyrRs2TJmz55NUlISS5cuZfv27dx888092kyePJlXX32VlJSUcC1bRORiwWAQr9fL5MmTL/27cOE0iD2zNxO3bdvGmDFjqK6uZufOnVRXV7N+/frw8W+++YZ169axdetWRo8ezV133cVtt90GXFixvWLFCtP9HvSHMgHccccd4Z8LCgo4cOBAr6AeNWoU06dPj+byImIzlzqS7jaY0/OamprCWZeXl0dlZWWP41dccQVbt24NVxrGjh3LqVOnouj1EDyU6auvvmLx4sV0dl54VOBHH33EpEmTouqciMhg6n4VV+TNXCz6fL7ws/edTicOhyOce926c/Gzzz7j6NGjTJ06FbgwIWPx4sWUlZXx6aefGl5rSB7KVFBQwN13383IkSO5/vrre42mRUTi4cJoeuDzqGtra6mtre3xWUtLS4/9/p7L/5///Ifly5dTXV3NiBEjmDp1KsnJycydO5e9e/eyYsUK3nkn8j2gIXkoU1lZGWVlZdF+db8izd0erp588kn+8Y9/EAgEuP/++/nRj34U7y4NmnPnznHrrbfy4IMP8tOf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\n","text/plain":["<Figure size 432x288 with 2 Axes>"]},"metadata":{"tags":[]}}]},{"cell_type":"markdown","metadata":{"id":"0IjPKDKRl3CV"},"source":["### Softmax"]},{"cell_type":"code","metadata":{"id":"obhBb3O-lzbs","executionInfo":{"status":"ok","timestamp":1603630023899,"user_tz":-540,"elapsed":1563,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}}},"source":["with torch.no_grad():\n","    flatten = image.view(1,28*28)\n","    lin = nn.Linear(784, 10)( flatten)\n","    softmax = F.softmax(lin, dim = 1)\n","    "],"execution_count":122,"outputs":[]},{"cell_type":"code","metadata":{"id":"ljgOEyNMmBEE","executionInfo":{"status":"ok","timestamp":1603630027437,"user_tz":-540,"elapsed":2190,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"ac490b66-dd27-4d27-9554-8b5fb16450cf","colab":{"base_uri":"https://localhost:8080/","height":52}},"source":["softmax # 0~ 1사이로 어느 확률이 가장 높은지 알려ㅜ젓지"],"execution_count":123,"outputs":[{"output_type":"execute_result","data":{"text/plain":["tensor([[0.0417, 0.1582, 0.0606, 0.1579, 0.0887, 0.1187, 0.0686, 0.1235, 0.1244,\n","         0.0578]])"]},"metadata":{"tags":[]},"execution_count":123}]},{"cell_type":"code","metadata":{"id":"18ymFSRAmBo7","executionInfo":{"status":"ok","timestamp":1603630049991,"user_tz":-540,"elapsed":3397,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"a7acb11e-1020-403b-a513-43227137f1e2","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["np.sum(softmax.numpy())\n","# 다 더하니까 거의 1이잖아"],"execution_count":124,"outputs":[{"output_type":"execute_result","data":{"text/plain":["0.99999994"]},"metadata":{"tags":[]},"execution_count":124}]},{"cell_type":"markdown","metadata":{"id":"bYh13Bnj5wEN"},"source":["### F.relu\n","\n","- ReLU 함수를 적용하는 레이어\n","\n","- `nn.ReLU`로도 사용 가능"]},{"cell_type":"code","metadata":{"id":"D4VFePpR9_Ak","executionInfo":{"status":"ok","timestamp":1603630073860,"user_tz":-540,"elapsed":1155,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"2af7d380-5f7c-4eb8-f492-384146926882","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["inputs = torch.randn(4,3,28,28).to(device)\n","inputs.shape"],"execution_count":125,"outputs":[{"output_type":"execute_result","data":{"text/plain":["torch.Size([4, 3, 28, 28])"]},"metadata":{"tags":[]},"execution_count":125}]},{"cell_type":"code","metadata":{"id":"1lKlSiaY5wZW","executionInfo":{"status":"ok","timestamp":1603630120220,"user_tz":-540,"elapsed":4064,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"26a68d5e-2885-4a9b-fbbb-4b52554576c8","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["layer = nn.Conv2d(3, 20, 5, 1).to(device)\n","output = F.relu(layer(inputs))\n","output.shape"],"execution_count":126,"outputs":[{"output_type":"execute_result","data":{"text/plain":["torch.Size([4, 20, 24, 24])"]},"metadata":{"tags":[]},"execution_count":126}]},{"cell_type":"markdown","metadata":{"id":"0yuABl4h-yye"},"source":["## Optimizer\n","\n","- `import torch.optim as optim`\n","\n","- `model`의 파라미터를 업데이트\n","\n","- 예시)\n","  ```python\n","  optimizer = torch.optim.Adam(model.parameters(), lr=1e-4, weight_decay=1e-5)\n","  optimizer = optim.SGD(model.parameters(), lr=0.001)\n","  ```\n","\n","- `.zero_grad()`로 초기화\n","- `.step()`으로 업데이트\n","\n"]}]}