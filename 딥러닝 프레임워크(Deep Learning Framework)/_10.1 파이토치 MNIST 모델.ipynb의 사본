{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"name":"_10.1 파이토치 MNIST 모델.ipynb의 사본","provenance":[{"file_id":"19fuJ3fsZ6y5Bq0hGcRBNdaYP_JSTzF8t","timestamp":1603709593736}],"collapsed_sections":[]},"kernelspec":{"name":"python3","display_name":"Python 3"},"accelerator":"GPU","widgets":{"application/vnd.jupyter.widget-state+json":{"a4c2048fb53147e99e5dc7e4a33367b0":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_eb7205b461c34495aaadfcc86bfb61ee","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_001dde439f564c7db4793288724c3409","IPY_MODEL_2651633cd06f4e5d9f6f570913d291ad"]}},"eb7205b461c34495aaadfcc86bfb61ee":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"001dde439f564c7db4793288724c3409":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_b77bb5a60cef45219b1c65090f22d2ab","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"info","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_c48e22d179744b5f9717dd22afa79aa8"}},"2651633cd06f4e5d9f6f570913d291ad":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_87c67eb68d3e4a178dddb9649a477fa5","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 9920512/? [00:20&lt;00:00, 2172159.60it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_dc7bea68679b4a2a9401b0c5acbd5532"}},"b77bb5a60cef45219b1c65090f22d2ab":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"c48e22d179744b5f9717dd22afa79aa8":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"87c67eb68d3e4a178dddb9649a477fa5":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"dc7bea68679b4a2a9401b0c5acbd5532":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"9cf0e91132914b09baa9401b14bc50a5":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_f1f76255978c4d58a5fa9a3e671bb7cf","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_bbceac85b1c24a43bd8557fc6f75e693","IPY_MODEL_b8d1f8791cb84ff7b7f483e03f3befce"]}},"f1f76255978c4d58a5fa9a3e671bb7cf":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"bbceac85b1c24a43bd8557fc6f75e693":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_5de5ab14f8e944bd991d15c9297eb4c0","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_7d332780a7d04aab91b384c33ee84649"}},"b8d1f8791cb84ff7b7f483e03f3befce":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_8330be16e225476c90fa13f6741f0978","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 32768/? [00:02&lt;00:00, 11133.01it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_bb2c8e52caa34909bc87ac3ff2eece0a"}},"5de5ab14f8e944bd991d15c9297eb4c0":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"7d332780a7d04aab91b384c33ee84649":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"8330be16e225476c90fa13f6741f0978":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"bb2c8e52caa34909bc87ac3ff2eece0a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"34eaac27c752441facd6960d5853e441":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_5ac253d81b3a4b3bbe4751368ed3bcc2","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_69f435b8d8e345c3a138be14899fb035","IPY_MODEL_2f9cb7cff9444610aca5ee3ebc7eda0c"]}},"5ac253d81b3a4b3bbe4751368ed3bcc2":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"69f435b8d8e345c3a138be14899fb035":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_42da1d8e78de427c85c7d7169ce54e0d","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_96b36611306143da8b6a4ebfb2c85eea"}},"2f9cb7cff9444610aca5ee3ebc7eda0c":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_87c31d938cca4952bf86640036ea20eb","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 1654784/? [00:02&lt;00:00, 719117.46it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_91cea6866c9b4a189fc8067960cba184"}},"42da1d8e78de427c85c7d7169ce54e0d":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"96b36611306143da8b6a4ebfb2c85eea":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"87c31d938cca4952bf86640036ea20eb":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"91cea6866c9b4a189fc8067960cba184":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"a3a650a035ae4d869b2d4b4568bacfd9":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_fa0e31045cf848ea9366d33b5da0d288","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_b4966ba8ffac4a93b4bacd384b5e3a36","IPY_MODEL_59536e75c5b743eda416ad828c7c82d7"]}},"fa0e31045cf848ea9366d33b5da0d288":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"b4966ba8ffac4a93b4bacd384b5e3a36":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_777d429682ae49c486de2868c86cbe65","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_ac8935c98d6f45749a3833eadf77e6ee"}},"59536e75c5b743eda416ad828c7c82d7":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_f87436ebffc8409993a63a41a6523388","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 8192/? [00:00&lt;00:00, 14802.12it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_63161053bb884695b74bc080834736ad"}},"777d429682ae49c486de2868c86cbe65":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"ac8935c98d6f45749a3833eadf77e6ee":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"f87436ebffc8409993a63a41a6523388":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"63161053bb884695b74bc080834736ad":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"b537776b6de3481283027225a3008d4e":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_be42cb0f2ca64ae2a8e3e89d613eadfb","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_2e852648098245d88d3c257fcc2a008b","IPY_MODEL_218a966bcbf34512b6ab0d53b64c9960"]}},"be42cb0f2ca64ae2a8e3e89d613eadfb":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"2e852648098245d88d3c257fcc2a008b":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_0a3ee6d13c014782a5f615ef65d4374d","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"info","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_172e24d497a846d282a9db39ad973886"}},"218a966bcbf34512b6ab0d53b64c9960":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_922064f5a4284e578e7385602110f9cd","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 9920512/? [00:19&lt;00:00, 824525.76it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_5a7ec0a464704b93952929a2a59cdefb"}},"0a3ee6d13c014782a5f615ef65d4374d":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"172e24d497a846d282a9db39ad973886":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"922064f5a4284e578e7385602110f9cd":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"5a7ec0a464704b93952929a2a59cdefb":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"138cc1975c1545f6bf82644772993ea9":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_11d4504092f74e1ba2bb7e0ac6240253","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_5efb1b96a9cf433e8254ef2b17d4ef6f","IPY_MODEL_df27d7381f0c466d9ae8c5cfeabbc816"]}},"11d4504092f74e1ba2bb7e0ac6240253":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"5efb1b96a9cf433e8254ef2b17d4ef6f":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_d3c28d5f99ba4ff89a52b12c5fe4ed82","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_b37329735c6f426ba22307ae2f6922a0"}},"df27d7381f0c466d9ae8c5cfeabbc816":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_dd338beab76540b59c9cb44b8bc660a2","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 32768/? [00:00&lt;00:00, 118208.75it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_882a8870ca0d409688c2a374aa2f1a60"}},"d3c28d5f99ba4ff89a52b12c5fe4ed82":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"b37329735c6f426ba22307ae2f6922a0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"dd338beab76540b59c9cb44b8bc660a2":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"882a8870ca0d409688c2a374aa2f1a60":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"8e226908a1f946f0855e49595c232b51":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_1752d87847804addab66a1d0146a9e52","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_4908a7ff7f3e45a59061aa4636d461e2","IPY_MODEL_244847847b754d3f992f5dfc7c639bc7"]}},"1752d87847804addab66a1d0146a9e52":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"4908a7ff7f3e45a59061aa4636d461e2":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_b04601d945d240cbb2965400df26d779","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"info","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_ab99a4f538c046d09348e601cec6aaa4"}},"244847847b754d3f992f5dfc7c639bc7":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_c6005bd26096424c8b3f0daf56a5a7f2","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 1654784/? [00:18&lt;00:00, 527312.61it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_7acd0eb980d64f988d06a0411db800f7"}},"b04601d945d240cbb2965400df26d779":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"ab99a4f538c046d09348e601cec6aaa4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"c6005bd26096424c8b3f0daf56a5a7f2":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"7acd0eb980d64f988d06a0411db800f7":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"55f4d3fa6a7e4addabcf090fc280006c":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_559f444250b24c859fd83451eae654c6","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_6438e959f9cb45cfa8587af50bb7531c","IPY_MODEL_b616009802ac4ef69009c262db59fdcf"]}},"559f444250b24c859fd83451eae654c6":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"6438e959f9cb45cfa8587af50bb7531c":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_9eea6b07010f4019b1f4b0beae148e0b","_dom_classes":[],"description":"  0%","_model_name":"FloatProgressModel","bar_style":"info","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":0,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_d8a92f72d21d4e1cab976f2c26eb3e46"}},"b616009802ac4ef69009c262db59fdcf":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_2b23cd50be174e64835ceb56d1fba1cd","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 0/4542 [00:00&lt;?, ?it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_6c9f9113a87044a4be1a53acf55c588e"}},"9eea6b07010f4019b1f4b0beae148e0b":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"d8a92f72d21d4e1cab976f2c26eb3e46":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"2b23cd50be174e64835ceb56d1fba1cd":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"6c9f9113a87044a4be1a53acf55c588e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}}}}},"cells":[{"cell_type":"markdown","metadata":{"id":"N70Zo_KMAg1H"},"source":["# 파이토치 MNIST 모델"]},{"cell_type":"markdown","metadata":{"id":"aNj9ScsbAlr-"},"source":["## modules import "]},{"cell_type":"code","metadata":{"id":"IaKgb-5BAj68","executionInfo":{"status":"ok","timestamp":1603705087326,"user_tz":-540,"elapsed":1673,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}}},"source":["import torch\n","import torch.nn as nn\n","import torch.nn.functional as F\n","import torch.optim as optim\n","from torch.utils.data import Dataset, DataLoader\n","\n","import torchvision\n","import torchvision.datasets\n","import torchvision.transforms as transforms\n","\n","import numpy as np\n","import matplotlib.pyplot as plt\n","plt.style.use('seaborn-white')"],"execution_count":2,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"-v_WXu5iDfZK"},"source":["## 전처리 설정\n","- `transform.Compose`"]},{"cell_type":"code","metadata":{"id":"Xu74M5BxDiLH","executionInfo":{"status":"ok","timestamp":1603705148046,"user_tz":-540,"elapsed":982,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}}},"source":["transform = transforms.Compose([transforms.ToTensor(), \n","                                transforms.Normalize((0.5,),(0.5,))]) # mean, std 각각 0.5"],"execution_count":3,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"E-eus2CsDoEe"},"source":["## 데이터 로드 및 데이터 확인"]},{"cell_type":"code","metadata":{"id":"P9FURlkCDnja","executionInfo":{"status":"ok","timestamp":1603705259324,"user_tz":-540,"elapsed":8214,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"63f5cd89-4676-451b-b361-1261c39a73e5","colab":{"base_uri":"https://localhost:8080/","height":429,"referenced_widgets":["a4c2048fb53147e99e5dc7e4a33367b0","eb7205b461c34495aaadfcc86bfb61ee","001dde439f564c7db4793288724c3409","2651633cd06f4e5d9f6f570913d291ad","b77bb5a60cef45219b1c65090f22d2ab","c48e22d179744b5f9717dd22afa79aa8","87c67eb68d3e4a178dddb9649a477fa5","dc7bea68679b4a2a9401b0c5acbd5532","9cf0e91132914b09baa9401b14bc50a5","f1f76255978c4d58a5fa9a3e671bb7cf","bbceac85b1c24a43bd8557fc6f75e693","b8d1f8791cb84ff7b7f483e03f3befce","5de5ab14f8e944bd991d15c9297eb4c0","7d332780a7d04aab91b384c33ee84649","8330be16e225476c90fa13f6741f0978","bb2c8e52caa34909bc87ac3ff2eece0a","34eaac27c752441facd6960d5853e441","5ac253d81b3a4b3bbe4751368ed3bcc2","69f435b8d8e345c3a138be14899fb035","2f9cb7cff9444610aca5ee3ebc7eda0c","42da1d8e78de427c85c7d7169ce54e0d","96b36611306143da8b6a4ebfb2c85eea","87c31d938cca4952bf86640036ea20eb","91cea6866c9b4a189fc8067960cba184","a3a650a035ae4d869b2d4b4568bacfd9","fa0e31045cf848ea9366d33b5da0d288","b4966ba8ffac4a93b4bacd384b5e3a36","59536e75c5b743eda416ad828c7c82d7","777d429682ae49c486de2868c86cbe65","ac8935c98d6f45749a3833eadf77e6ee","f87436ebffc8409993a63a41a6523388","63161053bb884695b74bc080834736ad"]}},"source":["trainset = torchvision.datasets.MNIST(root='./data',\n","                                      train = True,\n","                                      download = True,\n","                                      transform = transform)\n","\n","# testset = torchvision.data\n","testset = torchvision.datasets.MNIST(root='./data',\n","                                      train = False,\n","                                      download = True,\n","                                      transform = transform)\n"],"execution_count":6,"outputs":[{"output_type":"stream","text":["Downloading http://yann.lecun.com/exdb/mnist/train-images-idx3-ubyte.gz to ./data/MNIST/raw/train-images-idx3-ubyte.gz\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"a4c2048fb53147e99e5dc7e4a33367b0","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=1.0, bar_style='info', max=1.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["Extracting ./data/MNIST/raw/train-images-idx3-ubyte.gz to ./data/MNIST/raw\n","Downloading http://yann.lecun.com/exdb/mnist/train-labels-idx1-ubyte.gz to ./data/MNIST/raw/train-labels-idx1-ubyte.gz\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"9cf0e91132914b09baa9401b14bc50a5","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=1.0, bar_style='info', max=1.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["Extracting ./data/MNIST/raw/train-labels-idx1-ubyte.gz to ./data/MNIST/raw\n","Downloading http://yann.lecun.com/exdb/mnist/t10k-images-idx3-ubyte.gz to ./data/MNIST/raw/t10k-images-idx3-ubyte.gz\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"34eaac27c752441facd6960d5853e441","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=1.0, bar_style='info', max=1.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["Extracting ./data/MNIST/raw/t10k-images-idx3-ubyte.gz to ./data/MNIST/raw\n","Downloading http://yann.lecun.com/exdb/mnist/t10k-labels-idx1-ubyte.gz to ./data/MNIST/raw/t10k-labels-idx1-ubyte.gz\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"a3a650a035ae4d869b2d4b4568bacfd9","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=1.0, bar_style='info', max=1.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["Extracting ./data/MNIST/raw/t10k-labels-idx1-ubyte.gz to ./data/MNIST/raw\n","Processing...\n","\n","\n","\n"],"name":"stdout"},{"output_type":"stream","text":["/usr/local/lib/python3.6/dist-packages/torchvision/datasets/mnist.py:469: UserWarning: The given NumPy array is not writeable, and PyTorch does not support non-writeable tensors. This means you can write to the underlying (supposedly non-writeable) NumPy array using the tensor. You may want to copy the array to protect its data or make it writeable before converting it to a tensor. This type of warning will be suppressed for the rest of this program. (Triggered internally at  /pytorch/torch/csrc/utils/tensor_numpy.cpp:141.)\n","  return torch.from_numpy(parsed.astype(m[2], copy=False)).view(*s)\n"],"name":"stderr"},{"output_type":"stream","text":["Done!\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"YYAssGe4Dy3c","executionInfo":{"status":"ok","timestamp":1603705333746,"user_tz":-540,"elapsed":4258,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}}},"source":["train_loader = DataLoader(trainset,\n","                          batch_size = 128,\n","                          shuffle = True,\n","                          num_workers = 2)\n","\n","test_loader = DataLoader(testset,\n","                         batch_size = 128,\n","                         shuffle = False,\n","                         num_workers = 2)"],"execution_count":7,"outputs":[]},{"cell_type":"code","metadata":{"id":"X6gBiInXEG19","executionInfo":{"status":"ok","timestamp":1603705350144,"user_tz":-540,"elapsed":3381,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}}},"source":["image, label = next(iter(train_loader)) # iter로 만들려고"],"execution_count":8,"outputs":[]},{"cell_type":"code","metadata":{"id":"maF2sZwmEqYh","executionInfo":{"status":"ok","timestamp":1603705355266,"user_tz":-540,"elapsed":1561,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"7b50ed05-0a98-409e-95be-176340669419","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["image.shape, label.shape"],"execution_count":9,"outputs":[{"output_type":"execute_result","data":{"text/plain":["(torch.Size([128, 1, 28, 28]), torch.Size([128]))"]},"metadata":{"tags":[]},"execution_count":9}]},{"cell_type":"code","metadata":{"id":"IwylR2BtFDCf","executionInfo":{"status":"ok","timestamp":1603705486982,"user_tz":-540,"elapsed":2812,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}}},"source":["def imshow(img):\n","    img = img / 2 + 0.5\n","    npimg = img.numpy()\n","    fig = plt.figure(figsize = (10,5))\n","    plt.imshow(np.transpose(npimg,(1,2,0)))\n","    plt.show()"],"execution_count":10,"outputs":[]},{"cell_type":"code","metadata":{"id":"4NKMcdmuFF7m","executionInfo":{"status":"ok","timestamp":1603705524504,"user_tz":-540,"elapsed":1731,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"0ac52990-e805-477f-8d7f-07cd2c051a61","colab":{"base_uri":"https://localhost:8080/","height":192}},"source":["dataiter = iter(train_loader)\n","images, labels = dataiter.next()\n","imshow(torchvision.utils.make_grid(images[:4])) # 이미지에 있는 4개만 가져와서 봐볼게"],"execution_count":12,"outputs":[{"output_type":"display_data","data":{"image/png":"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\n","text/plain":["<Figure size 720x360 with 1 Axes>"]},"metadata":{"tags":[]}}]},{"cell_type":"markdown","metadata":{"id":"GCxg2k3oFjwk"},"source":["## 신경망 구성"]},{"cell_type":"code","metadata":{"id":"igYMZcWgBCML","executionInfo":{"status":"ok","timestamp":1603705990364,"user_tz":-540,"elapsed":1381,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"e0b35815-f2cd-4884-92d1-06dcc5ebcc88","colab":{"base_uri":"https://localhost:8080/","height":140}},"source":["class Net(nn.Module):\n","\n","    def __init__(self):\n","        super(Net, self).__init__()\n","\n","        self.conv1 = nn.Conv2d(1, 6, 3)\n","        self.conv2 = nn.Conv2d(6, 16, 3)    #6 이어 받고,커널은 3\n","        self.fc1 = nn.Linear(16* 5*5, 120)\n","        self.fc2 = nn.Linear(120, 84)\n","        self.fc3 = nn.Linear(84,10)\n","\n","    def forward(self, x):\n","        x = F.max_pool2d(F.relu(self.conv1(x)), (2,2))\n","        x = F.max_pool2d(F.relu(self.conv2(x)), 2)\n","        x = x.view(-1, self.num_flat_features(x))\n","        x = F.relu(self.fc1(x))\n","        x = F.relu(self.fc2(x))\n","        x = self.fc3(x)\n","        return x\n","\n","    def num_flat_features(self, x):\n","        size = x.size()[1:]\n","        num_features = 1\n","        for s in size:\n","            num_features *= s\n","\n","        return num_features\n","\n","net = Net()\n","print(net)"],"execution_count":16,"outputs":[{"output_type":"stream","text":["Net(\n","  (conv1): Conv2d(1, 6, kernel_size=(3, 3), stride=(1, 1))\n","  (conv2): Conv2d(6, 16, kernel_size=(3, 3), stride=(1, 1))\n","  (fc1): Linear(in_features=400, out_features=120, bias=True)\n","  (fc2): Linear(in_features=120, out_features=84, bias=True)\n","  (fc3): Linear(in_features=84, out_features=10, bias=True)\n",")\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"6CN4Kbd9FliP"},"source":["- `.parameters()` "]},{"cell_type":"code","metadata":{"id":"ZxxZoCC-Fn9b","executionInfo":{"status":"ok","timestamp":1603705990366,"user_tz":-540,"elapsed":961,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"d135c847-9edd-41f4-a089-6de7cd39c5c9","colab":{"base_uri":"https://localhost:8080/","height":52}},"source":["params = list(net.parameters()) # parameters로 확인해볼게\n","print(len(params))\n","print(params[0].size())"],"execution_count":17,"outputs":[{"output_type":"stream","text":["10\n","torch.Size([6, 1, 3, 3])\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"jelPFbNgFwmG"},"source":["임의의 값을 넣어 forward값 확인"]},{"cell_type":"code","metadata":{"id":"nI-7V1oUFoxG","executionInfo":{"status":"ok","timestamp":1603705992178,"user_tz":-540,"elapsed":1391,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"b1cf7e6c-aae2-4501-b39b-c41d2a53fb65","colab":{"base_uri":"https://localhost:8080/","height":52}},"source":["input = torch.randn(1,1,28,28)\n","out = net(input)\n","print(out)\n","\n","# 임의의 input을 넣고 바뀐 결과"],"execution_count":18,"outputs":[{"output_type":"stream","text":["tensor([[-0.0164, -0.0162,  0.0891,  0.0434, -0.0806, -0.0679,  0.0328, -0.0287,\n","         -0.0951, -0.0560]], grad_fn=<AddmmBackward>)\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"hFAKDY87FRuu"},"source":["## 손실함수와 옵티마이저"]},{"cell_type":"code","metadata":{"id":"XHGAenL0Fu7R","executionInfo":{"status":"ok","timestamp":1603706071828,"user_tz":-540,"elapsed":1059,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}}},"source":["criterion = nn.CrossEntropyLoss()\n","optimizer = optim.SGD(net.parameters(), lr = 0.001, momentum = 0.9)"],"execution_count":19,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"NV5_xdUsGB1x"},"source":["## 모델 학습\n","\n","- `optimizer.zero_grad` : 가중치의 그래디언트 초기화\n","\n","- loss 계산\n","\n","- `loss.backward()`\n","\n","- `optmizer.step()` : 업데이트"]},{"cell_type":"markdown","metadata":{"id":"rBIYk0aTGEPW"},"source":["- 배치수 확인"]},{"cell_type":"code","metadata":{"id":"qax43PdgDQBk","executionInfo":{"status":"ok","timestamp":1603706090350,"user_tz":-540,"elapsed":2161,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"4ed35425-6c2a-4da0-cae5-06842711bccc","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["total_batch = len(train_loader)\n","print(total_batch)\n","\n","# 469의 batch를 가짐"],"execution_count":20,"outputs":[{"output_type":"stream","text":["469\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"4eHTyg6eHzMI"},"source":["- 설명을 위해 `epochs=2`로 지정"]},{"cell_type":"code","metadata":{"id":"NzwisgcADQOD","executionInfo":{"status":"ok","timestamp":1603706348229,"user_tz":-540,"elapsed":36021,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"a103807f-246b-4309-dc0f-cbcd84f826c4","colab":{"base_uri":"https://localhost:8080/","height":158}},"source":["for epoch in range(2):\n","\n","    running_loss = 0.0\n","    for i , data in enumerate(train_loader, 0 ):\n","        inputs, labels = data\n","\n","        optimizer.zero_grad()\n","\n","        outputs = net(inputs)\n","        loss = criterion(outputs, labels)   #예측결과랑 실제값이랑 비교하려고\n","        loss.backward()\n","        optimizer.step()\n","\n","        running_loss += loss.item()\n","        if i % 100 == 99:\n","            print('epoch: {}, iter: {}, loss: {}'.format( epoch + 1, i + 1 , running_loss/2000))\n","            running_loss = 0.0"],"execution_count":21,"outputs":[{"output_type":"stream","text":["epoch: 1, iter: 100, loss: 0.11502367043495178\n","epoch: 1, iter: 200, loss: 0.11479080867767334\n","epoch: 1, iter: 300, loss: 0.11450182104110718\n","epoch: 1, iter: 400, loss: 0.11404829835891724\n","epoch: 2, iter: 100, loss: 0.11281303465366363\n","epoch: 2, iter: 200, loss: 0.11117541372776031\n","epoch: 2, iter: 300, loss: 0.10726962292194367\n","epoch: 2, iter: 400, loss: 0.09523092865943909\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"tumNqvreIMUC"},"source":["## 모델의 저장 및 로드\n","\n","- `torch.save`\n","  - `net.state_dict()`를 저장\n","\n","- `torch.load`\n","  - `load_state_dict`로 모델을 로드"]},{"cell_type":"code","metadata":{"id":"lxj4a7oHDQRR","executionInfo":{"status":"ok","timestamp":1603706397372,"user_tz":-540,"elapsed":1557,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}}},"source":["# 파이토치에서도 모델 저장하는 방법이 있다네\n","PATH = './mnist_net.pth'\n","torch.save(net.state_dict(), PATH)"],"execution_count":22,"outputs":[]},{"cell_type":"code","metadata":{"id":"9GqVJlGzDQTe","executionInfo":{"status":"ok","timestamp":1603706421345,"user_tz":-540,"elapsed":1983,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"7dd46af8-4d68-4142-93f3-f1dadd5e2483","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["net = Net()\n","net.load_state_dict(torch.load(PATH))"],"execution_count":23,"outputs":[{"output_type":"execute_result","data":{"text/plain":["<All keys matched successfully>"]},"metadata":{"tags":[]},"execution_count":23}]},{"cell_type":"code","metadata":{"id":"15cyBDq0DQV2","executionInfo":{"status":"ok","timestamp":1603706431894,"user_tz":-540,"elapsed":5309,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"7a591bf5-dc44-4a6a-f8fe-55bb4580cf65","colab":{"base_uri":"https://localhost:8080/","height":140}},"source":["net.parameters"],"execution_count":24,"outputs":[{"output_type":"execute_result","data":{"text/plain":["<bound method Module.parameters of Net(\n","  (conv1): Conv2d(1, 6, kernel_size=(3, 3), stride=(1, 1))\n","  (conv2): Conv2d(6, 16, kernel_size=(3, 3), stride=(1, 1))\n","  (fc1): Linear(in_features=400, out_features=120, bias=True)\n","  (fc2): Linear(in_features=120, out_features=84, bias=True)\n","  (fc3): Linear(in_features=84, out_features=10, bias=True)\n",")>"]},"metadata":{"tags":[]},"execution_count":24}]},{"cell_type":"markdown","metadata":{"id":"5IecfHZiI09W"},"source":["## 모델 테스트"]},{"cell_type":"code","metadata":{"id":"QewXif2NDQYZ","executionInfo":{"status":"ok","timestamp":1603708763150,"user_tz":-540,"elapsed":2285,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"7ceac0eb-ee57-41fd-82c0-30c576a84bb6","colab":{"base_uri":"https://localhost:8080/","height":192}},"source":["dataiter = iter(test_loader)\n","images, labels = dataiter.next()\n","imshow(torchvision.utils.make_grid(images[:4]))\n","# test데이터도 똑같이 구성되어잇구만"],"execution_count":25,"outputs":[{"output_type":"display_data","data":{"image/png":"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detW2+uBzLVrDVNCQoKKi4ur42+++UZer9ett7th7dq1SxkZGXrjjTfUsGFDeTweVVRUKC4uTqdOnbJdlkTwdu7cqWPHjmnnzp06efKkYmNjmWsXNW3aVPfcc49iYmLUqlUr3XLLLYqOjma+XbBv3z716tVLktS+fXtdvHhRlZWV1a8z1+7w9/fD338377777jBWWXfMnj1brVu31lNPPSXJf49immvXbsndf//9ys7OliQVFBQoISFBDRo0cOvtbkjnz59Xenq6Vq1apfj4eElSz549q+c9JydHvXv3DmeJdcbLL7+szZs363e/+51Gjx6tyZMnM9cu6tWrl3bv3q3Lly+rpKREZWVlzLdLWrdurf3790uSCgsLdcsttygxMVF79uyRxFy7xd/nuUuXLvr000917tw5lZaWat++ferWrVuYK639tmzZonr16unpp5+uzgUz167u9L1s2TLt2bNHUVFRmj9/vtq3b+/WW92QMjMztWLFCrVp06Y69+KLL2ru3Lm6ePGiWrRoocWLF6tevXphrLLuWbFihb773e+qV69emjVrFnPtkk2bNikrK0uS9MQTT6hTp07MtwtKS0s1Z84cnT59WpWVlZo6daq8Xq/mzZuny5cvq0uXLpo9e3a4y6zV8vPztWTJEhUWFiomJkbNmzfXsmXLlJaW5vg8b9++XWvXrlVUVJRSUlL0wAMPhLv8WsXfXJ8+fVo333xz9UWbxMRELViw4JrnmkejAAAAGLDTNwAAgAENEwAAgAENEwAAgAENEwAAgAENEwAAgAENEwAAgAENEwAAgMH/A1oDgJ58c5zAAAAAAElFTkSuQmCC\n","text/plain":["<Figure size 720x360 with 1 Axes>"]},"metadata":{"tags":[]}}]},{"cell_type":"code","metadata":{"id":"ELx5TrT-DQao","executionInfo":{"status":"ok","timestamp":1603708786004,"user_tz":-540,"elapsed":1734,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}}},"source":["outputs = net(images)"],"execution_count":26,"outputs":[]},{"cell_type":"code","metadata":{"id":"9yaMMa8VDQdI","executionInfo":{"status":"ok","timestamp":1603708808709,"user_tz":-540,"elapsed":1999,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"15d5d3b3-15e7-4f49-8838-c47f19bd298b","colab":{"base_uri":"https://localhost:8080/","height":122}},"source":["_, predicted = torch.max(outputs,1)\n","print(predicted)"],"execution_count":27,"outputs":[{"output_type":"stream","text":["tensor([7, 6, 1, 0, 4, 1, 7, 9, 4, 7, 0, 6, 9, 0, 1, 3, 4, 7, 3, 9, 9, 6, 4, 3,\n","        4, 0, 7, 4, 0, 1, 3, 1, 3, 0, 7, 2, 7, 1, 2, 1, 1, 7, 4, 2, 3, 3, 1, 2,\n","        4, 4, 6, 3, 5, 0, 2, 0, 4, 1, 9, 7, 7, 2, 9, 2, 7, 9, 0, 7, 3, 0, 7, 0,\n","        2, 8, 1, 7, 3, 7, 1, 7, 9, 6, 2, 7, 4, 4, 7, 0, 6, 1, 3, 6, 8, 3, 1, 4,\n","        7, 8, 6, 9, 6, 0, 7, 4, 0, 9, 2, 1, 9, 4, 8, 1, 3, 9, 7, 9, 9, 4, 9, 4,\n","        3, 4, 7, 6, 7, 9, 0, 9])\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"qOQWilyPOja5","executionInfo":{"status":"ok","timestamp":1603708921418,"user_tz":-540,"elapsed":1612,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"523c028a-f335-4f4a-d47d-7d1c440bc4b9","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["print(''.join('{}\\t'.format(str(predicted[j].numpy())) for j in range(4)))\n","\n","# 음.. 7 6 1 0 으로 맞췃네.."],"execution_count":28,"outputs":[{"output_type":"stream","text":["7\t6\t1\t0\t\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"T1qsc9TUDQfk","executionInfo":{"status":"ok","timestamp":1603709038780,"user_tz":-540,"elapsed":3338,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"830a18f9-4685-4aff-c74c-65c72a7a1f8c","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["correct = 0\n","total = 0\n","\n","with torch.no_grad():\n","    for data in test_loader:\n","        images, labels = data\n","        outputs = net(images)\n","        _, predicted = torch.max(outputs.data,1)    # 10개중에 확률값으로 나오니까\n","        total += labels.size(0)\n","        correct += (predicted == labels).sum().item()\n","\n","print(100 * correct / total)\n","\n","\n","# 정확도가 71 밖에 안되는구만..\n","# 와이러누 와이루노\n","# epoch를 2번밖에 안돌려서 그렇다 하지만"],"execution_count":30,"outputs":[{"output_type":"stream","text":["71.19\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"HQBRrbueR94k"},"source":["## GPU 설정 후 학습\n","- 설정 후, 모델과 데이터에 `to`로 GPU를 사용 가능한 형태로 변환 해줘야 한다.\n","\n","- `.cuda()` 로도 가능"]},{"cell_type":"code","metadata":{"id":"uaO3lXxRjslc","executionInfo":{"status":"ok","timestamp":1603709109770,"user_tz":-540,"elapsed":6613,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}}},"source":["import torch\n","import torch.nn as nn\n","import torch.nn.functional as F\n","import torch.optim as optim\n","from torch.utils.data import Dataset, DataLoader\n","\n","import torchvision\n","import torchvision.datasets\n","import torchvision.transforms as transforms\n","\n","import numpy as np\n","import matplotlib.pyplot as plt\n","plt.style.use('seaborn-white')"],"execution_count":1,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"02LdHlTTSz5L"},"source":["- 현재 GPU 설정"]},{"cell_type":"code","metadata":{"id":"Ybsjn80uSx3X","executionInfo":{"status":"ok","timestamp":1603709126862,"user_tz":-540,"elapsed":1998,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"1e6a03c7-4d06-43b3-fe93-9d177c162e59","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["torch.cuda.is_available()"],"execution_count":2,"outputs":[{"output_type":"execute_result","data":{"text/plain":["True"]},"metadata":{"tags":[]},"execution_count":2}]},{"cell_type":"code","metadata":{"id":"HlPZI5wfDQhv","executionInfo":{"status":"ok","timestamp":1603709184137,"user_tz":-540,"elapsed":1712,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}}},"source":["use_cuda = torch.cuda.is_available()\n","device = torch.device('cuda' if use_cuda else 'cpu')    # 만약 안되면 cuda 사용 가용하면 // 안되면 cpu로 수정해줘야지\n"],"execution_count":3,"outputs":[]},{"cell_type":"code","metadata":{"id":"ykIP4ceaSCib","executionInfo":{"status":"ok","timestamp":1603709187688,"user_tz":-540,"elapsed":459,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"c6d3b818-7eef-4265-ca95-7c54f163b4af","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["device\n","# 우리 gpu 사용하고있으니까 당연히 cuda로 나오겟지"],"execution_count":4,"outputs":[{"output_type":"execute_result","data":{"text/plain":["device(type='cuda')"]},"metadata":{"tags":[]},"execution_count":4}]},{"cell_type":"markdown","metadata":{"id":"JZ6fOMoakAIi"},"source":["- 데이터 로드\n"]},{"cell_type":"code","metadata":{"id":"WUwhAT3IkBbN","executionInfo":{"status":"ok","timestamp":1603709280033,"user_tz":-540,"elapsed":6339,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"dc34fd73-6549-4b6f-da81-5007471026d3","colab":{"base_uri":"https://localhost:8080/","height":394,"referenced_widgets":["b537776b6de3481283027225a3008d4e","be42cb0f2ca64ae2a8e3e89d613eadfb","2e852648098245d88d3c257fcc2a008b","218a966bcbf34512b6ab0d53b64c9960","0a3ee6d13c014782a5f615ef65d4374d","172e24d497a846d282a9db39ad973886","922064f5a4284e578e7385602110f9cd","5a7ec0a464704b93952929a2a59cdefb","138cc1975c1545f6bf82644772993ea9","11d4504092f74e1ba2bb7e0ac6240253","5efb1b96a9cf433e8254ef2b17d4ef6f","df27d7381f0c466d9ae8c5cfeabbc816","d3c28d5f99ba4ff89a52b12c5fe4ed82","b37329735c6f426ba22307ae2f6922a0","dd338beab76540b59c9cb44b8bc660a2","882a8870ca0d409688c2a374aa2f1a60","8e226908a1f946f0855e49595c232b51","1752d87847804addab66a1d0146a9e52","4908a7ff7f3e45a59061aa4636d461e2","244847847b754d3f992f5dfc7c639bc7","b04601d945d240cbb2965400df26d779","ab99a4f538c046d09348e601cec6aaa4","c6005bd26096424c8b3f0daf56a5a7f2","7acd0eb980d64f988d06a0411db800f7","55f4d3fa6a7e4addabcf090fc280006c","559f444250b24c859fd83451eae654c6","6438e959f9cb45cfa8587af50bb7531c","b616009802ac4ef69009c262db59fdcf","9eea6b07010f4019b1f4b0beae148e0b","d8a92f72d21d4e1cab976f2c26eb3e46","2b23cd50be174e64835ceb56d1fba1cd","6c9f9113a87044a4be1a53acf55c588e"]}},"source":["transform = transforms.Compose([transforms.ToTensor(), \n","                                transforms.Normalize((0.5,),(0.5,))]) # mean, std 각각 0.5\n","\n","trainset = torchvision.datasets.MNIST(root='./data',\n","                                      train = True,\n","                                      download = True,\n","                                      transform = transform)\n","\n","# testset = torchvision.data\n","testset = torchvision.datasets.MNIST(root='./data',\n","                                      train = False,\n","                                      download = True,\n","                                      transform = transform)\n","\n","train_loader = DataLoader(trainset,\n","                          batch_size = 128,\n","                          shuffle = True,\n","                          num_workers = 2)\n","\n","test_loader = DataLoader(testset,\n","                         batch_size = 128,\n","                         shuffle = False,\n","                         num_workers = 2)"],"execution_count":6,"outputs":[{"output_type":"stream","text":["Downloading http://yann.lecun.com/exdb/mnist/train-images-idx3-ubyte.gz to ./data/MNIST/raw/train-images-idx3-ubyte.gz\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"b537776b6de3481283027225a3008d4e","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=1.0, bar_style='info', max=1.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["Extracting ./data/MNIST/raw/train-images-idx3-ubyte.gz to ./data/MNIST/raw\n","Downloading http://yann.lecun.com/exdb/mnist/train-labels-idx1-ubyte.gz to ./data/MNIST/raw/train-labels-idx1-ubyte.gz\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"138cc1975c1545f6bf82644772993ea9","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=1.0, bar_style='info', max=1.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["Extracting ./data/MNIST/raw/train-labels-idx1-ubyte.gz to ./data/MNIST/raw\n","Downloading http://yann.lecun.com/exdb/mnist/t10k-images-idx3-ubyte.gz to ./data/MNIST/raw/t10k-images-idx3-ubyte.gz\n","\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"8e226908a1f946f0855e49595c232b51","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=1.0, bar_style='info', max=1.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["Extracting ./data/MNIST/raw/t10k-images-idx3-ubyte.gz to ./data/MNIST/raw\n","Downloading http://yann.lecun.com/exdb/mnist/t10k-labels-idx1-ubyte.gz to ./data/MNIST/raw/t10k-labels-idx1-ubyte.gz\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"55f4d3fa6a7e4addabcf090fc280006c","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=1.0, bar_style='info', max=1.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["Extracting ./data/MNIST/raw/t10k-labels-idx1-ubyte.gz to ./data/MNIST/raw\n","Processing...\n","Done!\n"],"name":"stdout"},{"output_type":"stream","text":["/usr/local/lib/python3.6/dist-packages/torchvision/datasets/mnist.py:469: UserWarning: The given NumPy array is not writeable, and PyTorch does not support non-writeable tensors. This means you can write to the underlying (supposedly non-writeable) NumPy array using the tensor. You may want to copy the array to protect its data or make it writeable before converting it to a tensor. This type of warning will be suppressed for the rest of this program. (Triggered internally at  /pytorch/torch/csrc/utils/tensor_numpy.cpp:141.)\n","  return torch.from_numpy(parsed.astype(m[2], copy=False)).view(*s)\n"],"name":"stderr"}]},{"cell_type":"markdown","metadata":{"id":"34WyPzrzS8Cd"},"source":["- 모델 생성"]},{"cell_type":"code","metadata":{"id":"lpFTp1Tbjyeb","executionInfo":{"status":"ok","timestamp":1603709296619,"user_tz":-540,"elapsed":2118,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"f9df0af4-c6d4-4609-a82d-71ae4c03346a","colab":{"base_uri":"https://localhost:8080/","height":140}},"source":["class Net(nn.Module):\n","\n","    def __init__(self):\n","        super(Net, self).__init__()\n","\n","        self.conv1 = nn.Conv2d(1, 6, 3)\n","        self.conv2 = nn.Conv2d(6, 16, 3)    #6 이어 받고,커널은 3\n","        self.fc1 = nn.Linear(16* 5*5, 120)\n","        self.fc2 = nn.Linear(120, 84)\n","        self.fc3 = nn.Linear(84,10)\n","\n","    def forward(self, x):\n","        x = F.max_pool2d(F.relu(self.conv1(x)), (2,2))\n","        x = F.max_pool2d(F.relu(self.conv2(x)), 2)\n","        x = x.view(-1, self.num_flat_features(x))\n","        x = F.relu(self.fc1(x))\n","        x = F.relu(self.fc2(x))\n","        x = self.fc3(x)\n","        return x\n","\n","    def num_flat_features(self, x):\n","        size = x.size()[1:]\n","        num_features = 1\n","        for s in size:\n","            num_features *= s\n","\n","        return num_features\n","\n","net = Net()\n","print(net)"],"execution_count":7,"outputs":[{"output_type":"stream","text":["Net(\n","  (conv1): Conv2d(1, 6, kernel_size=(3, 3), stride=(1, 1))\n","  (conv2): Conv2d(6, 16, kernel_size=(3, 3), stride=(1, 1))\n","  (fc1): Linear(in_features=400, out_features=120, bias=True)\n","  (fc2): Linear(in_features=120, out_features=84, bias=True)\n","  (fc3): Linear(in_features=84, out_features=10, bias=True)\n",")\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"BndKyGxnSCXK","executionInfo":{"status":"ok","timestamp":1603709353141,"user_tz":-540,"elapsed":12469,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}}},"source":["net = Net().to(device)  # to 라는 method를 통해서 cuda로 보내야햄!"],"execution_count":8,"outputs":[]},{"cell_type":"code","metadata":{"id":"aHWkPKpRSxYW","executionInfo":{"status":"ok","timestamp":1603709353143,"user_tz":-540,"elapsed":12463,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}}},"source":["criterion = nn.CrossEntropyLoss()\n","optimizer = optim.SGD(net.parameters(), lr = 0.001, momentum = 0.9)"],"execution_count":9,"outputs":[]},{"cell_type":"code","metadata":{"id":"-3dCbF7DSxWC","executionInfo":{"status":"ok","timestamp":1603709418881,"user_tz":-540,"elapsed":20730,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"abfdc825-234a-4a50-8c7e-325f1afab268","colab":{"base_uri":"https://localhost:8080/","height":158}},"source":["for epoch in range(2):\n","\n","    running_loss = 0.0\n","    for i , data in enumerate(train_loader, 0 ):\n","        inputs, labels = data[0].to(device), data[1].to(device)\n","\n","        optimizer.zero_grad()\n","\n","        outputs = net(inputs)\n","        loss = criterion(outputs, labels)   #예측결과랑 실제값이랑 비교하려고\n","        loss.backward()\n","        optimizer.step()\n","\n","        running_loss += loss.item()\n","        if i % 100 == 99:\n","            print('epoch: {}, iter: {}, loss: {}'.format( epoch + 1, i + 1 , running_loss/2000))\n","            running_loss = 0.0"],"execution_count":10,"outputs":[{"output_type":"stream","text":["epoch: 1, iter: 100, loss: 0.11501429545879364\n","epoch: 1, iter: 200, loss: 0.114548863530159\n","epoch: 1, iter: 300, loss: 0.11383955752849578\n","epoch: 1, iter: 400, loss: 0.11267159044742585\n","epoch: 2, iter: 100, loss: 0.10683598530292511\n","epoch: 2, iter: 200, loss: 0.09245382833480835\n","epoch: 2, iter: 300, loss: 0.0584672549366951\n","epoch: 2, iter: 400, loss: 0.03445305481553078\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"v5-a95lgSxUH","executionInfo":{"status":"ok","timestamp":1603709465699,"user_tz":-540,"elapsed":2951,"user":{"displayName":"박성흠","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gi9Cj6D2h5-5RlAvSAB86oovrFwm59mGWcldbpX=s64","userId":"17794821546298080880"}},"outputId":"1be3b711-3215-4122-91e9-7ad41a98e9c7","colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["correct = 0\n","total = 0\n","\n","with torch.no_grad():\n","    for data in test_loader:\n","        images, labels = data[0].to(device), data[1].to(device)\n","        outputs = net(images)\n","        _, predicted = torch.max(outputs.data,1)    # 10개중에 확률값으로 나오니까\n","        total += labels.size(0)\n","        correct += (predicted == labels).sum().item()\n","\n","print(100 * correct / total)\n","\n","# ㅆㅅㅌㅊ!"],"execution_count":12,"outputs":[{"output_type":"stream","text":["84.54\n"],"name":"stdout"}]}]}